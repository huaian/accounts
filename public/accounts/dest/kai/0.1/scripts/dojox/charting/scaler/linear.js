define("dojox/charting/scaler/linear",["dojo/_base/lang","./common"],function(r,i){function o(r,i){r=r.toLowerCase();for(var o=i.length-1;o>=0;--o)if(r===i[o])return!0;return!1}var e=r.getObject("dojox.charting.scaler.linear",!0),n=3,a=i.getNumericLabel,t=function(i,n,a,t,c,m,u){a=r.delegate(a),t||("major"==a.fixUpper&&(a.fixUpper="minor"),"major"==a.fixLower&&(a.fixLower="minor")),c||("minor"==a.fixUpper&&(a.fixUpper="micro"),"minor"==a.fixLower&&(a.fixLower="micro")),m||("micro"==a.fixUpper&&(a.fixUpper="none"),"micro"==a.fixLower&&(a.fixLower="none"));var f=o(a.fixLower,["major"])?Math.floor(a.min/t)*t:o(a.fixLower,["minor"])?Math.floor(a.min/c)*c:o(a.fixLower,["micro"])?Math.floor(a.min/m)*m:a.min,l=o(a.fixUpper,["major"])?Math.ceil(a.max/t)*t:o(a.fixUpper,["minor"])?Math.ceil(a.max/c)*c:o(a.fixUpper,["micro"])?Math.ceil(a.max/m)*m:a.max;a.useMin&&(i=f),a.useMax&&(n=l);var s=!t||a.useMin&&o(a.fixLower,["major"])?i:Math.ceil(i/t)*t,p=!c||a.useMin&&o(a.fixLower,["major","minor"])?i:Math.ceil(i/c)*c,x=!m||a.useMin&&o(a.fixLower,["major","minor","micro"])?i:Math.ceil(i/m)*m,M=t?(a.useMax&&o(a.fixUpper,["major"])?Math.round((n-s)/t):Math.floor((n-s)/t))+1:0,k=c?(a.useMax&&o(a.fixUpper,["major","minor"])?Math.round((n-p)/c):Math.floor((n-p)/c))+1:0,h=m?(a.useMax&&o(a.fixUpper,["major","minor","micro"])?Math.round((n-x)/m):Math.floor((n-x)/m))+1:0,b=c?Math.round(t/c):0,d=m?Math.round(c/m):0,j=t?Math.floor(Math.log(t)/Math.LN10):0,L=c?Math.floor(Math.log(c)/Math.LN10):0,w=u/(n-i);return isFinite(w)||(w=1),{bounds:{lower:f,upper:l,from:i,to:n,scale:w,span:u},major:{tick:t,start:s,count:M,prec:j},minor:{tick:c,start:p,count:k,prec:L},micro:{tick:m,start:x,count:h,prec:0},minorPerMajor:b,microPerMinor:d,scaler:e}};return r.mixin(e,{buildScaler:function(r,i,o,e,a,c){var m={fixUpper:"none",fixLower:"none",natural:!1};if(e&&("fixUpper"in e&&(m.fixUpper=String(e.fixUpper)),"fixLower"in e&&(m.fixLower=String(e.fixLower)),"natural"in e&&(m.natural=Boolean(e.natural))),c=!c||n>c?n:c,"min"in e&&(r=e.min),"max"in e&&(i=e.max),e.includeZero&&(r>0&&(r=0),0>i&&(i=0)),m.min=r,m.useMin=!0,m.max=i,m.useMax=!0,"from"in e&&(r=e.from,m.useMin=!1),"to"in e&&(i=e.to,m.useMax=!1),r>=i)return t(r,i,m,0,0,0,o);a||(a=i-r);var u,f=Math.floor(Math.log(a)/Math.LN10),l=e&&"majorTickStep"in e?e.majorTickStep:Math.pow(10,f),s=0,p=0;if(e&&"minorTickStep"in e)s=e.minorTickStep;else do{if(s=l/10,(!m.natural||s>.9)&&(u=t(r,i,m,l,s,0,o),u.bounds.scale*u.minor.tick>c))break;if(s=l/5,(!m.natural||s>.9)&&(u=t(r,i,m,l,s,0,o),u.bounds.scale*u.minor.tick>c))break;if(s=l/2,(!m.natural||s>.9)&&(u=t(r,i,m,l,s,0,o),u.bounds.scale*u.minor.tick>c))break;return t(r,i,m,l,0,0,o)}while(!1);if(e&&"microTickStep"in e)p=e.microTickStep,u=t(r,i,m,l,s,p,o);else do{if(p=s/10,(!m.natural||p>.9)&&(u=t(r,i,m,l,s,p,o),u.bounds.scale*u.micro.tick>n))break;if(p=s/5,(!m.natural||p>.9)&&(u=t(r,i,m,l,s,p,o),u.bounds.scale*u.micro.tick>n))break;if(p=s/2,(!m.natural||p>.9)&&(u=t(r,i,m,l,s,p,o),u.bounds.scale*u.micro.tick>n))break;p=0}while(!1);return p?u:t(r,i,m,l,s,0,o)},buildTicks:function(r,i){var o,e,n,t=r.major.start,c=r.minor.start,m=r.micro.start;if(i.microTicks&&r.micro.tick)o=r.micro.tick,e=m;else if(i.minorTicks&&r.minor.tick)o=r.minor.tick,e=c;else{if(!r.major.tick)return null;o=r.major.tick,e=t}var u=1/r.bounds.scale;if(r.bounds.to<=r.bounds.from||isNaN(u)||!isFinite(u)||0>=o||isNaN(o)||!isFinite(o))return null;for(var f=[],l=[],s=[];e<=r.bounds.to+u;)Math.abs(t-e)<o/2?(n={value:t},i.majorLabels&&(n.label=a(t,r.major.prec,i)),f.push(n),t+=r.major.tick,c+=r.minor.tick,m+=r.micro.tick):Math.abs(c-e)<o/2?(i.minorTicks&&(n={value:c},i.minorLabels&&r.minMinorStep<=r.minor.tick*r.bounds.scale&&(n.label=a(c,r.minor.prec,i)),l.push(n)),c+=r.minor.tick,m+=r.micro.tick):(i.microTicks&&s.push({value:m}),m+=r.micro.tick),e+=o;return{major:f,minor:l,micro:s}},getTransformerFromModel:function(r){var i=r.bounds.from,o=r.bounds.scale;return function(r){return(r-i)*o}},getTransformerFromPlot:function(r){var i=r.bounds.from,o=r.bounds.scale;return function(r){return r/o+i}}})});