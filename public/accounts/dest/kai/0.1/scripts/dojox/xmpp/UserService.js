define("dojox/xmpp/UserService",["dojo","dijit","dojox"],function(e,t,r){e.provide("dojox.xmpp.UserService"),e.declare("dojox.xmpp.UserService",null,{constructor:function(e){this.session=e},getPersonalProfile:function(){var e={id:this.session.getNextIqId(),type:"get"},t=new r.string.Builder(r.xmpp.util.createElement("iq",e,!1));t.append(r.xmpp.util.createElement("query",{xmlns:"jabber:iq:private"},!1)),t.append(r.xmpp.util.createElement("sunmsgr",{xmlsns:"sun:xmpp:properties"},!0)),t.append("</query></iq>");var i=this.session.dispatchPacket(t.toString(),"iq",e.id);i.addCallback(this,"_onGetPersonalProfile")},setPersonalProfile:function(e){var t={id:this.session.getNextIqId(),type:"set"},i=new r.string.Builder(r.xmpp.util.createElement("iq",t,!1));i.append(r.xmpp.util.createElement("query",{xmlns:"jabber:iq:private"},!1)),i.append(r.xmpp.util.createElement("sunmsgr",{xmlsns:"sun:xmpp:properties"},!1));for(var n in e)i.append(r.xmpp.util.createElement("property",{name:n},!1)),i.append(r.xmpp.util.createElement("value",{},!1)),i.append(e[n]),i.append("</value></props>");i.append("</sunmsgr></query></iq>");var s=this.session.dispatchPacket(i.toString(),"iq",t.id);s.addCallback(this,"_onSetPersonalProfile")},_onSetPersonalProfile:function(e){if("result"==e.getAttribute("type"))this.onSetPersonalProfile(e.getAttribute("id"));else if("error"==e.getAttribute("type")){var t=this.session.processXmppError(e);this.onSetPersonalProfileFailure(t)}},onSetPersonalProfile:function(e){},onSetPersonalProfileFailure:function(e){},_onGetPersonalProfile:function(e){if("result"==e.getAttribute("type")){var t={};if(e.hasChildNodes()){var r=e.firstChild;if("query"==r.nodeName&&"jabber:iq:private"==r.getAttribute("xmlns")){var i=r.firstChild;if("query"==i.nodeName&&"sun:xmpp:properties"==i.getAttributes("xmlns"))for(var n=0;n<i.childNodes.length;n++){var s=i.childNodes[n];if("property"==s.nodeName){var o=s.getAttribute("name"),p=s.firstChild||"";t[o]=p}}}this.onGetPersonalProfile(t)}}else if("error"==e.getAttribute("type")){var l=this.session.processXmppError(e);this.onGetPersonalProfileFailure(l)}return e},onGetPersonalProfile:function(e){},onGetPersonalProfileFailure:function(e){}})});