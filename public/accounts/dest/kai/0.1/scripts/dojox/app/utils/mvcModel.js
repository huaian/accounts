define("dojox/app/utils/mvcModel",["dojo/_base/lang","dojo/Deferred","dojo/when","dojox/mvc/getStateful"],function(e,r,t,o){return function(a,d,n){var s,u={},i=new r,c=function(e){var r={};for(var t in e)"_"!==t.charAt(0)&&(r[t]=e[t]);return r};if(d.store)s={store:d.store.store,query:d.query?c(d.query):d.store.query?c(d.store.query):{}};else if(d.datastore){try{var l=require("dojo/store/DataStore")}catch(y){throw new Error("When using datastore the dojo/store/DataStore module must be listed in the dependencies")}s={store:new l({store:d.datastore.store}),query:c(d.query)}}else d.data&&(d.data&&e.isString(d.data)&&(d.data=e.getObject(d.data)),s={data:d.data,query:{}});var f=a[n].type?a[n].type:"dojox/mvc/EditStoreRefListController";try{var h=require(f)}catch(y){throw new Error(f+" must be listed in the dependencies")}var q,v=new h(s);try{if(v.queryStore)q=v.queryStore(s.query);else{var j=v._refSourceModelProp||v._refModelProp||"model";v.set(j,o(s.data)),q=v}}catch(m){return i.reject("load mvc model error."),i.promise}return t(q,e.hitch(this,function(){return u=v,i.resolve(u),u}),function(){i.reject("load model error.")}),i}});