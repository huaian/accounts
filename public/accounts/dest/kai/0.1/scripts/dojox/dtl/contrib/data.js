define("dojox/dtl/contrib/data",["dojo/_base/kernel","dojo/_base/lang","../_base","dojo/_base/array"],function(t,e,n,r){var i=e.getObject("contrib.data",!0,n),o=!0;return i._BoundItem=e.extend(function(t,e){this.item=t,this.store=e},{get:function(n){var a=this.store,s=this.item;if("getLabel"==n)return a.getLabel(s);if("getAttributes"==n)return a.getAttributes(s);if("getIdentity"==n)return a.getIdentity?a.getIdentity(s):"Store has no identity API";if(a.hasAttribute(s,n)||("s"==n.slice(-1)&&(o&&(o=!1,t.deprecated("You no longer need an extra s to call getValues, it can be figured out automatically")),n=n.slice(0,-1)),a.hasAttribute(s,n))){var d=a.getValues(s,n);if(d)return e.isArray(d)?(d=r.map(d,function(t){return e.isObject(t)&&a.isItem(t)?new i._BoundItem(t,a):t}),d.get=i._get,d):new i._BoundItem(d,a)}}}),i._BoundItem.prototype.get.safe=!0,i.BindDataNode=e.extend(function(t,e,r,i){this.items=t&&new n._Filter(t),this.query=e&&new n._Filter(e),this.store=new n._Filter(r),this.alias=i},{render:function(t,e){var n=this.items&&this.items.resolve(t),r=this.query&&this.query.resolve(t),o=this.store.resolve(t);if(!o||!o.getFeatures)throw new Error("data_bind didn't receive a store");if(r){var a=!1;if(o.fetch({query:r,sync:!0,scope:this,onComplete:function(t){a=!0,n=t}}),!a)throw new Error("The bind_data tag only works with a query if the store executed synchronously")}var s=[];if(n)for(var d,u=0;d=n[u];u++)s.push(new i._BoundItem(d,o));return t[this.alias]=s,e},unrender:function(t,e){return e},clone:function(){return this}}),e.mixin(i,{_get:function(t){return this.length?this[0]instanceof i._BoundItem?this[0].get(t):this[0][t]:void 0},bind_data:function(t,e){var n=e.contents.split();if("to"!=n[2]||"as"!=n[4]||!n[5])throw new Error("data_bind expects the format: 'data_bind items to store as varName'");return new i.BindDataNode(n[1],null,n[3],n[5])},bind_query:function(t,e){var n=e.contents.split();if("to"!=n[2]||"as"!=n[4]||!n[5])throw new Error("data_bind expects the format: 'bind_query query to store as varName'");return new i.BindDataNode(null,n[1],n[3],n[5])}}),i._get.safe=!0,n.register.tags("dojox.dtl.contrib",{data:["bind_data","bind_query"]}),i});