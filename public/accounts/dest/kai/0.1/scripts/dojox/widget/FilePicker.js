define("dojox/widget/FilePicker",["dojo","dijit","dojox","dojo/i18n!dojox/widget/nls/FilePicker","dojo/require!dojox/widget/RollingList,dojo/i18n"],function(t,e,i){t.provide("dojox.widget.FilePicker"),t.require("dojox.widget.RollingList"),t.require("dojo.i18n"),t.requireLocalization("dojox.widget","FilePicker"),t.declare("dojox.widget._FileInfoPane",[i.widget._RollingListPane],{templateString:"",templateString:t.cache("dojox.widget","FilePicker/_FileInfoPane.html",'<div class="dojoxFileInfoPane">\n	<table>\n		<tbody>\n			<tr>\n				<td class="dojoxFileInfoLabel dojoxFileInfoNameLabel">${_messages.name}</td>\n				<td class="dojoxFileInfoName" dojoAttachPoint="nameNode"></td>\n			</tr>\n			<tr>\n				<td class="dojoxFileInfoLabel dojoxFileInfoPathLabel">${_messages.path}</td>\n				<td class="dojoxFileInfoPath" dojoAttachPoint="pathNode"></td>\n			</tr>\n			<tr>\n				<td class="dojoxFileInfoLabel dojoxFileInfoSizeLabel">${_messages.size}</td>\n				<td class="dojoxFileInfoSize" dojoAttachPoint="sizeNode"></td>\n			</tr>\n		</tbody>\n	</table>\n	<div dojoAttachPoint="containerNode" style="display:none;"></div>\n</div>'),postMixInProperties:function(){this._messages=t.i18n.getLocalization("dojox.widget","FilePicker",this.lang),this.inherited(arguments)},onItems:function(){var t=this.store,e=this.items[0];e?(this.nameNode.innerHTML=t.getLabel(e),this.pathNode.innerHTML=t.getIdentity(e),this.sizeNode.innerHTML=t.getValue(e,"size"),this.parentWidget.scrollIntoView(this),this.inherited(arguments)):this._onError("Load",new Error("No item defined"))}}),t.declare("dojox.widget.FilePicker",i.widget.RollingList,{className:"dojoxFilePicker",pathSeparator:"",topDir:"",parentAttr:"parentDir",pathAttr:"path",preloadItems:50,selectDirectories:!0,selectFiles:!0,_itemsMatch:function(e,i){if(!e&&!i)return!0;if(!e||!i)return!1;if(e==i)return!0;if(this._isIdentity){var o=[this.store.getIdentity(e),this.store.getIdentity(i)];return t.forEach(o,function(t,e){t.lastIndexOf(this.pathSeparator)==t.length-1&&(o[e]=t.substring(0,t.length-1))},this),o[0]==o[1]}return!1},startup:function(){if(!this._started){this.inherited(arguments);var e,i=this.getChildren()[0],o=t.hitch(this,function(){e&&this.disconnect(e),delete e;var t=i.items[0];if(t){var o=this.store,s=o.getValue(t,this.parentAttr),n=o.getValue(t,this.pathAttr);this.pathSeparator=this.pathSeparator||o.pathSeparator,this.pathSeparator||(this.pathSeparator=n.substring(s.length,s.length+1)),this.topDir||(this.topDir=s,this.topDir.lastIndexOf(this.pathSeparator)!=this.topDir.length-1&&(this.topDir+=this.pathSeparator))}});this.pathSeparator&&this.topDir||(i.items?o():e=this.connect(i,"onItems",o))}},getChildItems:function(t){var e=this.inherited(arguments);return!e&&this.store.getValue(t,"directory")&&(e=[]),e},getMenuItemForItem:function(t,i,o){var s={iconClass:"dojoxDirectoryItemIcon"};if(!this.store.getValue(t,"directory")){s.iconClass="dojoxFileItemIcon";var n=this.store.getLabel(t),r=n.lastIndexOf(".");r>=0&&(s.iconClass+=" dojoxFileItemIcon_"+n.substring(r+1)),this.selectFiles||(s.disabled=!0)}var a=new e.MenuItem(s);return a},getPaneForItem:function(t,e,o){var s=null;return!t||this.store.isItem(t)&&this.store.getValue(t,"directory")?s=new i.widget._RollingListGroupPane({}):this.store.isItem(t)&&!this.store.getValue(t,"directory")&&(s=new i.widget._FileInfoPane({})),s},_setPathValueAttr:function(t,e,i){return t?(t.lastIndexOf(this.pathSeparator)==t.length-1&&(t=t.substring(0,t.length-1)),void this.store.fetchItemByIdentity({identity:t,onItem:function(t){e&&(this._lastExecutedValue=t),this.set("value",t),i&&i()},scope:this})):void this.set("value",null)},_getPathValueAttr:function(t){return t||(t=this.value),t&&this.store.isItem(t)?this.store.getValue(t,this.pathAttr):""},_setValue:function(t){delete this._setInProgress;var e=this.store;if(t&&e.isItem(t)){var i=this.store.getValue(t,"directory");if(i&&!this.selectDirectories||!i&&!this.selectFiles)return}else t=null;this._itemsMatch(this.value,t)||(this.value=t,this._onChange(t))}})});