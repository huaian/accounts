require({cache:{"url:dojox/calendar/templates/MatrixView.html":'<div data-dojo-attach-events="keydown:_onKeyDown">\n	<div  class="dojoxCalendarYearColumnHeader" data-dojo-attach-point="yearColumnHeader">\n		<table><tr><td><span data-dojo-attach-point="yearColumnHeaderContent"></span></td></tr></table>		\n	</div>	\n	<div data-dojo-attach-point="columnHeader" class="dojoxCalendarColumnHeader">\n		<table data-dojo-attach-point="columnHeaderTable" class="dojoxCalendarColumnHeaderTable" cellpadding="0" cellspacing="0"></table>\n	</div>		\n	<div dojoAttachPoint="rowHeader" class="dojoxCalendarRowHeader">\n		<table data-dojo-attach-point="rowHeaderTable" class="dojoxCalendarRowHeaderTable" cellpadding="0" cellspacing="0"></table>\n	</div>	\n	<div dojoAttachPoint="grid" class="dojoxCalendarGrid">\n		<table data-dojo-attach-point="gridTable" class="dojoxCalendarGridTable" cellpadding="0" cellspacing="0"></table>\n	</div>	\n	<div data-dojo-attach-point="itemContainer" class="dojoxCalendarContainer" data-dojo-attach-event="mousedown:_onGridMouseDown,mouseup:_onGridMouseUp,ondblclick:_onGridDoubleClick,touchstart:_onGridTouchStart,touchmove:_onGridTouchMove,touchend:_onGridTouchEnd">\n		<table data-dojo-attach-point="itemContainerTable" class="dojoxCalendarContainerTable" cellpadding="0" cellspacing="0" style="width:100%"></table>\n	</div>	\n</div>\n'}}),define("dojox/calendar/MatrixView",["dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/_base/lang","dojo/_base/sniff","dojo/_base/fx","dojo/_base/html","dojo/on","dojo/dom","dojo/dom-class","dojo/dom-style","dojo/dom-geometry","dojo/dom-construct","dojo/query","dojox/html/metrics","dojo/i18n","./ViewBase","dojo/text!./templates/MatrixView.html","dijit/_TemplatedMixin"],function(e,t,i,n,a,r,o,d,s,l,h,u,c,m,p,f,g,_,v){return e("dojox.calendar.MatrixView",[g,v],{templateString:_,baseClass:"dojoxCalendarMatrixView",_setTabIndexAttr:"domNode",viewKind:"matrix",renderData:null,startDate:null,refStartTime:null,refEndTime:null,columnCount:7,rowCount:5,horizontalRenderer:null,labelRenderer:null,expandRenderer:null,horizontalDecorationRenderer:null,percentOverlap:0,verticalGap:2,horizontalRendererHeight:17,labelRendererHeight:14,expandRendererHeight:15,cellPaddingTop:16,expandDuration:300,expandEasing:null,layoutDuringResize:!1,roundToDay:!0,showCellLabel:!0,scrollable:!1,resizeCursor:"e-resize",constructor:function(){this.invalidatingProperties=["columnCount","rowCount","startDate","horizontalRenderer","horizontalDecaorationRenderer","labelRenderer","expandRenderer","rowHeaderDatePattern","columnHeaderLabelLength","cellHeaderShortPattern","cellHeaderLongPattern","percentOverlap","verticalGap","horizontalRendererHeight","labelRendererHeight","expandRendererHeight","cellPaddingTop","roundToDay","itemToRendererKindFunc","layoutPriorityFunction","formatItemTimeFunc","textDir","items"],this._ddRendererList=[],this._ddRendererPool=[],this._rowHeaderHandles=[]},destroy:function(e){this._cleanupRowHeader(),this.inherited(arguments)},postCreate:function(){this.inherited(arguments),this._initialized=!0,this.invalidRendering||this.refreshRendering()},_createRenderData:function(){var e={};e.dateLocaleModule=this.dateLocaleModule,e.dateClassObj=this.dateClassObj,e.dateModule=this.dateModule,e.dates=[],e.columnCount=this.get("columnCount"),e.rowCount=this.get("rowCount"),e.sheetHeight=this.itemContainer.offsetHeight,this._computeRowsHeight(e);var t=this.get("startDate");null==t&&(t=new e.dateClassObj),t=this.floorToDay(t,!1,e),this.startDate=t;for(var i=0;i<e.rowCount;i++){e.dates.push([]);for(var n=0;n<e.columnCount;n++)e.dates[i].push(t),t=this.addAndFloor(t,"day",1)}return e.startTime=this.newDate(e.dates[0][0],e),e.endTime=this.newDate(e.dates[e.rowCount-1][e.columnCount-1],e),e.endTime=e.dateModule.add(e.endTime,"day",1),e.endTime=this.floorToDay(e.endTime,!0),this.displayedItemsInvalidated&&!this._isEditing?(this.displayedItemsInvalidated=!1,this._computeVisibleItems(e)):this.renderData&&(e.items=this.renderData.items),this.displayedDecorationItemsInvalidated?e.decorationItems=this.decorationStoreManager._computeVisibleItems(e):this.renderData&&(e.decorationItems=this.renderData.decorationItems),e.rtl=!this.isLeftToRight(),e},_validateProperties:function(){this.inherited(arguments),(this.columnCount<1||isNaN(this.columnCount))&&(this.columnCount=1),(this.rowCount<1||isNaN(this.rowCount))&&(this.rowCount=1),(isNaN(this.percentOverlap)||this.percentOverlap<0||this.percentOverlap>100)&&(this.percentOverlap=0),(isNaN(this.verticalGap)||this.verticalGap<0)&&(this.verticalGap=2),(isNaN(this.horizontalRendererHeight)||this.horizontalRendererHeight<1)&&(this.horizontalRendererHeight=17),(isNaN(this.labelRendererHeight)||this.labelRendererHeight<1)&&(this.labelRendererHeight=14),(isNaN(this.expandRendererHeight)||this.expandRendererHeight<1)&&(this.expandRendererHeight=15)},_setStartDateAttr:function(e){this.displayedItemsInvalidated=!0,this._set("startDate",e)},_setColumnCountAttr:function(e){this.displayedItemsInvalidated=!0,this._set("columnCount",e)},_setRowCountAttr:function(e){this.displayedItemsInvalidated=!0,this._set("rowCount",e)},__fixEvt:function(e){return e.sheet="primary",e.source=this,e},_formatRowHeaderLabel:function(e){return this.rowHeaderDatePattern?this.renderData.dateLocaleModule.format(e,{selector:"date",datePattern:this.rowHeaderDatePattern}):this.getWeekNumberLabel(e)},_formatColumnHeaderLabel:function(e){return this.renderData.dateLocaleModule.getNames("days",this.columnHeaderLabelLength?this.columnHeaderLabelLength:"wide","standAlone")[e.getDay()]},cellHeaderShortPattern:null,cellHeaderLongPattern:null,_formatGridCellLabel:function(e,t,i){var n,a,r=0==t&&0==i||1==e.getDate();return r?this.cellHeaderLongPattern?n=this.cellHeaderLongPattern:(a=f.getLocalization("dojo.cldr",this._calendar),n=a["dateFormatItem-MMMd"]):this.cellHeaderShortPattern?n=this.cellHeaderShortPattern:(a=f.getLocalization("dojo.cldr",this._calendar),n=a["dateFormatItem-d"]),this.renderData.dateLocaleModule.format(e,{selector:"date",datePattern:n})},refreshRendering:function(){if(this.inherited(arguments),this.domNode){this._validateProperties();var e=this.renderData,t=this.renderData=this._createRenderData();this._createRendering(t,e),this._layoutDecorationRenderers(t),this._layoutRenderers(t)}},_createRendering:function(e,t){if(e.rowHeight<=0)return e.columnCount=1,e.rowCount=1,void(e.invalidRowHeight=!0);if(t&&this.itemContainerTable){var i=m(".dojoxCalendarItemContainerRow",this.itemContainerTable);t.rowCount=i.length}this._buildColumnHeader(e,t),this._buildRowHeader(e,t),this._buildGrid(e,t),this._buildItemContainer(e,t),this.buttonContainer&&null!=this.owner&&this.owner.currentView==this&&h.set(this.buttonContainer,{right:0,left:0})},_buildColumnHeader:function(e,t){var i=this.columnHeaderTable;if(i){var r=e.columnCount-(t?t.columnCount:0);8==a("ie")&&(null==this._colTableSave?this._colTableSave=n.clone(i):0>r&&(this.columnHeader.removeChild(i),c.destroy(i),i=n.clone(this._colTableSave),this.columnHeaderTable=i,this.columnHeader.appendChild(i),r=e.columnCount));var d,s,h,u=m("tbody",i),p=m("tr",i);if(d=1==u.length?u[0]:o.create("tbody",null,i),s=1==p.length?p[0]:c.create("tr",null,d),r>0)for(var f=0;r>f;f++)h=c.create("td",null,s);else{r=-r;for(var f=0;r>f;f++)s.removeChild(s.lastChild)}if(m("td",i).forEach(function(t,i){t.className="";var n=e.dates[0][i];this._setText(t,this._formatColumnHeaderLabel(n)),0==i?l.add(t,"first-child"):i==this.renderData.columnCount-1&&l.add(t,"last-child"),this.styleColumnHeaderCell(t,n,e)},this),this.yearColumnHeaderContent){var g=e.dates[0][0];this._setText(this.yearColumnHeaderContent,e.dateLocaleModule.format(g,{selector:"date",datePattern:"yyyy"}))}}},styleColumnHeaderCell:function(e,t,i){l.add(e,this._cssDays[t.getDay()]),this.isWeekEnd(t)&&l.add(e,"dojoxCalendarWeekend")},_rowHeaderHandles:null,_cleanupRowHeader:function(){for(;this._rowHeaderHandles.length>0;)for(var e=this._rowHeaderHandles.pop();e.length>0;)e.pop().remove()},_rowHeaderClick:function(e){var t=m("td",this.rowHeaderTable).indexOf(e.currentTarget);this._onRowHeaderClick({index:t,date:this.renderData.dates[t][0],triggerEvent:e})},_buildRowHeader:function(e,t){var i=this.rowHeaderTable;if(i){var r,o,s,u=m("tbody",i);r=1==u.length?u[0]:c.create("tbody",null,i);var p=e.rowCount-(t?t.rowCount:0);if(p>0)for(var f=0;p>f;f++){o=c.create("tr",null,r),s=c.create("td",null,o);var g=[];g.push(d(s,"click",n.hitch(this,this._rowHeaderClick))),a("touch")||(g.push(d(s,"mousedown",function(e){l.add(e.currentTarget,"Active")})),g.push(d(s,"mouseup",function(e){l.remove(e.currentTarget,"Active")})),g.push(d(s,"mouseover",function(e){l.add(e.currentTarget,"Hover")})),g.push(d(s,"mouseout",function(e){l.remove(e.currentTarget,"Hover")}))),this._rowHeaderHandles.push(g)}else{p=-p;for(var f=0;p>f;f++){r.removeChild(r.lastChild);for(var _=this._rowHeaderHandles.pop();_.length>0;)_.pop().remove()}}m("tr",i).forEach(function(t,i){h.set(t,"height",this._getRowHeight(i)+"px");var n=e.dates[i][0],a=m("td",t)[0];a.className="",0==i&&l.add(a,"first-child"),i==this.renderData.rowCount-1&&l.add(a,"last-child"),this.styleRowHeaderCell(a,n,e),this._setText(a,this._formatRowHeaderLabel(n))},this)}},styleRowHeaderCell:function(e,t,i){},_buildGrid:function(e,t){var i=this.gridTable;if(i){var r=m("tr",i),o=e.rowCount-r.length,d=o>0,s=e.columnCount-(r?m("td",r[0]).length:0);8==a("ie")&&(null==this._gridTableSave?this._gridTableSave=n.clone(i):0>s&&(this.grid.removeChild(i),c.destroy(i),i=n.clone(this._gridTableSave),this.gridTable=i,this.grid.appendChild(i),s=e.columnCount,o=e.rowCount,d=!0));var u,p=m("tbody",i);if(u=1==p.length?p[0]:c.create("tbody",null,i),d)for(var f=0;o>f;f++)c.create("tr",null,u);else{o=-o;for(var f=0;o>f;f++)u.removeChild(u.lastChild)}var g=e.rowCount-o,_=d||s>0;s=_?s:-s,m("tr",i).forEach(function(t,i){if(_)for(var n=i>=g?e.columnCount:s,i=0;n>i;i++){var a=c.create("td",null,t);c.create("span",null,a)}else for(var i=0;s>i;i++)t.removeChild(t.lastChild)}),m("tr",i).forEach(function(t,i){h.set(t,"height",this._getRowHeight(i)+"px"),t.className="",0==i&&l.add(t,"first-child"),i==e.rowCount-1&&l.add(t,"last-child"),m("td",t).forEach(function(t,n){t.className="",0==n&&l.add(t,"first-child"),n==e.columnCount-1&&l.add(t,"last-child");var a=e.dates[i][n],r=m("span",t)[0];this._setText(r,this.showCellLabel?this._formatGridCellLabel(a,i,n):null),this.styleGridCell(t,a,e)},this)},this)}},styleGridCellFunc:null,defaultStyleGridCell:function(e,t,i){l.add(e,this._cssDays[t.getDay()]);var n=this.dateModule;this.isToday(t)?l.add(e,"dojoxCalendarToday"):null!=this.refStartTime&&null!=this.refEndTime&&(n.compare(t,this.refEndTime)>=0||n.compare(n.add(t,"day",1),this.refStartTime)<=0)?l.add(e,"dojoxCalendarDayDisabled"):this.isWeekEnd(t)&&l.add(e,"dojoxCalendarWeekend")},styleGridCell:function(e,t,i){this.styleGridCellFunc?this.styleGridCellFunc(e,t,i):this.defaultStyleGridCell(e,t,i)},_buildItemContainer:function(e,t){var i=this.itemContainerTable;if(i){var r=[],o=e.rowCount-(t?t.rowCount:0);8==a("ie")&&(null==this._itemTableSave?this._itemTableSave=n.clone(i):0>o&&(this.itemContainer.removeChild(i),this._recycleItemRenderers(!0),this._recycleExpandRenderers(!0),c.destroy(i),i=n.clone(this._itemTableSave),this.itemContainerTable=i,this.itemContainer.appendChild(i),o=e.columnCount));var d,s,u,p,f=m("tbody",i);if(d=1==f.length?f[0]:c.create("tbody",null,i),o>0)for(var g=0;o>g;g++)s=c.create("tr",null,d),l.add(s,"dojoxCalendarItemContainerRow"),u=c.create("td",null,s),p=c.create("div",null,u),l.add(p,"dojoxCalendarContainerRow");else{o=-o;for(var g=0;o>g;g++)d.removeChild(d.lastChild)}m(".dojoxCalendarItemContainerRow",i).forEach(function(e,t){h.set(e,"height",this._getRowHeight(t)+"px"),r.push(e.childNodes[0].childNodes[0])},this),e.cells=r}},resize:function(e){this.inherited(arguments),this._resizeHandler(null,!1)},_resizeHandler:function(e,t){var i=this.renderData;if(null==i)return void this.refreshRendering();if(i.sheetHeight!=this.itemContainer.offsetHeight){i.sheetHeight=this.itemContainer.offsetHeight;var a=this.getExpandedRowIndex();if(-1==a?(this._computeRowsHeight(),this._resizeRows()):this.expandRow(i.expandedRow,i.expandedRowCol,0,null,!0),i.invalidRowHeight)return delete i.invalidRowHeight,this.renderData=null,this.displayedItemsInvalidated=!0,void this.refreshRendering()}this.layoutDuringResize||t?setTimeout(n.hitch(this,function(){this._layoutRenderers(this.renderData),this._layoutDecorationRenderers(this.renderData)}),20):(h.set(this.itemContainer,"opacity",0),this._recycleItemRenderers(),this._recycleExpandRenderers(),void 0!=this._resizeTimer&&clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(n.hitch(this,function(){delete this._resizeTimer,this._resizeRowsImpl(this.itemContainer,"tr"),this._layoutRenderers(this.renderData),this._layoutDecorationRenderers(this.renderData),0==this.resizeAnimationDuration?h.set(this.itemContainer,"opacity",1):r.fadeIn({node:this.itemContainer,curve:[0,1]}).play(this.resizeAnimationDuration)}),200))},resizeAnimationDuration:0,getExpandedRowIndex:function(){return null==this.renderData.expandedRow?-1:this.renderData.expandedRow},collapseRow:function(e,t,i){var a=this.renderData;if(void 0==i&&(i=!0),void 0==e&&(e=this.expandDuration),a&&null!=a.expandedRow&&-1!=a.expandedRow)if(i&&e){var o=a.expandedRow,d=a.expandedRowHeight;delete a.expandedRow,this._computeRowsHeight(a);var s=this._getRowHeight(o);a.expandedRow=o,this._recycleExpandRenderers(),this._recycleItemRenderers(),h.set(this.itemContainer,"display","none"),this._expandAnimation=new r.Animation({curve:[d,s],duration:e,easing:t,onAnimate:n.hitch(this,function(e){this._expandRowImpl(Math.floor(e))}),onEnd:n.hitch(this,function(e){this._expandAnimation=null,this._collapseRowImpl(!1),this._resizeRows(),h.set(this.itemContainer,"display","block"),setTimeout(n.hitch(this,function(){this._layoutRenderers(a)}),100),this.onExpandAnimationEnd(!1)})}),this._expandAnimation.play()}else this._collapseRowImpl(i)},_collapseRowImpl:function(e){var t=this.renderData;delete t.expandedRow,delete t.expandedRowHeight,this._computeRowsHeight(t),(void 0==e||e)&&(this._resizeRows(),this._layoutRenderers(t))},expandRow:function(e,t,i,a,o){var d=this.renderData;if(!d||0>e||e>=d.rowCount)return-1;(void 0==t||0>t||t>=d.columnCount)&&(t=-1),void 0==o&&(o=!0),void 0==i&&(i=this.expandDuration),void 0==a&&(a=this.expandEasing);var s=this._getRowHeight(e),l=d.sheetHeight-Math.ceil(this.cellPaddingTop*(d.rowCount-1));d.expandedRow=e,d.expandedRowCol=t,d.expandedRowHeight=l,o&&(i?(this._recycleExpandRenderers(),this._recycleItemRenderers(),h.set(this.itemContainer,"display","none"),this._expandAnimation=new r.Animation({curve:[s,l],duration:i,delay:50,easing:a,onAnimate:n.hitch(this,function(e){this._expandRowImpl(Math.floor(e))}),onEnd:n.hitch(this,function(){this._expandAnimation=null,h.set(this.itemContainer,"display","block"),setTimeout(n.hitch(this,function(){this._expandRowImpl(l,!0)}),100),this.onExpandAnimationEnd(!0)})}),this._expandAnimation.play()):this._expandRowImpl(l,!0))},_expandRowImpl:function(e,t){var i=this.renderData;i.expandedRowHeight=e,this._computeRowsHeight(i,i.sheetHeight-e),this._resizeRows(),t&&this._layoutRenderers(i)},onExpandAnimationEnd:function(e){},_resizeRows:function(){this._getRowHeight(0)<=0||(this.rowHeaderTable&&this._resizeRowsImpl(this.rowHeaderTable,"tr"),this.gridTable&&this._resizeRowsImpl(this.gridTable,"tr"),this.itemContainerTable&&this._resizeRowsImpl(this.itemContainerTable,"tr"))},_computeRowsHeight:function(e,t){var i=null==e?this.renderData:e;if(t=t||i.sheetHeight,t--,7==a("ie")&&(t-=i.rowCount),1==i.rowCount)return i.rowHeight=t,i.rowHeightFirst=t,void(i.rowHeightLast=t);var n,r,o,d,s=null==i.expandedRow?i.rowCount:i.rowCount-1,l=t/s,h=t-Math.floor(l)*s,u=Math.abs(t-Math.ceil(l)*s),c=1;u>h?(o=Math.floor(l),d=h):(c=-1,o=Math.ceil(l),d=u),n=o+c*Math.floor(d/2),r=n+c*(d%2),i.rowHeight=o,i.rowHeightFirst=n,i.rowHeightLast=r},_getRowHeight:function(e){var t=this.renderData;return e==t.expandedRow?t.expandedRowHeight:0==t.expandedRow&&1==e||0==e?t.rowHeightFirst:t.expandedRow==this.renderData.rowCount-1&&e==this.renderData.rowCount-2||e==this.renderData.rowCount-1?t.rowHeightLast:t.rowHeight},_resizeRowsImpl:function(e,t){dojo.query(t,e).forEach(function(e,t){h.set(e,"height",this._getRowHeight(t)+"px")},this)},_setHorizontalRendererAttr:function(e){this._destroyRenderersByKind("horizontal"),this._set("horizontalRenderer",e)},_setLabelRendererAttr:function(e){this._destroyRenderersByKind("label"),this._set("labelRenderer",e)},_destroyExpandRenderer:function(e){e.destroyRecursive&&e.destroyRecursive(),o.destroy(e.domNode)},_setExpandRendererAttr:function(e){for(;this._ddRendererList.length>0;)this._destroyExpandRenderer(this._ddRendererList.pop());var t=this._ddRendererPool;if(t)for(;t.length>0;)this._destroyExpandRenderer(t.pop());this._set("expandRenderer",e)},_ddRendererList:null,_ddRendererPool:null,_getExpandRenderer:function(e,t,i,n,a){if(null==this.expandRenderer)return null;var r=this._ddRendererPool.pop();return null==r&&(r=new this.expandRenderer),this._ddRendererList.push(r),r.set("owner",this),r.set("date",e),r.set("items",t),r.set("rowIndex",i),r.set("columnIndex",n),r.set("expanded",a),r},_recycleExpandRenderers:function(e){for(var t=0;t<this._ddRendererList.length;t++){var i=this._ddRendererList[t];i.set("Up",!1),i.set("Down",!1),e&&i.domNode.parentNode.removeChild(i.domNode),h.set(i.domNode,"display","none")}this._ddRendererPool=this._ddRendererPool.concat(this._ddRendererList),this._ddRendererList=[]},_defaultItemToRendererKindFunc:function(e){var t=Math.abs(this.renderData.dateModule.difference(e.startTime,e.endTime,"minute"));return t>=1440?"horizontal":"label"},naturalRowsHeight:null,_roundItemToDay:function(e){var t=e.startTime,i=e.endTime;return this.isStartOfDay(t)||(t=this.floorToDay(t,!1,this.renderData)),this.isStartOfDay(i)||(i=this.renderData.dateModule.add(i,"day",1),i=this.floorToDay(i,!0)),{startTime:t,endTime:i}},_sortItemsFunction:function(e,t){this.roundToDay&&(e=this._roundItemToDay(e),t=this._roundItemToDay(t));var i=this.dateModule.compare(e.startTime,t.startTime);return 0==i&&(i=-1*this.dateModule.compare(e.endTime,t.endTime)),i},_overlapLayoutPass3:function(e){for(var t=0,i=0,n=[],a=u.position(this.gridTable).x,r=0;r<this.renderData.columnCount;r++){var o=!1,d=u.position(this._getCellAt(0,r));t=d.x-a,i=t+d.w;for(var s=e.length-1;s>=0&&!o;s--)for(var l=0;l<e[s].length;l++){var h=e[s][l];if(o=h.start<i&&t<h.end){n[r]=s+1;break}}o||(n[r]=0)}return n},applyRendererZIndex:function(e,t,i,n,a,r){h.set(t.container,{zIndex:a||n?t.renderer.mobile?100:0:void 0==e.lane?1:e.lane+1})},_layoutDecorationRenderers:function(e){if(!(null==e||null==e.decorationItems||e.rowHeight<=0)){if(!this.gridTable||null!=this._expandAnimation||null==this.horizontalDecorationRenderer)return void this.decorationRendererManager.recycleItemRenderers();this._layoutStep=e.columnCount,this.renderData.gridTablePosX=u.position(this.gridTable).x,this.inherited(arguments)}},_layoutRenderers:function(e){if(!(null==e||null==e.items||e.rowHeight<=0)){if(!this.gridTable||null!=this._expandAnimation||null==this.horizontalRenderer&&null==this.labelRenderer)return void this._recycleItemRenderers();this.renderData.gridTablePosX=u.position(this.gridTable).x,this._layoutStep=e.columnCount,this._recycleExpandRenderers(),this._hiddenItems=[],this._offsets=[],this.naturalRowsHeight=[],this.inherited(arguments)}},_offsets:null,_layoutInterval:function(e,t,i,n,a,r){if(null!=this.renderData.cells)if("dataItems"===r){for(var o=[],d=[],s=0;s<a.length;s++){var l=a[s],h=this._itemToRendererKind(l);"horizontal"==h?o.push(l):"label"==h&&d.push(l)}var u=this.getExpandedRowIndex();if(-1!=u&&u!=t)return;var c=[],m=null,p=[];if(o.length>0&&this.horizontalRenderer)var m=this._createHorizontalLayoutItems(t,i,n,o,r),f=this._computeHorizontalOverlapLayout(m,p);var g,_=[];d.length>0&&this.labelRenderer&&(g=this._createLabelLayoutItems(t,i,n,d),this._computeLabelOffsets(g,_));var v=this._computeColHasHiddenItems(t,p,_);null!=m&&this._layoutHorizontalItemsImpl(t,m,f,v,c,r),null!=g&&this._layoutLabelItemsImpl(t,g,v,c,p,r),this._layoutExpandRenderers(t,v,c),this._hiddenItems[t]=c}else if(this.horizontalDecorationRenderer){var m=this._createHorizontalLayoutItems(t,i,n,a,r);null!=m&&this._layoutHorizontalItemsImpl(t,m,null,!1,null,r)}},_createHorizontalLayoutItems:function(e,t,i,a,r){for(var o=this.renderData,d=o.dateModule,s=o.rtl?-1:1,l=[],h="decorationItems"===r,c=0;c<a.length;c++){var m=a[c],p=this.computeRangeOverlap(o,m.startTime,m.endTime,t,i),f=d.difference(t,this.floorToDay(p[0],!1,o),"day"),g=o.dates[e][f],_=u.position(this._getCellAt(e,f,!1)),v=_.x-o.gridTablePosX;o.rtl&&(v+=_.w),(h&&!m.isAllDay||!h&&!this.roundToDay&&!m.allDay)&&(v+=s*this.computeProjectionOnDate(o,g,p[0],_.w)),v=Math.ceil(v);var R,w=d.difference(t,this.floorToDay(p[1],!1,o),"day");if(w>o.columnCount-1?(_=u.position(this._getCellAt(e,o.columnCount-1,!1)),R=o.rtl?_.x-o.gridTablePosX:_.x-o.gridTablePosX+_.w):(g=o.dates[e][w],_=u.position(this._getCellAt(e,w,!1)),R=_.x-o.gridTablePosX,o.rtl&&(R+=_.w),!h&&this.roundToDay?this.isStartOfDay(p[1])||(R+=s*_.w):R+=s*this.computeProjectionOnDate(o,g,p[1],_.w)),R=Math.floor(R),o.rtl){var C=R;R=v,v=C}if(R>v){var x=n.mixin({start:v,end:R,range:p,item:m,startOffset:f,endOffset:w},m);l.push(x)}}return l},_computeHorizontalOverlapLayout:function(e,t){for(var i=this.renderData,n=this.horizontalRendererHeight,a=this.computeOverlapping(e,this._overlapLayoutPass3),r=this.percentOverlap/100,o=0;o<i.columnCount;o++){var d=a.addedPassRes[o],s=i.rtl?i.columnCount-o-1:o;0==r?t[s]=0==d?0:1==d?n:n+(d-1)*(n+this.verticalGap):t[s]=0==d?0:d*n-(d-1)*(r*n)+this.verticalGap,t[s]+=this.cellPaddingTop}return a},_createLabelLayoutItems:function(e,t,i,a){if(null!=this.labelRenderer){for(var r,o=this.renderData,d=o.dateModule,s=[],l=0;l<a.length;l++){var h=a[l];r=this.floorToDay(h.startTime,!1,o);for(var u=this.dateModule.compare;-1==u(r,h.endTime)&&-1==u(r,i);){var c=d.add(r,"day",1);c=this.floorToDay(c,!0);var m=this.computeRangeOverlap(o,h.startTime,h.endTime,r,c),p=d.difference(t,this.floorToDay(m[0],!1,o),"day");if(p>=this.columnCount)break;if(p>=0){var f=s[p];null==f&&(f=[],s[p]=f),f.push(n.mixin({startOffset:p,range:m,item:h},h))}r=d.add(r,"day",1),this.floorToDay(r,!0)}}return s}},_computeLabelOffsets:function(e,t){for(var i=0;i<this.renderData.columnCount;i++)t[i]=null==e[i]?0:e[i].length*(this.labelRendererHeight+this.verticalGap)},_computeColHasHiddenItems:function(e,t,i){for(var n,a=[],r=this._getRowHeight(e),o=0,d=0;d<this.renderData.columnCount;d++)n=null==t||null==t[d]?this.cellPaddingTop:t[d],n+=null==i||null==i[d]?0:i[d],n>o&&(o=n),a[d]=n>r;return this.naturalRowsHeight[e]=o,a},_layoutHorizontalItemsImpl:function(e,t,i,n,r,o){for(var d=this.renderData,s=d.cells[e],l=this._getRowHeight(e),u=this.horizontalRendererHeight,m=this.percentOverlap/100,p=0;p<t.length;p++){var f=t[p],g=f.lane;if("dataItems"===o){var _=this.cellPaddingTop;_+=0==m?g*(u+this.verticalGap):g*(u-m*u);var v=!1,R=l;if(this.expandRenderer){for(var w=f.startOffset;w<=f.endOffset;w++)if(n[w]){v=!0;break}R=v?l-this.expandRendererHeight:l}if(R>=_+u){var C=this._createRenderer(f,"horizontal",this.horizontalRenderer,"dojoxCalendarHorizontal"),x=this.isItemBeingEdited(f)&&!this.liveLayout&&this._isEditing,y=x?l-this.cellPaddingTop:u,b=f.end-f.start;a("ie")>=9&&f.start+b<this.itemContainer.offsetWidth&&b++,h.set(C.container,{top:(x?this.cellPaddingTop:_)+"px",left:f.start+"px",width:b+"px",height:y+"px"}),this._applyRendererLayout(f,C,s,b,y,"horizontal")}else for(var H=f.startOffset;H<f.endOffset;H++)null==r[H]?r[H]=[f.item]:r[H].push(f.item)}else{var C=this.decorationRendererManager.createRenderer(f,"horizontal",this.horizontalDecorationRenderer,"dojoxCalendarDecoration"),y=l,b=f.end-f.start;a("ie")>=9&&f.start+b<this.itemContainer.offsetWidth&&b++,h.set(C.container,{top:"0",left:f.start+"px",width:b+"px",height:y+"px"}),c.place(C.container,s),h.set(C.container,"display","block")}}},_layoutLabelItemsImpl:function(e,t,i,a,r){for(var o,d,s=this.renderData,l=s.cells[e],c=this._getRowHeight(e),m=this.labelRendererHeight,p=u.getMarginBox(this.itemContainer).w,f=0;f<t.length;f++)if(o=t[f],null!=o){o.sort(n.hitch(this,function(e,t){return this.dateModule.compare(e.range[0],t.range[0])}));var g=this.expandRenderer&&i[f]?c-this.expandRendererHeight:c;d=null==r||null==r[f]?this.cellPaddingTop:r[f]+this.verticalGap;for(var _=u.position(this._getCellAt(e,f)),v=_.x-s.gridTablePosX,R=0;R<o.length&&d+m+this.verticalGap<=g;R++){var w=o[R];n.mixin(w,{start:v,end:v+_.w});var C=this._createRenderer(w,"label",this.labelRenderer,"dojoxCalendarLabel"),x=this.isItemBeingEdited(w)&&!this.liveLayout&&this._isEditing,y=x?this._getRowHeight(e)-this.cellPaddingTop:m;s.rtl&&(w.start=p-w.end,w.end=w.start+_.w),h.set(C.container,{top:(x?this.cellPaddingTop:d)+"px",left:w.start+"px",width:_.w+"px",height:y+"px"}),this._applyRendererLayout(w,C,l,_.w,y,"label"),d+=m+this.verticalGap}for(var R;R<o.length;R++)null==a[f]?a[f]=[o[R]]:a[f].push(o[R])}},_applyRendererLayout:function(e,t,i,n,a,r){var o=this.isItemBeingEdited(e),d=this.isItemSelected(e),s=this.isItemHovered(e),l=this.isItemFocused(e),u=t.renderer;u.set("hovered",s),u.set("selected",d),u.set("edited",o),u.set("focused",this.showFocus?l:!1),u.set("moveEnabled",this.isItemMoveEnabled(e._item,r)),u.set("storeState",this.getItemStoreState(e)),"label"!=r&&u.set("resizeEnabled",this.isItemResizeEnabled(e,r)),this.applyRendererZIndex(e,t,s,d,o,l),u.updateRendering&&u.updateRendering(n,a),c.place(t.container,i),h.set(t.container,"display","block")},_getCellAt:function(e,t,i){return void 0!=i&&1!=i||this.isLeftToRight()||(t=this.renderData.columnCount-1-t),this.gridTable.childNodes[0].childNodes[e].childNodes[t]},_layoutExpandRenderers:function(e,t,i){if(this.expandRenderer){var n=this.renderData;if(n.expandedRow==e)null!=n.expandedRowCol&&-1!=n.expandedRowCol&&this._layoutExpandRendererImpl(n.expandedRow,n.expandedRowCol,null,!0);else if(null==n.expandedRow)for(var a=0;a<n.columnCount;a++)t[a]&&this._layoutExpandRendererImpl(e,n.rtl?n.columnCount-1-a:a,i[a],!1)}},_layoutExpandRendererImpl:function(e,t,i,a){var r=this.renderData,o=n.clone(r.dates[e][t]),d=null,s=r.cells[e];d=this._getExpandRenderer(o,i,e,t,a);var l=u.position(this._getCellAt(e,t));l.x-=r.gridTablePosX,this.layoutExpandRenderer(d,o,i,l,this.expandRendererHeight),c.place(d.domNode,s),h.set(d.domNode,"display","block")},layoutExpandRenderer:function(e,t,i,n,a){h.set(e.domNode,{left:n.x+"px",width:n.w+"px",height:a+"px",top:n.h-a-1+"px"})},_onItemEditBeginGesture:function(e){var t=this._edProps,i=t.editedItem,n=e.dates,a=this.newDate("resizeEnd"==t.editKind?i.endTime:i.startTime);if("label"==t.rendererKind);else if("move"==e.editKind&&(i.allDay||this.roundToDay)){var r=this.renderData.dateModule;t.dayOffset=r.difference(this.floorToDay(n[0],!1,this.renderData),a,"day")}this.inherited(arguments)},_computeItemEditingTimes:function(e,t,i,n,a){var r=this.renderData.dateModule,o=this._edProps;if("label"==i);else if(e.allDay||this.roundToDay){var d=this.isStartOfDay(n[0]);switch(t){case"resizeEnd":!d&&e.allDay&&(n[0]=r.add(n[0],"day",1));case"resizeStart":d||(n[0]=this.floorToDay(n[0],!0));break;case"move":n[0]=r.add(n[0],"day",o.dayOffset);break;case"resizeBoth":d||(n[0]=this.floorToDay(n[0],!0)),this.isStartOfDay(n[1])||(n[1]=this.floorToDay(r.add(n[1],"day",1),!0))}}else n=this.inherited(arguments);return n},getTime:function(e,t,i,n){var a=this.renderData;if(null!=e){var r=u.position(this.itemContainer,!0);e.touches?(n=void 0==n?0:n,t=e.touches[n].pageX-r.x,i=e.touches[n].pageY-r.y):(t=e.pageX-r.x,i=e.pageY-r.y)}var o=u.getContentBox(this.itemContainer);0>t?t=0:t>o.w&&(t=o.w-1),0>i?i=0:i>o.h&&(i=o.h-1);var d,s=u.getMarginBox(this.itemContainer).w,l=s/a.columnCount;d=null==a.expandedRow?Math.floor(i/(u.getMarginBox(this.itemContainer).h/a.rowCount)):a.expandedRow;var o=u.getContentBox(this.itemContainer);a.rtl&&(t=o.w-t);var h=Math.floor(t/l),c=Math.floor(1440*(t-h*l)/l),m=null;return d<a.dates.length&&h<this.renderData.dates[d].length&&(m=this.newDate(this.renderData.dates[d][h]),m=this.renderData.dateModule.add(m,"minute",c)),m},_onGridMouseUp:function(e){this.inherited(arguments),this._gridMouseDown&&(this._gridMouseDown=!1,this._onGridClick({date:this.getTime(e),triggerEvent:e}))},_onGridTouchEnd:function(e){this.inherited(arguments);var t=this._gridProps;t&&(this._isEditing||(t.fromItem||t.editingOnStart||this.selectFromEvent(e,null,null,!0),t.fromItem||(this._pendingDoubleTap&&this._pendingDoubleTap.grid?(this._onGridDoubleClick({date:this.getTime(this._gridProps.event),triggerEvent:this._gridProps.event}),clearTimeout(this._pendingDoubleTap.timer),delete this._pendingDoubleTap):(this._onGridClick({date:this.getTime(this._gridProps.event),triggerEvent:this._gridProps.event}),this._pendingDoubleTap={grid:!0,timer:setTimeout(n.hitch(this,function(){delete this._pendingDoubleTap}),this.doubleTapDelay)}))),this._gridProps=null)},_onRowHeaderClick:function(e){this._dispatchCalendarEvt(e,"onRowHeaderClick")},onRowHeaderClick:function(e){},expandRendererClickHandler:function(e,t){i.stop(e);var a=t.get("rowIndex"),r=t.get("columnIndex");this._onExpandRendererClick(n.mixin(this._createItemEditEvent(),{rowIndex:a,columnIndex:r,renderer:t,triggerEvent:e,date:this.renderData.dates[a][r]}))},onExpandRendererClick:function(e){},_onExpandRendererClick:function(e){this._dispatchCalendarEvt(e,"onExpandRendererClick"),e.isDefaultPrevented()||(-1!=this.getExpandedRowIndex()?this.collapseRow():this.expandRow(e.rowIndex,e.columnIndex))},snapUnit:"minute",snapSteps:15,minDurationUnit:"minute",minDurationSteps:15,triggerExtent:3,liveLayout:!1,stayInView:!0,allowStartEndSwap:!0,allowResizeLessThan24H:!1})});