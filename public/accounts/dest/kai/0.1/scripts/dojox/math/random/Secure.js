// Copyright (c) 2005  Tom Wu
// All Rights Reserved.
// See "LICENSE-BigInteger" for details.

define("dojox/math/random/Secure",["dojo"],function(t){return t.declare("dojox.math.random.Secure",null,{constructor:function(e,i){this.prng=e;var o=this.pool=new Array(e.size);this.pptr=0;for(var n=0,s=e.size;s>n;){var r=Math.floor(65536*Math.random());o[n++]=r>>>8,o[n++]=255&r}this.seedTime(),i||(this.h=[t.connect(t.body(),"onclick",this,"seedTime"),t.connect(t.body(),"onkeypress",this,"seedTime")])},destroy:function(){this.h&&t.forEach(this.h,t.disconnect)},nextBytes:function(t){var e=this.state;if(!e){this.seedTime(),e=this.state=this.prng(),e.init(this.pool);for(var i=this.pool,o=0,n=i.length;n>o;i[o++]=0);this.pptr=0}for(var o=0,n=t.length;n>o;++o)t[o]=e.next()},seedTime:function(){this._seed_int((new Date).getTime())},_seed_int:function(t){var e=this.pool,i=this.pptr;e[i++]^=255&t,e[i++]^=t>>8&255,e[i++]^=t>>16&255,e[i++]^=t>>24&255,i>=this.prng.size&&(i-=this.prng.size),this.pptr=i}}),dojox.math.random.Secure});