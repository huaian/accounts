define("dgrid/extensions/ColumnReorder",["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/dom-class","dojo/on","dojo/query","dojo/dnd/Source"],function(n,e,o,t,r,u,d){function i(n,e){var o=e[2],t=n[o?"columnSets":"subRows"][e[1]];return o?t[e[2]]:t}function s(n,e,o){e[2]?n.columnSets[e[1]][e[2]]=o:n.subRows[e[1]]=o}function c(n){return"dgrid-"+n+"-"}function a(n,e){return e.slice(c(n).length)}var l=/(\d+)(?:-(\d+))?$/,h=e(d,{copyState:function(){return!1},checkAcceptance:function(n){return n===this},_legalMouseDown:function(n){return n.target.className.indexOf("dgrid-resize-handle")>-1?!1:this.inherited(arguments)},onDropInternal:function(n){var e=this.grid,t=l.exec(a(e.id,n[0].getAttribute("dndType"))),u=t[2]?"columnSets":"subRows",d=i(e,t),c=e.columns;this.inherited(arguments),t&&setTimeout(function(){var i,a=o.map(n[0].parentNode.childNodes,function(n){return c[n.columnId]});s(e,t,a),i={grid:e,subRow:a,column:c[n[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"},i[u]=e[u],r.emit(e.domNode,"dgrid-columnreorder",i)?e.set(u,e[u]):(s(e,t,d),e.renderHeader(),e.sort.length&&e.updateSortArrow(e.sort))},0)}}),m=e(null,{columnDndConstructor:h,_initSubRowDnd:function(n,e){var o,r,u,d,i;for(r=0,u=n.length;u>r;r++)d=n[r],d.reorderable!==!1&&(i=d.headerNode,t.add(i,"dojoDndItem"),i.setAttribute("dndType",e),o||(o=i.parentNode));o&&this._columnDndSources.push(new this.columnDndConstructor(o,{horizontal:!0,grid:this}))},renderHeader:function(){var n,e,t=c(this.id);if(this.inherited(arguments),this._columnDndSources=[],this.columnSets)for(e=0,n=this.columnSets.length;n>e;e++)o.forEach(this.columnSets[e],function(n,o){this._initSubRowDnd(n,t+e+"-"+o)},this);else o.forEach(this.subRows,function(n,e){this._initSubRowDnd(n,t+e)},this)},_destroyColumns:function(){this._columnDndSources&&o.forEach(this._columnDndSources,function(n){n.destroy()}),this.inherited(arguments)}});return m.ColumnDndSource=h,m});