define("dgrid/List",["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/on","dojo/has","./util/misc","dojo/_base/sniff"],function(e,t,i,o,r,s){function d(e){return document.getElementById(e)}function n(e){e.className="",e.parentNode&&document.body.removeChild(e)}function h(e,t){e.className="dgrid-scrollbar-measure",document.body.appendChild(e);var i=e["offset"+t]-e["client"+t];return n(e),i}function a(){return N.autoIdPrefix+p++}function l(e){i.replace(this.domNode,e,this._class||""),this._class=e}function c(){return this._class}var u=[];r("mozilla")&&u.push("has-mozilla"),r("touch")&&u.push("has-touch"),i.add(document.documentElement,u),r.add("pointer",function(e){return"PointerEvent"in e?"pointer":"MSPointerEvent"in e?"MSPointer":!1});var f,g,m="dgrid-row-odd",w="dgrid-row-even";r.add("dom-scrollbar-width",function(e,t,i){return h(i,"Width")}),r.add("dom-scrollbar-height",function(e,t,i){return h(i,"Height")}),r.add("dom-rtl-scrollbar-left",function(e,i,o){var s,d=document.createElement("div");return o.className="dgrid-scrollbar-measure",o.setAttribute("dir","rtl"),o.appendChild(d),document.body.appendChild(o),s=!!r("ie")||!!r("trident")||d.offsetLeft>=r("dom-scrollbar-width"),n(o),t.destroy(d),o.removeAttribute("dir"),s});var p=0,v=function(){this._started&&this.resize()},N=e(null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,addUiClasses:!0,highlightDuration:250,postscript:function(e,t){var i=this;(this._Row=function(e,t,i){this.id=e,this.data=t,this.element=i}).prototype.remove=function(){i.removeRow(this.element)},t&&(this.srcNodeRef=t=t.nodeType?t:d(t)),this.create(e,t)},listType:"list",create:function(t,i){var o,r=this.domNode=i||document.createElement("div");if(t&&(this.params=t,e.safeMixin(this,t),o=t["class"]||t.className||r.className),this.sort=this.sort||[],this._listeners=[],this._rowIdToObject={},this.postMixInProperties&&this.postMixInProperties(),this.id=r.id=r.id||this.id||a(),this.buildRendering(),o&&l.call(this,o),this.postCreate(),delete this.srcNodeRef,this.domNode.offsetHeight)this.startup();else try{this.startup()}catch(s){}},buildRendering:function(){var e,d,n,h,a=this.domNode,l=this.addUiClasses,c=this;h=this.isRTL="rtl"===(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase(),a.className="",a.setAttribute("role","grid"),i.add(a,"dgrid dgrid-"+this.listType+(l?" ui-widget":"")),e=this.headerNode=t.create("div",{className:"dgrid-header dgrid-header-row"+(l?" ui-widget-header":"")+(this.showHeader?"":" dgrid-header-hidden")},a),d=this.bodyNode=t.create("div",{className:"dgrid-scroller"},a),r("ff")&&(d.tabIndex=-1),this.headerScrollNode=t.create("div",{className:"dgrid-header dgrid-header-scroll dgrid-scrollbar-width"+(l?" ui-widget-header":"")},a),n=this.footerNode=t.create("div",{className:"dgrid-footer"+(this.showFooter?"":" dgrid-footer-hidden")},a),h&&(a.className+=" dgrid-rtl"+(r("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":"")),o(d,"scroll",function(t){c.showHeader&&(e.scrollLeft=t.scrollLeft||d.scrollLeft),t.stopPropagation(),o.emit(a,"scroll",{scrollTarget:d})}),this.configStructure(),this.renderHeader(),this.contentNode=this.touchNode=t.create("div",{className:"dgrid-content"+(l?" ui-widget-content":"")},this.bodyNode),this._listeners.push(this._resizeHandle=o(window,"resize",s.throttleDelayed(v,this)))},postCreate:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this.sort))},configStructure:function(){},resize:function(){var e=this.bodyNode,t=this.headerNode,i=this.footerNode,o=t.offsetHeight>25?t.offsetHeight:25,d=this.showFooter?i.offsetHeight:0;this.headerScrollNode.style.height=e.style.marginTop=o+"px",e.style.marginBottom=d+"px",f||(f=r("dom-scrollbar-width"),g=r("dom-scrollbar-height"),r("ie")&&(f++,g++),s.addCssRule(".dgrid-scrollbar-width","width: "+f+"px"),s.addCssRule(".dgrid-scrollbar-height","height: "+g+"px"),17!==f&&(s.addCssRule(".dgrid-header-row","right: "+f+"px"),s.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+f+"px")))},addCssRule:function(e,t){var i=s.addCssRule(e,t);return this.cleanAddedRules&&this._listeners.push(i),i},on:function(e,t){var i=o(this.domNode,e,t);return r("dom-addeventlistener")||this._listeners.push(i),i},cleanup:function(){var e;for(e in this._rowIdToObject)if(this._rowIdToObject[e]!==this.columns){var t=d(e);t&&this.removeRow(t,!0)}},destroy:function(){if(this._listeners){for(var e=this._listeners.length;e--;)this._listeners[e].remove();this._listeners=null}this._started=!1,this.cleanup(),t.destroy(this.domNode)},refresh:function(){this.cleanup(),this._rowIdToObject={},this._autoRowId=0,this.contentNode.innerHTML="",this.scrollTo({x:0,y:0})},highlightRow:function(e,t){var o="dgrid-highlight"+(this.addUiClasses?" ui-state-highlight":"");e=e.element||e,i.add(e,o),setTimeout(function(){i.remove(e,o)},t||this.highlightDuration)},adjustRowIndices:function(e){var t=e,o=t.rowIndex;if(o>-1)do t.rowIndex>-1&&(this.maintainOddEven&&i.contains(t,"dgrid-row")&&i.replace(t,o%2===1?m:w,o%2===0?m:w),t.rowIndex=o++);while((t=t.nextSibling)&&t.rowIndex!==o)},renderArray:function(e,t,i){i=i||{};var o,r=this,s=i.start||0,d=document.createDocumentFragment(),n=[],h=0,a=e.length;for(t||(this._lastCollection=e);a>h;)n[h]=this.insertRow(e[h],d,null,s++,i),h++;return o=t?t.parentNode:r.contentNode,o&&o.parentNode&&(o!==r.contentNode||a)&&(o.insertBefore(d,t||null),a&&r.adjustRowIndices(n[a-1])),n},renderHeader:function(){},_autoRowId:0,insertRow:function(e,t,i,o,r){var s=this.id+"-row-"+(this.collection&&this.collection.getIdentity?this.collection.getIdentity(e):this._autoRowId++),n=d(s),h=n&&n.previousSibling;if(n){n===i&&(i=(i.connected||i).nextSibling);try{this.removeRow(n)}catch(a){}}return n=this.renderRow(e,r),n.className=(n.className||"")+" dgrid-row "+(o%2===1?m:w)+(this.addUiClasses?" ui-state-default":""),this._rowIdToObject[n.id=s]=e,t.insertBefore(n,i||null),n.rowIndex=o,h&&h.rowIndex!==n.rowIndex-1&&this.adjustRowIndices(h),n},renderRow:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t},removeRow:function(e,i){e=e.element||e,delete this._rowIdToObject[e.id],i||t.destroy(e)},row:function(e){var t;if(e instanceof this._Row)return e;e.target&&e.target.nodeType&&(e=e.target);{if(!e.nodeType)return"object"==typeof e?t=this.collection.getIdentity(e):(t=e,e=this._rowIdToObject[this.id+"-row-"+t]),new this._Row(t,e,d(this.id+"-row-"+t));var i;do{var o=e.id;if(i=this._rowIdToObject[o])return new this._Row(o.substring(this.id.length+5),i,e);e=e.parentNode}while(e&&e!==this.domNode)}},cell:function(e){return{row:this.row(e)}},_move:function(e,t,i,o){var r,s,d;d=s=e.element,t=t||1;do if(r=s[0>t?"previousSibling":"nextSibling"]){do if(s=r,s&&(s.className+" ").indexOf(i+" ")>-1){d=s,t+=0>t?1:-1;break}while(r=(!o||!s.hidden)&&s[0>t?"lastChild":"firstChild"])}else if(s=s.parentNode,!s||s===this.bodyNode||s===this.headerNode)break;while(t);return d},up:function(e,t,i){return e.element||(e=this.row(e)),this.row(this._move(e,-(t||1),"dgrid-row",i))},down:function(e,t,i){return e.element||(e=this.row(e)),this.row(this._move(e,t||1,"dgrid-row",i))},scrollTo:function(e){"undefined"!=typeof e.x&&(this.bodyNode.scrollLeft=e.x),"undefined"!=typeof e.y&&(this.bodyNode.scrollTop=e.y)},getScrollPosition:function(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}},get:function(e){var t="_get"+e.charAt(0).toUpperCase()+e.slice(1);return"function"==typeof this[t]?this[t].apply(this,[].slice.call(arguments,1)):this[e]},set:function(e,t){if("object"==typeof e)for(var i in e)this.set(i,e[i]);else{var o="_set"+e.charAt(0).toUpperCase()+e.slice(1);"function"==typeof this[o]?this[o].apply(this,[].slice.call(arguments,1)):this[e]=t}return this},_getClass:c,_setClass:l,_getClassName:c,_setClassName:l,_setSort:function(e,t){this.sort="string"!=typeof e?e:[{property:e,descending:t}],this._applySort()},_applySort:function(){if(this.refresh(),this._lastCollection){var e=this.sort;if(e&&e.length>0){var t=e[0].property,i=!!e[0].descending;this._lastCollection.sort(function(e,o){var r=e[t],s=o[t];return void 0===r&&(r=""),void 0===s&&(s=""),r===s?0:r>s!==i?1:-1})}this.renderArray(this._lastCollection)}},_setShowHeader:function(e){var t=this.headerNode;this.showHeader=e,i.toggle(t,"dgrid-header-hidden",!e),this.renderHeader(),this.resize(),e&&(t.scrollLeft=this.getScrollPosition().x)},_setShowFooter:function(e){this.showFooter=e,i.toggle(this.footerNode,"dgrid-footer-hidden",!e),this.resize()}});return N.autoIdPrefix="dgrid_",N});