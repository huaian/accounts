define("dojo/_base/fx",["./kernel","./config","./lang","../Evented","./Color","../aspect","../sniff","../dom","../dom-style"],function(t,e,r,n,i,a,o,s,u){var p=r.mixin,c={},_=c._Line=function(t,e){this.start=t,this.end=e};_.prototype.getValue=function(t){return(this.end-this.start)*t+this.start};var d=c.Animation=function(t){p(this,t),r.isArray(this.curve)&&(this.curve=new _(this.curve[0],this.curve[1]))};d.prototype=new n,r.extend(d,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var t=this._percent,e=this.easing;return e?e(t):t},_fire:function(t,r){var n=r||[];if(this[t])if(e.debugAtAllCosts)this[t].apply(this,n);else try{this[t].apply(this,n)}catch(i){}return this},play:function(t,e){var n=this;if(n._delayTimer&&n._clearTimer(),e)n._stopTimer(),n._active=n._paused=!1,n._percent=0;else if(n._active&&!n._paused)return n;n._fire("beforeBegin",[n.node]);var i=t||n.delay,a=r.hitch(n,"_play",e);return i>0?(n._delayTimer=setTimeout(a,i),n):(a(),n)},_play:function(t){var e=this;e._delayTimer&&e._clearTimer(),e._startTime=(new Date).valueOf(),e._paused&&(e._startTime-=e.duration*e._percent),e._active=!0,e._paused=!1;var r=e.curve.getValue(e._getStep());return e._percent||(e._startRepeatCount||(e._startRepeatCount=e.repeat),e._fire("onBegin",[r])),e._fire("onPlay",[r]),e._cycle(),e},pause:function(){var t=this;return t._delayTimer&&t._clearTimer(),t._stopTimer(),t._active?(t._paused=!0,t._fire("onPause",[t.curve.getValue(t._getStep())]),t):t},gotoPercent:function(t,e){var r=this;return r._stopTimer(),r._active=r._paused=!0,r._percent=t,e&&r.play(),r},stop:function(t){var e=this;return e._delayTimer&&e._clearTimer(),e._timer?(e._stopTimer(),t&&(e._percent=1),e._fire("onStop",[e.curve.getValue(e._getStep())]),e._active=e._paused=!1,e):e},destroy:function(){this.stop()},status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){var t=this;if(t._active){var e=(new Date).valueOf(),r=0===t.duration?1:(e-t._startTime)/t.duration;r>=1&&(r=1),t._percent=r,t.easing&&(r=t.easing(r)),t._fire("onAnimate",[t.curve.getValue(r)]),t._percent<1?t._startTimer():(t._active=!1,t.repeat>0?(t.repeat--,t.play(null,!0)):-1==t.repeat?t.play(null,!0):t._startRepeatCount&&(t.repeat=t._startRepeatCount,t._startRepeatCount=0),t._percent=0,t._fire("onEnd",[t.node]),!t.repeat&&t._stopTimer())}return t},_clearTimer:function(){clearTimeout(this._delayTimer),delete this._delayTimer}});var f=0,l=null,h={run:function(){}};r.extend(d,{_startTimer:function(){this._timer||(this._timer=a.after(h,"run",r.hitch(this,"_cycle"),!0),f++),l||(l=setInterval(r.hitch(h,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,f--),0>=f&&(clearInterval(l),l=null,f=0)}});var v=o("ie")?function(t){var e=t.style;e.width.length||"auto"!=u.get(t,"width")||(e.width="auto")}:function(){};c._fade=function(t){t.node=s.byId(t.node);var e=p({properties:{}},t),n=e.properties.opacity={};n.start="start"in e?e.start:function(){return+u.get(e.node,"opacity")||0},n.end=e.end;var i=c.animateProperty(e);return a.after(i,"beforeBegin",r.partial(v,e.node),!0),i},c.fadeIn=function(t){return c._fade(p({end:1},t))},c.fadeOut=function(t){return c._fade(p({end:0},t))},c._defaultEasing=function(t){return.5+Math.sin((t+1.5)*Math.PI)/2};var m=function(t){this._properties=t;for(var e in t){var r=t[e];r.start instanceof i&&(r.tempColor=new i)}};return m.prototype.getValue=function(t){var e={};for(var n in this._properties){var a=this._properties[n],o=a.start;o instanceof i?e[n]=i.blendColors(o,a.end,t,a.tempColor).toCss():r.isArray(o)||(e[n]=(a.end-o)*t+o+("opacity"!=n?a.units||"px":0))}return e},c.animateProperty=function(e){var n=e.node=s.byId(e.node);e.easing||(e.easing=t._defaultEasing);var o=new d(e);return a.after(o,"beforeBegin",r.hitch(o,function(){function t(t,e){var r={height:t.offsetHeight,width:t.offsetWidth}[e];return void 0!==r?r:(r=u.get(t,e),"opacity"==e?+r:s?r:parseFloat(r))}var e={};for(var a in this.properties){("width"==a||"height"==a)&&(this.node.display="block");var o=this.properties[a];r.isFunction(o)&&(o=o(n)),o=e[a]=p({},r.isObject(o)?o:{end:o}),r.isFunction(o.start)&&(o.start=o.start(n)),r.isFunction(o.end)&&(o.end=o.end(n));var s=a.toLowerCase().indexOf("color")>=0;"end"in o?"start"in o||(o.start=t(n,a)):o.end=t(n,a),s?(o.start=new i(o.start),o.end=new i(o.end)):o.start="opacity"==a?+o.start:parseFloat(o.start)}this.curve=new m(e)}),!0),a.after(o,"onAnimate",r.hitch(u,"set",o.node),!0),o},c.anim=function(t,e,r,n,i,a){return c.animateProperty({node:t,duration:r||d.prototype.duration,properties:e,easing:n,onEnd:i}).play(a||0)},p(t,c),t._Animation=d,c});