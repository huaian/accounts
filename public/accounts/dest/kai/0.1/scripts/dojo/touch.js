define("dojo/touch",["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(e,t,o,a,n,c,u,r,i,d){function s(e,t,o){return D&&o?function(e,t){return c(e,o,t)}:O?function(o,a){var n=c(o,t,function(e){a.call(this,e),j=(new Date).getTime()}),u=c(o,e,function(e){(!j||(new Date).getTime()>j+1e3)&&a.call(this,e)});return{remove:function(){n.remove(),u.remove()}}}:function(t,o){return c(t,e,o)}}function g(e){do if(void 0!==e.dojoClick)return e;while(e=e.parentNode)}function l(e,t,n){function u(e){m=E?o.isDescendant(d.doc.elementFromPoint(e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX,e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY),f):m&&(e.changedTouches?e.changedTouches[0].target:e.target)==f&&Math.abs((e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX)-v)<=b&&Math.abs((e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY)-p)<=T}function r(e){d.doc.addEventListener(e,function(t){t._dojo_click||!((new Date).getTime()<=y+1e3)||"INPUT"==t.target.tagName&&a.contains(t.target,"dijitOffScreen")||(t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),"click"!=e||"INPUT"==t.target.tagName&&"radio"!=t.target.type&&"checkbox"!=t.target.type||"TEXTAREA"==t.target.tagName||"AUDIO"==t.target.tagName||"VIDEO"==t.target.tagName||t.preventDefault())},!0)}var i=g(e.target);m=!e.target.disabled&&i&&i.dojoClick,m&&(E="useTarget"==m,f=E?i:e.target,E&&e.preventDefault(),v=e.changedTouches?e.changedTouches[0].pageX-d.global.pageXOffset:e.clientX,p=e.changedTouches?e.changedTouches[0].pageY-d.global.pageYOffset:e.clientY,b=("object"==typeof m?m.x:"number"==typeof m?m:0)||4,T=("object"==typeof m?m.y:"number"==typeof m?m:0)||4,h||(h=!0,d.doc.addEventListener(t,function(e){u(e),E&&e.preventDefault()},!0),d.doc.addEventListener(n,function(e){if(u(e),m){y=(new Date).getTime();var t=E?f:e.target;"LABEL"===t.tagName&&(t=o.byId(t.getAttribute("for"))||t);var a=e.changedTouches?e.changedTouches[0]:e,n=document.createEvent("MouseEvents");n._dojo_click=!0,n.initMouseEvent("click",!0,!0,e.view,e.detail,a.screenX,a.screenY,a.clientX,a.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),setTimeout(function(){c.emit(t,"click",n),y=(new Date).getTime()},0)}},!0),r("click"),r("mousedown"),r("mouseup")))}var h,m,f,v,p,b,T,y,j,w,X=u("ios")<5,D=u("pointer-events")||u("MSPointer"),Y=function(){var e={};for(var t in{down:1,move:1,up:1,cancel:1,over:1,out:1})e[t]=u("MSPointer")?"MSPointer"+t.charAt(0).toUpperCase()+t.slice(1):"pointer"+t;return e}(),O=u("touch-events"),E=!1;D?i(function(){d.doc.addEventListener(Y.down,function(e){l(e,Y.move,Y.up)},!0)}):O&&i(function(){function e(e){var t=n.delegate(e,{bubbles:!0});return u("ios")>=6&&(t.touches=e.touches,t.altKey=e.altKey,t.changedTouches=e.changedTouches,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.targetTouches=e.targetTouches),t}w=d.body(),d.doc.addEventListener("touchstart",function(e){j=(new Date).getTime();var t=w;w=e.target,c.emit(t,"dojotouchout",{relatedTarget:w,bubbles:!0}),c.emit(w,"dojotouchover",{relatedTarget:t,bubbles:!0}),l(e,"touchmove","touchend")},!0),c(d.doc,"touchmove",function(t){j=(new Date).getTime();var o=d.doc.elementFromPoint(t.pageX-(X?0:d.global.pageXOffset),t.pageY-(X?0:d.global.pageYOffset));o&&(w!==o&&(c.emit(w,"dojotouchout",{relatedTarget:o,bubbles:!0}),c.emit(o,"dojotouchover",{relatedTarget:w,bubbles:!0}),w=o),c.emit(o,"dojotouchmove",e(t))||t.preventDefault())}),c(d.doc,"touchend",function(t){j=(new Date).getTime();var o=d.doc.elementFromPoint(t.pageX-(X?0:d.global.pageXOffset),t.pageY-(X?0:d.global.pageYOffset))||d.body();c.emit(o,"dojotouchend",e(t))})});var K={press:s("mousedown","touchstart",Y.down),move:s("mousemove","dojotouchmove",Y.move),release:s("mouseup","dojotouchend",Y.up),cancel:s(r.leave,"touchcancel",D?Y.cancel:null),over:s("mouseover","dojotouchover",Y.over),out:s("mouseout","dojotouchout",Y.out),enter:r._eventHandler(s("mouseover","dojotouchover",Y.over)),leave:r._eventHandler(s("mouseout","dojotouchout",Y.out))};return e.touch=K,K});