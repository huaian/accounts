define("dijit/form/FilteringSelect",["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(t,e,i,s,a){return t("dijit.form.FilteringSelect",[s,a],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!(!this.item||"  "===this.item.id)||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(t,e,i,s){e&&e[this.searchAttr]!==this._lastQuery||!e&&t.length&&this.store.getIdentity(t[0])!=this._lastQuery||(t.length?this.set("item",t[0],s):this.set("value","",s||void 0===s&&!this.focused,this.textbox.value,null))},_openResultList:function(t,e,i){e[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},isValueInOptions:function(t){var e=!1;return this.store.data&&$.each(this.store.data,function(i,s){return s.id===t?(e=!0,!1):void 0}),e},_setObjValueAttr:function(t){if(_.isObject(t)){var e=!1;this.store.data&&$.each(this.store.data,function(i,s){return s.id===t.value?(e=!0,!1):void 0}),e?this.set("value",t.value):this.set("displayedValue",t.desc)}},_setValueAttr:function(t,s,a,n){if(this._onChangeActive||(s=null),void 0===n){if((null===t||""===t)&&(t="",!e.isString(a)))return void this._setDisplayedValueAttr(a||"",s);var r=this;this._lastQuery=t,i(this.store.get(t),function(t){r._callbackSetLabel(t?_.isArray(t)?t:[t]:[],void 0,void 0,s)})}else this.valueNode.value=t,this.inherited(arguments,[t,s,a,n])},_setItemAttr:function(t,e,i){this.inherited(arguments),this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(t){return t.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(t,s){if($(this.textbox).attr("title",t),null==t&&(t=""),!this._created){if(!("displayedValue"in this.params))return;s=!1}if(this.store){this.closeDropDown();var a,n=e.clone(this.query),r=this._getDisplayQueryString(t);this.store._oldAPI?a=r:(a=this._patternToRegExp(r),a.toString=function(){return r}),this._lastQuery=n[this.searchAttr]=a,this.textbox.value=t,this._lastDisplayedValue=t,this._set("displayedValue",t);var l=this,u={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};e.mixin(u,this.fetchProperties),this._fetchHandle=this.store.query(n,u),i(this._fetchHandle,function(t){l._fetchHandle=null,l._callbackSetLabel(t||[],n,u,s)},function(t){l._fetchHandle=null,!l._cancelingQuery})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})});