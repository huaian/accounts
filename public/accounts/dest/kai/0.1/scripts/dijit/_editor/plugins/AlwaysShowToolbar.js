define("dijit/_editor/plugins/AlwaysShowToolbar",["dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/_base/lang","dojo/on","dojo/sniff","dojo/_base/window","../_Plugin"],function(i,e,t,o,s,r,h,l,d){return i("dijit._editor.plugins.AlwaysShowToolbar",d,{_handleScroll:!0,setEditor:function(i){i.iframe&&(this.editor=i,i.onLoadDeferred.then(s.hitch(this,this.enable)))},enable:function(i){return this._updateHeight(),this.own(r(window,"scroll",s.hitch(this,"globalOnScrollHandler")),this.editor.on("NormalizedDisplayChanged",s.hitch(this,"_updateHeight"))),i},_updateHeight:function(){var i=this.editor;if(i.isLoaded&&!i.height){var e=o.getMarginSize(i.editNode).h;if(h("opera")&&(e=i.editNode.scrollHeight),e||(e=o.getMarginSize(i.document.body).h),this._fixEnabled&&(e+=o.getMarginSize(this.editor.header).h),0!=e){if(h("ie")<=7&&this.editor.minHeight){var t=parseInt(this.editor.minHeight);t>e&&(e=t)}e!=this._lastHeight&&(this._lastHeight=e,o.setMarginBox(i.iframe,{h:this._lastHeight}))}}},_lastHeight:0,globalOnScrollHandler:function(){var i=h("ie")<7;if(this._handleScroll){var s=this.editor.header;this._scrollSetUp||(this._scrollSetUp=!0,this._scrollThreshold=o.position(s,!0).y);var r=o.docScroll(this.editor.ownerDocument).y,l=s.style;if(r>this._scrollThreshold&&r<this._scrollThreshold+this._lastHeight){if(!this._fixEnabled){var d=o.getMarginSize(s);this.editor.iframe.style.marginTop=d.h+"px",i?(l.left=o.position(s).x,s.previousSibling?this._IEOriginalPos=["after",s.previousSibling]:s.nextSibling?this._IEOriginalPos=["before",s.nextSibling]:this._IEOriginalPos=["last",s.parentNode],this.editor.ownerDocumentBody.appendChild(s),e.add(s,"dijitIEFixedToolbar")):(l.position="fixed",l.top="0px"),o.setMarginBox(s,{w:d.w}),l.zIndex=2e3,this._fixEnabled=!0}var n=this.height?parseInt(this.editor.height):this.editor._lastHeight;l.display=r>this._scrollThreshold+n?"none":""}else this._fixEnabled&&(this.editor.iframe.style.marginTop="",l.position="",l.top="",l.zIndex="",l.display="",i&&(l.left="",e.remove(s,"dijitIEFixedToolbar"),this._IEOriginalPos?(t.place(s,this._IEOriginalPos[1],this._IEOriginalPos[0]),this._IEOriginalPos=null):t.place(s,this.editor.iframe,"before")),l.width="",this._fixEnabled=!1)}},destroy:function(){this._IEOriginalPos=null,this._handleScroll=!1,this.inherited(arguments),h("ie")<7&&e.remove(this.editor.header,"dijitIEFixedToolbar")}})});