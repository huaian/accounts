define("dijit/popup",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/dom","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/has","dojo/keys","dojo/_base/lang","dojo/on","./place","./BackgroundIframe","./Viewport","./main"],function(e,t,o,i,n,r,a,s,p,d,l,u,h,c,f,g){function v(){this._popupWrapper&&(r.destroy(this._popupWrapper),delete this._popupWrapper)}var _=o(null,{_stack:[],_beginZIndex:1e3,_idGen:1,_repositionAll:function(){if(this._firstAroundNode){var e=this._firstAroundPosition,t=a.position(this._firstAroundNode,!0),o=t.x-e.x,i=t.y-e.y;if(o||i){this._firstAroundPosition=t;for(var n=0;n<this._stack.length;n++){var r=this._stack[n].wrapper.style;r.top=parseFloat(r.top)+i+"px","auto"==r.right?r.left=parseFloat(r.left)+o+"px":r.right=parseFloat(r.right)-o+"px"}}this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),o||i?10:50)}},_createWrapper:function(e){var o=e._popupWrapper,i=e.domNode;if(!o){o=r.create("div",{"class":"dijitPopup",style:{display:"none"},role:"region","aria-label":e["aria-label"]||e.label||e.name||e.id},e.ownerDocumentBody),o.appendChild(i);var n=i.style;n.display="",n.visibility="",n.position="",n.top="0px",e._popupWrapper=o,t.after(e,"destroy",v,!0),"ontouchend"in document&&u(o,"touchend",function(e){/^(input|button|textarea)$/i.test(e.target.tagName)||e.preventDefault()})}return o},moveOffScreen:function(e){var t=this._createWrapper(e),o=a.isBodyLtr(e.ownerDocument),i={visibility:"hidden",top:"-9999px",display:""};return i[o?"left":"right"]="-9999px",i[o?"right":"left"]="auto",s.set(t,i),t},hide:function(e){var t=this._createWrapper(e);s.set(t,{display:"none",height:"auto",overflow:"visible",border:""});var o=e.domNode;"_originalStyle"in o&&(o.style.cssText=o._originalStyle)},getTopPopup:function(){for(var e=this._stack,t=e.length-1;t>0&&e[t].parent===e[t-1].widget;t--);return e[t]},open:function(e){for(var t=this._stack,o=e.popup,r=o.domNode,g=e.orient||["below","below-alt","above","above-alt"],v=e.parent?e.parent.isLeftToRight():a.isBodyLtr(o.ownerDocument),_=e.around,y=e.around&&e.around.id?e.around.id+"_dropdown":"popup_"+this._idGen++;t.length&&(!e.parent||!i.isDescendant(e.parent.domNode,t[t.length-1].widget.domNode));)this.close(t[t.length-1].widget);var m=this.moveOffScreen(o);o.startup&&!o._started&&o.startup();var b,x=a.position(r);if("maxHeight"in e&&-1!=e.maxHeight)b=e.maxHeight||1/0;else{var w=f.getEffectiveBox(this.ownerDocument),C=_?a.position(_,!1):{y:e.y-(e.padding||0),h:2*(e.padding||0)};b=Math.floor(Math.max(C.y,w.h-(C.y+C.h)))}if(x.h>b){var j=s.getComputedStyle(r),L=j.borderLeftWidth+" "+j.borderLeftStyle+" "+j.borderLeftColor;s.set(m,{overflowY:"scroll",height:b+"px",border:L}),r._originalStyle=r.style.cssText,r.style.border="none"}n.set(m,{id:y,style:{zIndex:this._beginZIndex+t.length},"class":"dijitPopup "+(o.baseClass||o["class"]||"").split(" ")[0]+"Popup",dijitPopupParent:e.parent?e.parent.id:""}),0==t.length&&_&&(this._firstAroundNode=_,this._firstAroundPosition=a.position(_,!0),this._aroundMoveListener=setTimeout(l.hitch(this,"_repositionAll"),50)),p("config-bgIframe")&&!o.bgIframe&&(o.bgIframe=new c(m));var P=o.orient?l.hitch(o,"orient"):null,T=_?h.around(m,_,g,v,P):h.at(m,e,"R"==g?["TR","BR","TL","BL"]:["TL","BL","TR","BR"],e.padding,P);m.style.visibility="visible",r.style.visibility="visible";var A=[];return A.push(u(m,"keydown",l.hitch(this,function(t){if(t.keyCode==d.ESCAPE&&e.onCancel)t.stopPropagation(),t.preventDefault(),e.onCancel();else if(t.keyCode==d.TAB){t.stopPropagation(),t.preventDefault();var o=this.getTopPopup();o&&o.onCancel&&o.onCancel()}}))),o.onCancel&&e.onCancel&&A.push(o.on("cancel",e.onCancel)),A.push(o.on(o.onExecute?"execute":"change",l.hitch(this,function(){var e=this.getTopPopup();e&&e.onExecute&&e.onExecute()}))),t.push({widget:o,wrapper:m,parent:e.parent,onExecute:e.onExecute,onCancel:e.onCancel,onClose:e.onClose,handlers:A}),o.onOpen&&o.onOpen(T),T},close:function(t){for(var o=this._stack;t&&e.some(o,function(e){return e.widget==t})||!t&&o.length;){var i=o.pop(),n=i.widget,r=i.onClose;n.bgIframe&&(n.bgIframe.destroy(),delete n.bgIframe),n.onClose&&n.onClose();for(var a;a=i.handlers.pop();)a.remove();n&&n.domNode&&this.hide(n),r&&r()}0==o.length&&this._aroundMoveListener&&(clearTimeout(this._aroundMoveListener),this._firstAroundNode=this._firstAroundPosition=this._aroundMoveListener=null)}});return g.popup=new _});