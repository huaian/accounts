var fs=require("fs"),path=require("path"),less=require("../../../util/less/lib/less"),options={compress:!1,optimization:1,silent:!1},allFiles=[].concat(fs.readdirSync("."),fs.readdirSync("form").map(function(s){return"form/"+s}),fs.readdirSync("layout").map(function(s){return"layout/"+s})),lessFiles=allFiles.filter(function(s){return s&&"variables.less"!=s&&/\.less$/.test(s)});lessFiles.forEach(function(s){fs.readFile(s,"utf-8",function(e,r){e&&process.exit(1),new less.Parser({paths:[path.dirname(s)],optimization:options.optimization,filename:s}).parse(r,function(e,r){if(e)less.writeError(e,options),process.exit(1);else try{var i=r.toCSS({compress:options.compress}),t=s.replace(".less",".css"),o=fs.openSync(t,"w");fs.writeSync(o,i,0,"utf8")}catch(n){less.writeError(n,options),process.exit(2)}})})});