define("data/model/c.abstract.model",["common/c.class.inherit","common/c.ajax","cutil/c.util.common","cutil/c.util.path","dojo/Deferred"],function(t,i,e,n,s){var o=new t.Class({__propertys__:function(){this.url=null,this.param=null,this.dataformat=null,this.validates=[],this.protocol=window.location.protocol.indexOf("https")>-1?"https":"http",this.contentType=o.CONTENT_TYPE_JSON,this.method="POST",this.ajaxOnly=!1,this.timeout=5e4,this.ajax=null,this.isAbort=!1,this.onBeforeCompleteCallback=null,this.toString=function(){return this.buildurl&&this.buildurl()},this.getUrl=this.toString},initialize:function(t){this.assert();for(var i in t)this[i]=t[i]},assert:function(){},setAttr:function(t,i){this[t]=i},pushValidates:function(t){"function"==typeof t&&this.validates.push($.proxy(t,this))},setParam:function(t,i){"object"!=typeof t||i?this.param[t]=i:this.param=t},getParam:function(){var t;return _.isObject(this.param)&&(t=$.extend(!0,{},this.param)),t||{}},getResult:function(){return this.result},getResultStore:function(){return this.getResult()},buildurl:function(){var t=this.url;if(!e.isUrl(this.url)){var i="m.stackoverflow.cc",s="";"http"==this.protocol&&Kai.restfullApi?s=Kai.restfullApi:"https"==this.protocol&&Kai.restfullApiHttps&&(s=Kai.restfullApiHttps),s&&e.isUrl(s)&&(i=n.parseUrl(s).hostname),t=this.protocol+"://"+i+"/restapi"+this.url}return t},appendSuffix:function(t){var i=e.getGuid();if(!Kai.isHybrid&&!Kai.isInCtripApp&&i&&i.indexOf("-")<0){var n=t.indexOf("?")>-1?"&":"?";t=t+n+"_fxpcqlniredt="+i}return t},_execute:function(t,e,n,s,a,r,h){this.isAbort=!1;var l=this.appendSuffix(this.buildurl()),u=this,c=$.proxy(function(i){function s(){require([Kai.app.vendor.is("CTRIP")||Kai.isHybrid?"cHybridMember":"cWebMember"],function(t){t.memberLogin({param:"from="+encodeURIComponent(window.location.href)})})}if(this.validates&&this.validates.length>0)for(var o=0,a=this.validates.length;a>o;o++){var r=this.validates[o](i);if("boolean"==typeof r){if(!r)return"function"==typeof e?e.call(n||this,i):!1}else if(r&&r.overdue)return void s()}var h="function"==typeof this.dataformat?this.dataformat(i):i;"function"==typeof this.onBeforeCompleteCallback&&this.onBeforeCompleteCallback(h),"function"==typeof t&&t.call(n||this,h,i)},this),f=$.proxy(function(t){return n&&n.hideLoading&&n.hideLoading(),u.isAbort?(u.isAbort=!1,"function"==typeof s?s.call(n||this,t):!1):void("function"==typeof e&&e.call(n||this,t))},this),p=a||this.getParam();return this._avoidEncapsulationBody||(p.contentType=this.contentType),this.contentType===o.CONTENT_TYPE_JSON?this.ajax=i.cros(l,this.method,p,c,f,this.timeout):this.contentType===o.CONTENT_TYPE_JSONP?this.ajax=i.jsonp(l,p,c,f,this.timeout):this.ajax=i.post(l,p,c,f,this.timeout)},execute:function(t,i,e,n,o,a){var a=new s;this._execute(t,i,e,n,o,a)},abort:function(){this.isAbort=!0,this.ajax&&this.ajax.abort&&this.ajax.abort()}});return o.getInstance=function(){return this.instance instanceof this?this.instance:this.instance=new this},o.CONTENT_TYPE_JSON="json",o.CONTENT_TYPE_FORM="form",o.CONTENT_TYPE_JSONP="jsonp",o});