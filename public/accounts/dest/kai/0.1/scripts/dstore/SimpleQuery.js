define("dstore/SimpleQuery",["dojo/_base/declare","dojo/_base/array"],function(r,n){function t(r,n){if(r.indexOf(".")>-1){var t=r.split("."),e=t.length;return function(r){for(var u=0;e>u;u++)r=r&&(n&&r.get?r.get(t[u]):r[t[u]]);return r}}return function(n){return n.get?n.get(r):n[r]}}var e={eq:function(r,n){return r===n},"in":function(r,t){return n.indexOf(t.data||t,r)>-1},ne:function(r,n){return r!==n},lt:function(r,n){return n>r},lte:function(r,n){return n>=r},gt:function(r,n){return r>n},gte:function(r,n){return r>=n},match:function(r,n,t){return n.test(r,t)},contains:function(r,t,e,u){var o=this;return n.every(t.data||t,function(t){if("object"==typeof t&&t.type){var i=o._getFilterComparator(t.type);return n.some(r,function(r){return i.call(o,r,t.args[1],e,u)})}return n.indexOf(r,t)>-1})}};return r(null,{_createFilterQuerier:function(r){function e(r){var n=r.type,f=r.args,c=o._getFilterComparator(n);if(c){var a=f[0],l=t(a,u),s=f[1];return s&&s.fetchSync&&(s=s.fetchSync()),function(r){return c.call(o,l(r),s,r,a)}}switch(n){case"and":case"or":for(var v=0,d=f.length;d>v;v++){var g=e(f[v]);i=i?function(r,t){return"and"===n?function(n){return r(n)&&t(n)}:function(n){return r(n)||t(n)}}(i,g):g}return i;case"function":return f[0];case"string":var h=o[f[0]];if(!h)throw new Error("No filter function "+f[0]+" was found in the collection");return h;case void 0:return function(){return!0};default:throw new Error('Unknown filter operation "'+n+'"')}}var u=this.queryAccessors,o=this,i=e(r);return function(r){return n.filter(r,i)}},_getFilterComparator:function(r){return e[r]||this.inherited(arguments)},_createSelectQuerier:function(r){return function(t){var e=r.length;return n.map(t,r instanceof Array?function(n){for(var t={},u=0;e>u;u++){var o=r[u];t[o]=n[o]}return t}:function(n){return n[r]})}},_createSortQuerier:function(r){var n=this.queryAccessors;return function(e){return e=e.slice(),e.sort("function"==typeof r?r:function(e,u){for(var o=0;o<r.length;o++){var i,f=r[o];if("function"==typeof f)i=f(e,u);else{var c=f.get||(f.get=t(f.property,n)),a=f.descending,l=c(e),s=c(u);if(null!=l&&(l=l.valueOf()),null!=s&&(s=s.valueOf()),l===s)i=0;else{var v="undefined"==typeof s||null===s&&"undefined"!=typeof l||null!=l&&s>l;i=Boolean(a)===v?1:-1}}if(0!==i)return i}return 0}),e}}})});