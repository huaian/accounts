define("util/doh/plugins/android-webdriver-robot",["dojo/has","dojo/_base/xhr","doh/runner","dojo/sniff","dojo/dom-geometry","doh/plugins/remoteRobot"],function(e,o,n,t,d,r){function a(e){var n=e.commandString,t=e.deferred,d=e.immediate;d||!u?(u=!0,o(e.method,{url:r+"/"+n,headers:{"Content-Type":"application/json"},postData:e.postData,load:function(e){u=!1,t&&t.callback(e),c.length&&a(c.shift())},error:function(e){}})):c.push(e)}var i=window.parent?window.parent:window,c=[],u=!1,l=0,s=0,m=null,f={};window.dojo&&(f[dojo.keys.END]=57360,f[dojo.keys.HOME]=57361,f[dojo.keys.LEFT_ARROW]=57362,f[dojo.keys.UP_ARROW]=57363,f[dojo.keys.RIGHT_ARROW]=57364,f[dojo.keys.DOWN_ARROW]=57365,f[dojo.keys.F1]=57393,f[dojo.keys.F2]=57394,f[dojo.keys.F3]=57395,f[dojo.keys.F4]=57396,f[dojo.keys.F5]=57397,f[dojo.keys.F6]=57398,f[dojo.keys.F7]=57399,f[dojo.keys.F8]=57400,f[dojo.keys.F9]=57401,f[dojo.keys.F10]=57402,f[dojo.keys.F11]=57403,f[dojo.keys.F12]=57404);var y={node:null,reference:""};return _robot={_setKey:function(e){n.robot._onKeyboard()},_callLoaded:function(e){},_initKeyboard:function(e){},_initWheel:function(e){},setDocumentBounds:function(e,o,n,t,d){},_spaceReceived:function(){},_notified:function(e,o){},_nextKeyGroupACK:function(e){},typeKey:function(e,o,n,t,d,r,i,c,u){var l=new dojo.Deferred;l.then(function(e){e=e.replace(/\{/g,"({").replace(/\}/g,"})"),e=e.replace(/[^ -~]/g,"");var t=dojo.fromJson(e),i=t.value.ELEMENT,c=(d?'"'+String.fromCharCode(dojo.keys.CTRL)+'",':"")+(r?'"'+String.fromCharCode(dojo.keys.SHIFT)+'",':"");c+=n in f?'"'+String.fromCharCode(f[n])+'"':n?'"'+String.fromCharCode(n)+'"':'"'+String.fromCharCode(o)+'"',a({method:"POST",commandString:"element/"+i+"/value",postData:'{"value":['+c+"]}",deferred:null,immediate:!1})}),a({method:"POST",commandString:"execute",postData:'{"script":"return document.activeElement;","args":[]}',deferred:l,immediate:!1})},upKey:function(e,o,n,t){},downKey:function(e,o,n,t){},moveMouse:function(e,o,n,t,d){o=Math.round(o),n=Math.round(n),m||(m=dojo.doc.createElement("div"),dojo.style(m,{position:"fixed",left:"0px",top:"0px",width:"5px",height:"5px","background-color":"red"}),dojo.body().appendChild(m)),l=o-i.scrollX,s=n-i.scrollY,m.style.left=o+5+"px",m.style.top=n+5+"px",a({method:"POST",commandString:"touch/move",postData:'{"x":'+l+',"y":'+l+"}",deferred:null,immediate:!1})},pressMouse:function(e,o,n,t,d){var r=new dojo.Deferred;r.then(function(){m.style.backgroundColor="yellow"}),a({method:"POST",commandString:"touch/down",postData:'{"x":'+l+',"y":'+s+"}",deferred:r,immediate:!1})},releaseMouse:function(e,o,n,t,d){var r=new dojo.Deferred;r.then(function(){m.style.backgroundColor="red"}),a({method:"POST",commandString:"touch/up",postData:'{"x":'+(l+1)+',"y":'+(s+1)+"}",deferred:r,immediate:!1})},typeKeys:function(e,o,n){var t=new dojo.Deferred;t.then(function(o){o=o.replace(/\{/g,"({").replace(/\}/g,"})"),o=o.replace(/[^ -~]/g,"");var n=dojo.fromJson(o),t=n.value.ELEMENT,d=new dojo.Deferred;d.then(function(){y={node:dojo.doc.activeElement,reference:t}}),a({method:"POST",commandString:"element/"+t+"/value",postData:'{"value":["'+e+'"]}',deferred:d,immediate:!1})}),dojo.doc.activeElement!=y.node?(y={node:dojo.doc.activeElement,reference:null},a({method:"POST",commandString:"execute",postData:"{script:'return document.activeElement;',args:[]}",deferred:t,immediate:!1})):t.callback("{value:{ELEMENT:'"+y.reference+"'}}")},_scrollIntoView:function(e){p=d.position(e),i.scrollTo(p.x,p.y)}},e.add("doh-custom-robot",function(){return e("android")&&_robot}),_robot});