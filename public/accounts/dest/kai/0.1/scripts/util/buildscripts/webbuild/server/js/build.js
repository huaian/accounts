define("util/buildscripts/webbuild/server/js/build",["dojo","dijit","dojox"],function(i,e,t){function l(i){var e=r(i),t=Packages.org.mozilla.javascript.Context,l=t.enter();try{return l.evaluateString(this,e,i,1,null)}finally{t.exit()}}function r(i,e){e=e||"utf-8";var t=new java.io.File(i),l="\n",r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(t),e));try{for(var n=new java.lang.StringBuffer,a="";null!==(a=r.readLine());)n.append(a),n.append(l);return new String(n.toString())}finally{r.close()}}function n(i,e,t,l,r){t=t||"";var n=Packages.org.mozilla.javascript.Context.enter();try{if(n.setOptimizationLevel(-1),0==l.indexOf("shrinksafe")||"packer"==l)e=new String(Packages.org.dojotoolkit.shrinksafe.Compressor.compressScript(e,0,1,r)),-1==l.indexOf(".keepLines")&&(e=e.replace(/[\r\n]/g,""));else if("comments"==l){var a=n.compileString(e,i,1,null);e=new String(n.decompileScript(a,0)),e=e.replace(/    /g,"	"),i.match(/\/nls\//)&&(e=e.replace(/;\s*$/,""))}}finally{Packages.org.mozilla.javascript.Context.exit()}return t+e}build={make:function(i,e,t,r,a){if("1.3.2"!=e)return"invalid version";if("google"!=t&&"aol"!=t)return"invalide CDN type";if("comments"!=a&&"shrinksafe"!=a&&"none"!=a&&"shrinksafe.keepLines"!=a)return"invalid optimize type";if(!r.match(/^[\w\-\,\s\.]+$/))return"invalid dependency list";var o="http://ajax.googleapis.com/ajax/libs/dojo/";"aol"==t&&(o="http://o.aolcdn.com/dojo/"),o+=e;var s=i+e+"/",d=r||"";d&&(d='"'+d.split(",").join('","')+'"');var p=s+"util/buildscripts/";l(s+"util/buildscripts/jslib/logger.js"),l(s+"util/buildscripts/jslib/fileUtil.js"),l(s+"util/buildscripts/jslib/buildUtil.js"),l(s+"util/buildscripts/jslib/buildUtilXd.js"),l(s+"util/buildscripts/jslib/i18nUtil.js");var u=buildUtil.makeBuildOptions(["loader=xdomain","version="+e,"xdDojoPath="+o,"layerOptimize="+a]),c='dependencies = {layers: [	{		name: "dojo.js",		dependencies: ['+d+'		]	}],prefixes: [	[ "dojo", "'+s+'dojo" ],	[ "dijit", "'+s+'dijit" ],	[ "dojox", "'+s+'dojox" ]]}',j=buildUtil.evalProfile(c,!0);u.profileProperties=j,r=u.profileProperties.dependencies;var f=r.prefixes,g=fileUtil.getLineSeparator(),v=fileUtil.readFile(p+"copyright.txt")+g+fileUtil.readFile(p+"build_notice.txt");r.loader=u.loader;var m=buildUtil.makeDojoJs(buildUtil.loadDependencyList(u.profileProperties,null,p),u.version,u),b=m[1].layerName,x=m[1].contents;if(b.match(/dojo\.xd\.js/)&&u.xdDojoPath&&(x=buildUtilXd.setXdDojoConfig(x,u.xdDojoPath)),u.internStrings){f=r.prefixes||[];var k=r.internSkipList||[];x=buildUtil.interningRegexpMagic(b,x,s,f,k)}return n(b,x,v,u.layerOptimize,"")}}});