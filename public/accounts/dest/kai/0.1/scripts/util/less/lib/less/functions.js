// Copyright (c) 2006-2009 Hampton Catlin, Nathan Weizenbaum, and Chris Eppstein

define("util/less/lib/less/functions",["dojo","dijit","dojox"],function(r,n,t){!function(r){function n(n){return r.functions.hsla(n.h,n.s,n.l,n.a)}function t(n,t){return n instanceof r.Dimension&&"%"==n.unit?parseFloat(n.value*t/100):e(n)}function e(n){if(n instanceof r.Dimension)return parseFloat("%"==n.unit?n.value/100:n.value);if("number"==typeof n)return n;throw{error:"RuntimeError",message:"color functions take numbers as parameters"}}function i(r){return Math.min(1,Math.max(0,r))}r.functions={rgb:function(r,n,t){return this.rgba(r,n,t,1)},rgba:function(n,i,u,a){var o=[n,i,u].map(function(r){return t(r,256)});return a=e(a),new r.Color(o,a)},hsl:function(r,n,t){return this.hsla(r,n,t,1)},hsla:function(r,n,t,i){function u(r){return r=0>r?r+1:r>1?r-1:r,1>6*r?o+(a-o)*r*6:1>2*r?a:2>3*r?o+(a-o)*(2/3-r)*6:o}r=e(r)%360/360,n=e(n),t=e(t),i=e(i);var a=.5>=t?t*(n+1):t+n-t*n,o=2*t-a;return this.rgba(255*u(r+1/3),255*u(r),255*u(r-1/3),i)},hsv:function(r,n,t){return this.hsva(r,n,t,1)},hsva:function(r,n,t,i){r=e(r)%360/360*360,n=e(n),t=e(t),i=e(i);var u,a;u=Math.floor(r/60%6),a=r/60-u;var o=[t,t*(1-n),t*(1-a*n),t*(1-(1-a)*n)],g=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return this.rgba(255*o[g[u][0]],255*o[g[u][1]],255*o[g[u][2]],i)},hue:function(n){return new r.Dimension(Math.round(n.toHSL().h))},saturation:function(n){return new r.Dimension(Math.round(100*n.toHSL().s),"%")},lightness:function(n){return new r.Dimension(Math.round(100*n.toHSL().l),"%")},red:function(n){return new r.Dimension(n.rgb[0])},green:function(n){return new r.Dimension(n.rgb[1])},blue:function(n){return new r.Dimension(n.rgb[2])},alpha:function(n){return new r.Dimension(n.toHSL().a)},luma:function(n){return new r.Dimension(Math.round((.2126*(n.rgb[0]/255)+.7152*(n.rgb[1]/255)+.0722*(n.rgb[2]/255))*n.alpha*100),"%")},saturate:function(r,t){var e=r.toHSL();return e.s+=t.value/100,e.s=i(e.s),n(e)},desaturate:function(r,t){var e=r.toHSL();return e.s-=t.value/100,e.s=i(e.s),n(e)},lighten:function(r,t){var e=r.toHSL();return e.l+=t.value/100,e.l=i(e.l),n(e)},darken:function(r,t){var e=r.toHSL();return e.l-=t.value/100,e.l=i(e.l),n(e)},fadein:function(r,t){var e=r.toHSL();return e.a+=t.value/100,e.a=i(e.a),n(e)},fadeout:function(r,t){var e=r.toHSL();return e.a-=t.value/100,e.a=i(e.a),n(e)},fade:function(r,t){var e=r.toHSL();return e.a=t.value/100,e.a=i(e.a),n(e)},spin:function(r,t){var e=r.toHSL(),i=(e.h+t.value)%360;return e.h=0>i?360+i:i,n(e)},mix:function(n,t,e){e||(e=new r.Dimension(50));var i=e.value/100,u=2*i-1,a=n.toHSL().a-t.toHSL().a,o=((u*a==-1?u:(u+a)/(1+u*a))+1)/2,g=1-o,s=[n.rgb[0]*o+t.rgb[0]*g,n.rgb[1]*o+t.rgb[1]*g,n.rgb[2]*o+t.rgb[2]*g],b=n.alpha*i+t.alpha*(1-i);return new r.Color(s,b)},greyscale:function(n){return this.desaturate(n,new r.Dimension(100))},contrast:function(r,n,t,e){return r.rgb?("undefined"==typeof t&&(t=this.rgba(255,255,255,1)),"undefined"==typeof n&&(n=this.rgba(0,0,0,1)),e="undefined"==typeof e?.43:e.value,(.2126*(r.rgb[0]/255)+.7152*(r.rgb[1]/255)+.0722*(r.rgb[2]/255))*r.alpha<e?t:n):null},e:function(n){return new r.Anonymous(n instanceof r.JavaScript?n.evaluated:n)},escape:function(n){return new r.Anonymous(encodeURI(n.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},"%":function(n){for(var t=Array.prototype.slice.call(arguments,1),e=n.value,i=0;i<t.length;i++)e=e.replace(/%[sda]/i,function(r){var n=r.match(/s/i)?t[i].value:t[i].toCSS();return r.match(/[A-Z]$/)?encodeURIComponent(n):n});return e=e.replace(/%%/g,"%"),new r.Quoted('"'+e+'"',e)},unit:function(n,t){return new r.Dimension(n.value,t?t.toCSS():"")},round:function(r,n){var t="undefined"==typeof n?0:n.value;return this._math(function(r){return r.toFixed(t)},r)},ceil:function(r){return this._math(Math.ceil,r)},floor:function(r){return this._math(Math.floor,r)},_math:function(n,t){if(t instanceof r.Dimension)return new r.Dimension(n(parseFloat(t.value)),t.unit);if("number"==typeof t)return n(t);throw{type:"Argument",message:"argument must be a number"}},argb:function(n){return new r.Anonymous(n.toARGB())},percentage:function(n){return new r.Dimension(100*n.value,"%")},color:function(n){if(n instanceof r.Quoted)return new r.Color(n.value.slice(1));throw{type:"Argument",message:"argument must be a string"}},iscolor:function(n){return this._isa(n,r.Color)},isnumber:function(n){return this._isa(n,r.Dimension)},isstring:function(n){return this._isa(n,r.Quoted)},iskeyword:function(n){return this._isa(n,r.Keyword)},isurl:function(n){return this._isa(n,r.URL)},ispixel:function(n){return n instanceof r.Dimension&&"px"===n.unit?r.True:r.False},ispercentage:function(n){return n instanceof r.Dimension&&"%"===n.unit?r.True:r.False},isem:function(n){return n instanceof r.Dimension&&"em"===n.unit?r.True:r.False},_isa:function(n,t){return n instanceof t?r.True:r.False},multiply:function(r,n){var t=r.rgb[0]*n.rgb[0]/255,e=r.rgb[1]*n.rgb[1]/255,i=r.rgb[2]*n.rgb[2]/255;return this.rgb(t,e,i)},screen:function(r,n){var t=255-(255-r.rgb[0])*(255-n.rgb[0])/255,e=255-(255-r.rgb[1])*(255-n.rgb[1])/255,i=255-(255-r.rgb[2])*(255-n.rgb[2])/255;return this.rgb(t,e,i)},overlay:function(r,n){var t=r.rgb[0]<128?2*r.rgb[0]*n.rgb[0]/255:255-2*(255-r.rgb[0])*(255-n.rgb[0])/255,e=r.rgb[1]<128?2*r.rgb[1]*n.rgb[1]/255:255-2*(255-r.rgb[1])*(255-n.rgb[1])/255,i=r.rgb[2]<128?2*r.rgb[2]*n.rgb[2]/255:255-2*(255-r.rgb[2])*(255-n.rgb[2])/255;return this.rgb(t,e,i)},softlight:function(r,n){var t=n.rgb[0]*r.rgb[0]/255,e=t+r.rgb[0]*(255-(255-r.rgb[0])*(255-n.rgb[0])/255-t)/255;t=n.rgb[1]*r.rgb[1]/255;var i=t+r.rgb[1]*(255-(255-r.rgb[1])*(255-n.rgb[1])/255-t)/255;t=n.rgb[2]*r.rgb[2]/255;var u=t+r.rgb[2]*(255-(255-r.rgb[2])*(255-n.rgb[2])/255-t)/255;return this.rgb(e,i,u)},hardlight:function(r,n){var t=n.rgb[0]<128?2*n.rgb[0]*r.rgb[0]/255:255-2*(255-n.rgb[0])*(255-r.rgb[0])/255,e=n.rgb[1]<128?2*n.rgb[1]*r.rgb[1]/255:255-2*(255-n.rgb[1])*(255-r.rgb[1])/255,i=n.rgb[2]<128?2*n.rgb[2]*r.rgb[2]/255:255-2*(255-n.rgb[2])*(255-r.rgb[2])/255;return this.rgb(t,e,i)},difference:function(r,n){var t=Math.abs(r.rgb[0]-n.rgb[0]),e=Math.abs(r.rgb[1]-n.rgb[1]),i=Math.abs(r.rgb[2]-n.rgb[2]);return this.rgb(t,e,i)},exclusion:function(r,n){var t=r.rgb[0]+n.rgb[0]*(255-r.rgb[0]-r.rgb[0])/255,e=r.rgb[1]+n.rgb[1]*(255-r.rgb[1]-r.rgb[1])/255,i=r.rgb[2]+n.rgb[2]*(255-r.rgb[2]-r.rgb[2])/255;return this.rgb(t,e,i)},average:function(r,n){var t=(r.rgb[0]+n.rgb[0])/2,e=(r.rgb[1]+n.rgb[1])/2,i=(r.rgb[2]+n.rgb[2])/2;return this.rgb(t,e,i)},negation:function(r,n){var t=255-Math.abs(255-n.rgb[0]-r.rgb[0]),e=255-Math.abs(255-n.rgb[1]-r.rgb[1]),i=255-Math.abs(255-n.rgb[2]-r.rgb[2]);return this.rgb(t,e,i)},tint:function(r,n){return this.mix(this.rgb(255,255,255),r,n)},shade:function(r,n){return this.mix(this.rgb(0,0,0),r,n)}}}(require("./tree"))});