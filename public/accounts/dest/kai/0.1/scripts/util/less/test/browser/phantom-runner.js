define("util/less/test/browser/phantom-runner",["dojo","dijit","dojox"],function(dojo,dijit,dojox){function waitFor(testFx,onReady,timeOutMillis){var maxtimeOutMillis=timeOutMillis?timeOutMillis:10001,start=(new Date).getTime(),condition=!1,interval=setInterval(function(){(new Date).getTime()-start<maxtimeOutMillis&&!condition?condition="string"==typeof testFx?eval(testFx):testFx():condition?("string"==typeof onReady?eval(onReady):onReady(),clearInterval(interval)):phantom.exit(1)},100)}function testPage(e){var t=webpage.create();t.open(e,function(e){"success"!==e?phantom.exit():waitFor(function(){return t.evaluate(function(){return document.body&&document.body.querySelector&&null===document.body.querySelector(".symbolSummary .pending")&&null!==document.body.querySelector(".results")})},function(){t.onConsoleMessage=function(e){};var e=t.evaluate(function(){var e=document.body.querySelectorAll(".results > #details > .specDetail.failed");if(e&&e.length>0){for(i=0;i<e.length;++i){var t=e[i];t.querySelector(".description"),t.querySelector(".resultMessage.fail")}return 1}return 0});testFinished(e)})})}function scanDirectory(e,t){var o=[];return fs.list(e).forEach(function(e){e.match(t)&&o.push(e)}),o}function testFinished(e){e&&totalFailed++,totalDone++,totalDone===totalTests&&phantom.exit(totalFailed>0?1:0)}var webpage=require("webpage"),server=require("webserver").create(),system=require("system"),fs=require("fs"),host,port=8081,listening=server.listen(port,function(e,t){var o=("test/"+e.url.slice(1)).replace(/[\\\/]/g,fs.separator);return fs.exists(o)&&fs.isFile(o)?(t.statusCode=200,t.headers={Cache:"no-cache","Content-Type":"text/html"},t.write(fs.read(o)),void t.close()):(t.statusCode=404,t.write("<html><head></head><body><h1>File Not Found</h1><h2>File:"+o+"</h2></body></html>"),void t.close())});listening||phantom.exit();var totalTests=0,totalFailed=0,totalDone=0;if(2!=system.args.length&&"--no-tests"!=system.args[1]){var files=scanDirectory("test/browser/",/^test-runner-.+\.htm$/);totalTests=files.length,files.forEach(function(e){testPage("http://localhost:8081/browser/"+e)})}});