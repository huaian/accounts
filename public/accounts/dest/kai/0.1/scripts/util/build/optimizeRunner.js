define("util/build/optimizeRunner",["dojo","dijit","dojox"],function(dojo,dijit,dojox){function writeFile(e,o,t,i){3===arguments.length&&"string"!=typeof t&&(i=t,t=0);var r,a=new java.io.File(e);r=t?new java.io.OutputStreamWriter(new java.io.FileOutputStream(a),t):new java.io.OutputStreamWriter(new java.io.FileOutputStream(a));var n=new java.io.BufferedWriter(r);try{n.write(o)}finally{n.close()}i&&i(0)}function sscompile(e,o,t,i){for(var r=t.split("."),a=0,n=0,s=null;r.length;)switch(r.pop()){case"normal":s="normal";break;case"warn":s="warn";break;case"all":s="all";break;case"keeplines":n=1;break;case"comments":a=1}var c,l=Packages.org.mozilla.javascript.Context.enter();try{if(l.setOptimizationLevel(-1),c=readFile(e,"utf-8"),a){var p=l.compileString(c,o,1,null);c=new String(l.decompileScript(p,0)),c=c.replace(/	 /g,"	")}else c=new String(Packages.org.dojotoolkit.shrinksafe.Compressor.compressScript(c,0,1,s)),n||(c=c.replace(/[\r\n]/g,""))}finally{Packages.org.mozilla.javascript.Context.exit()}writeFile(o,i+built+c,"utf-8")}function ccompile(e,o,t,i,r,a){jscomp||(JSSourceFilefromCode=java.lang.Class.forName("com.google.javascript.jscomp.SourceFile").getMethod("fromCode",[java.lang.String,java.lang.String]),closurefromCode=function(e,o){return JSSourceFilefromCode.invoke(null,[e,o])},jscomp=com.google.javascript.jscomp);var n=closurefromCode("fakeextern.js"," "),s=o.match(/^.+[\\\/](.+)$/)[1],c=closurefromCode(s+".uncompressed.js",String(readFile(e,"utf-8"))),l=new jscomp.CompilerOptions;for(var p in r)l[p]=r[p];l.setSourceMapOutputPath(""),l.setSourceMapFormat(jscomp.SourceMap.Format.V3),-1!==t.indexOf(".keeplines")&&(l.prettyPrint=!0);var m=jscomp.CompilationLevel.SIMPLE_OPTIMIZATIONS;m.setOptionsForCompilationLevel(l);var u=jscomp.WarningLevel.DEFAULT;u.setOptionsForWarningLevel(l),Packages.com.google.javascript.jscomp.Compiler.setLoggingLevel(java.util.logging.Level.SEVERE);var g=a?"\n//# sourceMappingURL="+s+".map":"",v=new Packages.com.google.javascript.jscomp.Compiler(Packages.java.lang.System.err);if(v.compile(n,c,l),writeFile(o,i+built+v.toSource()+g,"utf-8"),a){var j=v.getSourceMap();j.setWrapperPrefix(i+built);var f=new java.lang.StringBuffer;j.appendTo(f,s),writeFile(o+".map",f.toString(),"utf-8")}}for(var built="//>>built\n",JSSourceFilefromCode,closurefromCode,jscomp=0,console=new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.System["in"])),readLine=function(){return console.readLine()+""},src,dest,optimizeSwitch;;){if(src=readLine(),"."===src)break;dest=readLine(),optimizeSwitch=readLine();var options=eval("("+readLine()+")");print(dest+":");var start=(new Date).getTime(),exception="";try{/closure/.test(optimizeSwitch)?ccompile(src,dest,optimizeSwitch,options.copyright,options.options,options.useSourceMaps):sscompile(src,dest,optimizeSwitch,options.copyright)}catch(e){exception=". OPTIMIZER FAILED: "+e}print("Done (compile time:"+((new Date).getTime()-start)/1e3+"s)"+exception)}});