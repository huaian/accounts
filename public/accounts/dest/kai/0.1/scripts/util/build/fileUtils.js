define("util/build/fileUtils",["./fs","./buildControlBase","dojo/has"],function(fs,bc,has){var getFilename=function(e){return/\//.test(e)?e.match(/^.*\/([^\/]+)$/)[1]:e},getFilepath=function(e){if(/\//.test(e)){var t=e.match(/^(.*)\/[^\/]+$/)[1];return t.length?t:"/"}return""},getFiletype=function(e,t){var a=e.match(/(\.([^\/]*))$/);return a&&(t?a[2]:a[1])||""},cleanupPath=function(e){return e=e||"",e=e.replace(/\\/g,"/"),e.length>1&&"/"==e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e},catPath=function(e,t){if(arguments.length>2){for(var a=[],r=1;r<arguments.length;a.push(arguments[r++]));return catPath(cleanupPath(e),catPath.apply(this,a))}return t&&t.length?e&&e.length?(cleanupPath(e)+"/"+cleanupPath(t)).replace(/\/\/\/?/g,"/"):cleanupPath(t):cleanupPath(e)},compactPath=function(e){var t,a,r=[];for(e=e.replace(/\\/g,"/").split("/");e.length;)t=e.shift(),".."==t&&r.length&&".."!=a?(r.pop(),a=r[r.length-1]):"."!=t&&r.push(a=t);return r.join("/")},isAbsolutePathRe=has("is-windows")?/^((\\\\)|([^\/\\]+\:))/:/^\//,isAbsolutePath=function(e){return e&&e.length&&isAbsolutePathRe.test(e)},normalize=function(e){return has("is-windows")?e.replace(/\//g,"\\"):e},getAbsolutePath=function(e,t){return e=cleanupPath(e),isAbsolutePath(e)||(e=catPath(t,e)),compactPath(e)},computePath=function(e,t){return e=cleanupPath(e),compactPath(isAbsolutePath(e)?e:catPath(t,e))},getTimestamp=function(e){var t=function(e){return"-"+(10>e?"0"+e:e)};return e.getFullYear()+t(e.getMonth()+1)+t(e.getDate())+t(e.getHours())+t(e.getMinutes())+t(e.getSeconds())},dirExists=function(e){try{return fs.statSync(e).isDirectory()}catch(t){return!1}},fileExists=function(e){try{return fs.statSync(e).isFile()}catch(t){return!1}},checkedDirectories={},clearCheckedDirectoriesCache=function(){checkedDirectories={}},ensureDirectory=function(e){if(!checkedDirectories[e]){if(!dirExists(e)){ensureDirectory(getFilepath(e));try{fs.mkdirSync(e,493)}catch(t){}}checkedDirectories[e]=1}},ensureDirectoryByFilename=function(e){ensureDirectory(getFilepath(e))},readAndEval=function(filename,type){try{if(fileExists(filename))return eval("("+fs.readFileSync(filename,"utf8")+")")}catch(e){bc.log("failedReadAndEval",["filename",filename,"type",type,"error",e])}return{}},maybeRead=function(e){try{if(fileExists(e))return fs.readFileSync(e,"utf8")}catch(t){}return 0};return{getFilename:getFilename,getFilepath:getFilepath,getFiletype:getFiletype,cleanupPath:cleanupPath,isAbsolutePath:isAbsolutePath,normalize:normalize,getAbsolutePath:getAbsolutePath,catPath:catPath,compactPath:compactPath,computePath:computePath,getTimestamp:getTimestamp,dirExists:dirExists,ensureDirectory:ensureDirectory,ensureDirectoryByFilename:ensureDirectoryByFilename,clearCheckedDirectoriesCache:clearCheckedDirectoriesCache,readAndEval:readAndEval,maybeRead:maybeRead,fileExists:fileExists}});