function main(e,t){var r=e.replace(/[^\/]*$/,""),s=fs.readFileSync(e).toString("utf-8"),n=processCss(s,r,r),i=n.standardCss;n.xstyleCss&&(i+='x-xstyle{content:"'+n.xstyleCss.replace(/["\\\n\r]/g,"\\$&")+'";}'),t&&fs.writeFileSync(t,i)}function minify(e){return e.replace(/\/\*([^\*]|\*[^\/])*\*\//g," ").replace(/\s*("(\\\\|[^\"])*"|'(\\\\|[^\'])*'|[;}{:])\s*/g,"$1")}function processCss(e,t,r,s){function n(){}function i(e){this.caller=e,this.args=[]}function a(e){}function o(e,r){r=pathModule.dirname(r)+"/";var n=pathModule.relative(t,r);return e.replace(/url\s*\(\s*['"]?([^'"\)]*)['"]?\s*\)/g,function(e,t){if(s||/#inline$/.test(t)){if(suffix=t.match(/\.(\w+)(#|\?|$)/),suffix=suffix&&suffix[1],t=t.replace(/[\?#].*/,""),"undefined"!=typeof java){var i=new java.io.File(pathModule.join(r,t)),a=i.length(),o=new java.io.FileInputStream(i),u=java.lang.reflect.Array.newInstance(java.lang.Byte.TYPE,a);o.read(u,0,a);for(var l=new Array(a),f=0;f<u.length;f++){var c=u[f];0>c&&(c=256+c),l[f]=c}var p=base64Module.encode(l)}else var p=fs.readFileSync(pathModule.join(r,t)).toString("base64");return'url("data:'+(mimeTypes[suffix]||"application/octet-stream")+";base64,"+p+'")'}var h=pathModule.resolve(n,t);return'url("'+h+'")'})}function u(e){}var l=0;n.prototype={newCall:function(e){var t=new i(e);return t.parent=this,t},childRules:0,newRule:function(e){var t=(this.rules||(this.rules={}))[e]=new n;return t.ruleIndex=this.childRules++,t.parent=this,t},getDefinition:function(e,t){var r=this;do{var s=r.definitions&&r.definitions[e]||t&&r.rules&&r.rules[e];r=r.parent}while(!s&&r);return s&&(s.name=e),s},declareDefinition:function(e,t,r){var s={toString:function(){return t.toString(2)}};(this.xstyleCss=this.xstyleCss||[]).push(e+"=",s,";");var i=this.definitions||(this.definitions={});i[e]=t||new n},setValue:function(e,t){var r=this.getDefinition(e),s=this.browserCss=this.browserCss||[];this.ruleStarted||this.root||(this.ruleStarted=!0,s.push(this.selector)-1,s.push("{")),r||s.push(e,":",t,";"),(r||!this.cssRule)&&(this.xstyleStarted||(this.xstyleStarted=!0,this.xstyleCss=this.xstyleCss||[])),(r||"object"==typeof t)&&this.xstyleCss.push(e+":"+t+";")},onArguments:function(){},toString:function(e){var t="";t+=this.xstyleCss?this.xstyleCss.join(""):"";for(var r in this.rules){var s=this.rules[r];s.ref&&!s.creating&&(t+=s.toString(1))}return this.root||!t&&1==e||(t=(2==e&&this.bases||this.tagName||"")+"{"+this.ref+t.replace(/\s+/g," ")+"}"),t},onRule:function(){this.browserCss&&(this.browserCss.push("}"),this.ref="/"+l,l++,c.push(this.browserCss.join("")))},extend:function(e,t){var r=this.definitions;r&&t&&(e.definitions=Object.create(r)),(e.bases=e.bases||[]).push(this.name)}};var f=i.prototype=new n;f.declareProperty=f.setValue=function(e,t){this.args.push(t)},f.toString=function(){var e=this.operator;return e+this.args+operatorMatch[e]},parse.getStyleSheet=function(e,t,r){var s,n=t[1];try{if("("===n.operator){var i=n.args[0];s=i.length?i[0].value:i.toString()}else s=pathModule.resolve(r.href,n.value)}catch(u){}var l="";try{l=fs.readFileSync(s).toString("utf-8")}catch(f){}return l=o(l,s),{localSource:l,href:s||".",insertRule:a,cssRules:[]}};var c=[],p=new n;return p.root=!0,parse(p,o(e,r),{href:r||".",cssRules:[],insertRule:a}),p.definitions={Math:1,require:1,item:1,"native":1,prefixed:1},u(p),{standardCss:minify(c.join("")),xstyleCss:p.toString(),requiredModules:requiredModules}}var operatorMatch={"{":"}","[":"]","(":")"},nextId=1;document={createElement:function(){return{style:{}}},getElementsByTagName:function(){return[]},addEventListener:function(){}},navigator={userAgent:"build"};var pseudoDefine=function(e,t,r){parse=r({isBuild:!0,isTagSupported:function(){return!0}})},requiredModules=[],base64Module;if("undefined"==typeof define){var fs=require("fs"),pathModule=require("path"),parse;define=pseudoDefine,require("./core/parser")}else define(["build/fs","./build/base64"],function(fsModule,base64){return fs=fsModule,base64Module=base64,pathModule={resolve:function(e,t){t=e.replace(/[^\/]+$/,"")+t;for(var r=t.replace(/\/[^\/]*\/\.\./g,"");t!==(r=t.replace(/\/[^\/]*\/\.\./g,""));)t=r;return t.replace(/\/\.\//g,"/")},dirname:function(e){return e.replace(/[\/\\][^\/\\]*$/,"")},relative:function(e,t){e=this.dirname(e);for(var r=e.split(/[\/\\]/),s=t.split(/[\/\\]/),n=s.length,i=0;n>i&&s[i]===r[i];i++);for(s.splice(0,i);i<r.length;i++)s.unshift("..");return s.join("/")},join:function(e,t){return(("/"==e[e.length-1]?e:e+"/")+t).replace(/\/[^\/]*\/\.\./g,"").replace(/\/\./g,"")}},function(xstyleText){var define=pseudoDefine,vm;try{require(["dojo/node!vm"]),vm=require("dojo/node!vm")}catch(e){}return vm?vm.runInNewContext(xstyleText,{define:define,console:console},"xstyle/core/parser.js"):eval(xstyleText),processCss}});var mimeTypes={eot:"application/vnd.ms-fontobject",woff:"application/font-woff",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png"};"undefined"!=typeof module&&require.main==module&&main.apply(this,process.argv.slice(2));