/*!inherited ||
								// if it is inherited, we need to check to make sure there isn't an existing property */

define("xstyle/core/Rule",["xstyle/core/expression","xstyle/core/Definition","put-selector/put","xstyle/core/utils"],function(e,t,r,n){function s(e,t,r){try{e[t]=r}catch(n){}}function i(){}function l(r,n,s,i){var l=r.calls;if(l)for(var o,u=0;u<r.length;u++){var h=r[u];if(h instanceof a){r.hasOwnProperty(u)||(r[u]=h=f(h));var c=h.ref&&(h.ref.selfResolving?h.ref.apply(n,h.getArgs(),n):e.evaluate(n,[h.caller,h]));void 0!==c&&((o||(o=[])).push(c),h.evaluated=!0)}}if(o){var v=e.react(function(){for(var e=0,t=r.slice(),n=0;n<r.length;n++){var s=r[n];s instanceof a&&s.evaluated&&(t[n-1]=r[n-1].slice(0,-s.caller.length),t[n]=arguments[e++])}return t.join("")});v.skipResolve=!0;var d=new t;return d.setCompute(v.apply(d,o,d)),d}return i?void 0:r.toString()}function a(e){this.caller=e,this.args=[]}function o(e,t,r,s){return n.when(t,function(t){var n=t;return t&&t.forRule&&((e._subRuleListeners||(e._subRuleListeners=[])).push(function(e){var t=n.forRule(e,!0);t&&t.forElement?u(e,t,s):r&&r(t)}),t=t.forRule(e)),t&&t.forElement?u(e,t,s):void(r&&r(t))})}function u(e,t,r){return require(["xstyle/core/elemental"],function(n){n.addRenderer(e,function(e){var n=t.forElement(e);r&&r(n,e)})})}var f=Object.create||function(e){function t(){}return t.prototype=e,new t},h=n.convertCssNameToJs,c={"{":"}","[":"]","(":")"},v=r("div").style;i.prototype={property:function(e){return(this._properties||(this._properties={}))[e]||(this._properties[e]=new Proxy(this.get(e)))},eachProperty:function(e){for(var t=this.values||0,r=0;r<t.length;r++){var n=t[r];e.call(this,n||"unnamed",t[n])}},fullSelector:function(){return(this.parent?this.parent.fullSelector():"")+(this.selector||"")+" "},newRule:function(e){var t=(this.rules||(this.rules={}))[e]=new i;return t.disabled=this.disabled,t.parent=this,t},newCall:function(e){var t=new a(e);return t.parent=this,t},addSheetRule:function(e,t){if("@"!=e.charAt(0)){var r=this.styleSheet,n=r.cssRules||r.rules,s=this.ruleIndex>-1?this.ruleIndex:n.length;try{r.addRule(e,t||" ",s)}catch(i){!e.match(/-(moz|webkit|ie)-/)}return n[s]}},onRule:function(){var e=this.getCssRule();if(this.installStyles)for(var t=0;t<this.installStyles.length;t++){var r=this.installStyles[t];s(e.style,r[0],r[1])}},setStyle:function(e,t){this.cssRule?s(this.cssRule.style,e,t):(this.installStyles||(this.installStyles=[])).push([e,t])},getCssRule:function(){return this.cssRule||(this.cssRule=this.addSheetRule(this.selector,this.cssText)),this.cssRule},get:function(e){return this.values[e]},elements:function(e){var t=this;require(["xstyle/core/elemental"],function(r){r.addRenderer(t,function(t){e(t)})})},declareDefinition:function(t,r,n){if(t=t&&h(t),!this.disabled){var s=this;if(!r.length){var i=this.definitions||(this.definitions={});return i[t]=r}if(">"==r[0].toString().charAt(0)){if(!t)return this.generator=r,void require(["xstyle/core/generate","xstyle/core/elemental"],function(e,t){r=e.forSelector(r,s),t.addRenderer(s,r)})}else{var l=t in v||this.getDefinition(t);if(!n||!l){var i=this.definitions||(this.definitions={}),a=r[0];if(a.indexOf&&a.indexOf(",")>-1)for(var o=r.join("").split(/\s*,\s*/),u=[],f=0;f<o.length;f++)u[f]=e.evaluate(this,o[f]);if(r[0]&&"{"==r[0].operator?u=r[0]:r[1]&&"{"==r[1].operator&&(u=r[1]),u=u||e.evaluate(this,r),u.then){var c=u;u={then:function(e){return c.then(function(t){return e(d(t))})}}}var d=function(e){return e.define&&(e=e.define(s,t)),e};return i[t]=d(u)}}}},onArguments:function(e){var t=e.ref;return t&&t.apply(this,e.getArgs(),this)},setValue:function(e,t,r){var n=h(e);if(!this.disabled){var i=this.values||(this.values=[]);if(i.push(n),i[n]=t,e){var l=this;do{var a=(r||this).getDefinition(e);if(void 0!==a){if(this.cssRule&&(!a||!a.keepCSSValue)){var u=this.cssRule.style;n in u&&s(u,n,"")}o(l,a.put(t,l,n))}e=e.substring(0,e.lastIndexOf("-"))}while(e)}n in v&&this._setStyleFromValue(n,t,!0)}},_setStyleFromValue:function(e,t,r){var a=t[0];if(a instanceof i)for(var o=a.values,f=0;f<o.length;f++){var h=o[f];this._setStyleFromValue(e+("main"==h?"":h.charAt(0).toUpperCase()+h.slice(1)),o[h])}else{var c=t.calls;if(c){var v=this,d=t.expression=l(t,this,e,!0);if(d){var p=t.expression&&t.expression.valueOf(),y=function(t,r){var n=p&&p.forRule?p.forRule(t,!0):p;if(n&&n.forElement){var i=r&&r.elements;if(i)for(var l=0;l<i.length;l++)for(var a=i[l].querySelectorAll(t.selector),o=0;o<a.length;o++){var f=a[o];s(f.style,e,n.forElement(f))}else u(t,n,function(t,r){s(r.style,e,t)})}else t.setStyle(e,n)},g=[v];n.when(p,function(e){p=e,p&&p.forRule&&(v._subRuleListeners||(v._subRuleListeners=[])).push(function(e){g.push(e),y(e)}),y(v)}),t.expression.depend({invalidate:function(e){n.when(t.expression.valueOf(),function(t){p=t;for(var r=0;r<g.length;r++){var n=!0,s=g[r];if(e&&e.rules){n=!1;for(var i=0;i<e.rules.length;i++)if(e.rules[i]===s){n=!0;break}}n&&y(s,e)}})}})}}r||this.setStyle(e,t)}},put:function(e){var t=this;return{forRule:function(r){if(t.extend(r),"defaults"!=e&&e&&"string"==typeof e&&t.values)for(var n=e.toString().split(/,\s*/),s=0;s<n.length;s++){var i=t.values[s];i&&r.setValue(i,n[s],t)}}}},extend:function(e,t){var r=this;(r.derivatives||(r.derivatives=[])).push(e);var n=(r.cssText,r.extraSelector);n&&(e.selector+=n);for(var s=r.cssRule.style,i=e.getCssRule().style,l=e.inheritedStyles||(e.inheritedStyles={}),a=0;a<s.length;a++){var o=h(s[a]);(!i[o]||l[o])&&(i[o]=s[o],l[o]=!0)}if(r.values&&(e.values=f(r.values)),t){var u=r.definitions;u&&(e.definitions=f(u)),e.tagName=r.tagName||e.tagName}(e.bases||(e.bases=[])).push(r);for(var c=this._subRuleListeners||0,a=0;a<c.length;a++)c[a](e);var d=e.getCssRule().style;r.eachProperty(function(t,r){"object"==typeof r&&(r=f(r)),t in v&&!d[t]&&e._setStyleFromValue(t,r)});var p=r.generator;if(p){if(p instanceof Array){p=p.slice(0);for(var a=0;a<p.length;a++){var y=p[a];if("{"===y.operator){var g=e.newRule();g.selector=y.selector+e.selector.slice(1),g.styleSheet=e.styleSheet||e.cssRule.parentStyleSheet,y.extend(g,!0),p[a]=g}}}e.declareDefinition(null,p)}},getDefinition:function(e,t){e=h(e);var r=this;do{var n=r.definitions&&r.definitions[e];void 0===n&&t&&r[t]&&(n=r[t][e]),r=r.parent}while(void 0===n&&r);return n},newElement:function(){return r((this.tagName||"span")+(this.selector||""))},cssText:""},e.evaluateText=l;var d=a.prototype=new i;return d.declareDefinition=d.setValue=function(e,t){this.args.push(t)},d.toString=function(){var e=this.operator;return e+this.args+c[e]},i.updateStaleProperties=function(){},i});