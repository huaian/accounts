define("page/viewHelper",[],function(){"use strict";function t(t){return function(){Kai.forward(t)}}var i={},s=function(t,i){this.self=t,_.isFunction(this.init)&&this.init(i)};return s.prototype={init:function(t){this.listContainer=t.listContainer,this.listTplFun=t.listTplFun,this.NO_MORE_DOM=t.NO_MORE_DOM,this.NO_RESULT_DOM=t.NO_RESULT_DOM,this.startIndex=t.startIndex,this.endIndex=t.endIndex,this.iscomplete=!1,this.isScrollError=!1,this.totalRecordCount=t.dataCount||Math.pow(2,53)-1,this.pageCount=t.pageCount,this.listTemplateFunctionId=t.listTemplateFunctionId,this.bottomLoading=t.bottomLoading},scrollAdapter:function(t,i){this.self;t&&t.body&&t.body.obj?(this.totalRecordCount=t.body.obj.page.dataCount,this.startIndex=this.startIndex+this.pageCount,i?this.addListAct(t):this.listAct(t)):this.errorEvt(i)},listAct:function(t){var i=this.self;i.hideLoading(),window.scrollTo(0,0),this.listRender(t.body.obj.list)},addListAct:function(t){this.self;this.hideBottomLoading(),this.addListRender(t.body.obj.list)},errorEvt:function(t){var i=this.self;return i.hideLoading(),this.hideBottomLoading(),t?(i.showToast({text:"加载失败，请稍后再试"}),this.isScrollError=!0,this.iscomplete=!1,i.endPull(),i.showErrorMsg(),!1):(i.endPull(),void window.scrollTo(0,0))},listRender:function(t){var i=this.self;t&&t.length>0?this.endIndex>this.totalRecordCount?(this.iscomplete=!0,this.NO_MORE_DOM&&this.NO_MORE_DOM.show(),i.endPull(),i.closePull()):(this.iscomplete=!1,i.endPull(),this.NO_MORE_DOM&&this.NO_MORE_DOM.hide()):(this.iscomplete=!0,this.NO_RESULT_DOM&&this.NO_RESULT_DOM.show(),i.endPull(),i.closePull(),this.NO_MORE_DOM&&this.NO_MORE_DOM.hide()),i.$el.find(".kai_widget").length>0?i.reparse(this.listTplFun,{list:t},{clear:!0}):i.reparse({list:t},{templateFunctionId:this.listTemplateFunctionId,clear:!0})},addListRender:function(t){var i=this.self,s=null,o="";s=this.listContainer.is("ul")||this.listContainer.hasClass("list_container")?this.listContainer:this.listContainer.find(".list_container"),_.isArray(t)&&t.length>0&&(o=i.reparse({list:t},{keepOld:!0,templateFunctionId:this.listTemplateFunctionId}),s.append(o?$(o):"").show()),this.endIndex>this.totalRecordCount||this.startIndex>this.totalRecordCount?(this.iscomplete=!0,this.NO_MORE_DOM&&this.NO_MORE_DOM.show(),this.hideBottomLoading(),i.endPull(),i.closePull()):(this.iscomplete=!1,i.endPull(),this.NO_MORE_DOM&&this.NO_MORE_DOM.hide())},showBottomLoading:function(){this.bottomLoading&&this.bottomLoading.show()},hideBottomLoading:function(){this.bottomLoading&&(this.bottomLoading.hide(),this.bottomLoading=null)},getScroll:function(){event.targetTouches[0].clientY}},i.listHelper=s,i.getChangeViewFunction=t,i});