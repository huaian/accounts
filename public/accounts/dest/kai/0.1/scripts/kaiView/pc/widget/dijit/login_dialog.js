require({cache:{"url:kaiView/pc/widget/dijit/templates/login_dialog.html":'<div  data-dojo-attach-point="containerNode">\n	<div data-dojo-type="dijit/Dialog" data-dojo-props=\'\n			title:"请输入用户名密码"\' data-dojo-attach-point=\'dialog\' class="login-dialog">\n		<section class="login-container animation-bounce">\n			<form data-dojo-type="dijit/form/Form" data-dojo-props=\'doLayout:false\' data-dojo-attach-point=\'form\'>\n				<div class="login boxShadow-white-200 borderRadius-3">\n					<h1 class="boxShadow-white-1 borderRadius-3 background-linear-gradient-whiteffd">\n				<i class="iconfont" >&#xf0159;</i>\n				<%=title%></h1>\n				<div class="form-row">\n					<i class="iconfont">&#xf012d;</i>\n					<input  trim="true" data-dojo-type="dijit/form/TextBox" type="text" name="<%=((typeof idNameAttribute !== \'undefined\') && _.isString(idNameAttribute))?idNameAttribute:\'username\'%>" placeholder="请输入用户名">\n				</div>\n\n			    <div class="form-row"><i class="iconfont">&#xf00c9;</i>\n					<input  data-dojo-type="dijit/form/TextBox" type="password" name="<%=((typeof passwordNameAttribute !== \'undefined\') &&  _.isString(passwordNameAttribute))?passwordNameAttribute:\'password\'%>" placeholder="请输入密码">\n				</div>\n				<%if(typeof isVerificationCode != \'undefined\' && isVerificationCode){%>\n					<div class="form-row verificationCode-con"><i class="iconfont">&#xf00c9;</i>\n						<input  data-dojo-type="dijit/form/TextBox" type="text" name="captcha" placeholder="请输入验证码">\n						<button class="fl-right" data-dojo-type=\'dijit/form/Button\' data-dojo-attach-point="verificationCodeSButton" >获取验证码</button>\n					</div>\n				<%}%>\n				<!--<div class="form-row remember_me">\n					<label>\n						<input type="checkbox" name="remember_me" id="remember_me">\n						记住我？\n					</label>\n				</div>-->\n				<div class=\'form-row submit\' data-dojo-attach-point="actionBarNode">\n					<button class="auto_loginButton" data-dojo-type=\'dijit/form/Button\' data-dojo-attach-point="okButton">确认</button>\n		</div>\n	</div>\n\n</form>\n</section>\n		<div id=\'pc-login\'>\n			<div class="login-back"> </div>\n		</div>\n</div>\n</div>\n'}}),define("kaiView/pc/widget/dijit/login_dialog",["dojox/encoding/crypto/SimpleAES","dojo/on","custom/dijit/_WidgetBase","dojo/_base/declare","dojo/text!./templates/login_dialog.html","dojox/encoding/digests/_base","dojox/encoding/digests/MD5","dijit/form/Select","dijit/form/TextBox","dijit/form/Textarea","dijit/Fieldset","dijit/layout/Container","dijit/Dialog","dijit/form/RadioButton","dijit/ConfirmDialog","dijit/form/Form"],function(i,o,e,t,n,a,d){return t([e],{templateString:n,view:null,loginCallback:null,widgetData:null,show:function(){var i=this;i.dialog.show(),i.inherited(arguments),i.isVerificationCode=i.widgetData.isVerificationCode},els:{verificationCodeSButton:{selector:".verificationCodeSButton",type:"jquery"}},getParams:function(i){var o=this,e=o.form.get("value");return _.isObject(e)&&(e[o.widgetData.idNameAttribute]||e.username||e.loginId)&&(e[o.widgetData.passwordNameAttribute]||e.password)?(o.isVerificationCode&&i?e.captcha:1)?(o.widgetData.requireMD5Encrypt===!1||(e.password=d(e.password,a.outputTypes.Hex)),e):(o.view.hideLoading(),o.view.showToast({text:"请输入验证码"}),!1):(o.view.hideLoading(),o.view.showToast({text:"请输入用户名密码"}),!1)},countDown:function(i,o){var e=this;return o.set({label:i+"秒后可重新获取",disabled:!0}),--i>0?void(e.countDownTimeHandler=setTimeout(function(){$.proxy(e.countDown,e)(i,o)},1e3)):($.proxy(e.enableSendVerifyCodeButton,e)(o),!0)},enableSendVerifyCodeButton:function(i){var o=this;_.isNumber(o.countDownTimeHandler)&&clearTimeout(o.countDownTimeHandler),i.set({label:"获取验证码",disabled:!1})},login:function(){var o=this,e={};o.view.showLoading();var t=function(t){o.view.hideLoading(),o.view.isSucceedResponse(t)?o.view.showToast({text:"登录成功",callback:function(){o.dialog.hide();var n=o.view.responseBodyParser,a=_.isFunction(n)?n(t):t.body.obj||t.body||{};o.view.setUserStore(_.extend(a,{___password:i.encrypt(e.password,a.ssoToken||"")})),o.view.viewName.indexOf("login")>=0,window.onbeforeunload=null,Kai.restart()}}):o.view.showResponseError(t)},n=function(i){o.view.hideLoading(),o.view.showResponseError(i)};return(e=o.getParams(!0))?void(Kai.useRest?o.view._loginComm.add(e).then(function(i){t(i)},function(i){n(i)}):(o.view._loginComm.param=e,o.view._loginComm.execute(t,n,!0,o))):!1},getVerificationCode:function(){var i=this,o={};i.view.showLoading();var e=function(o){if(i.view.hideLoading(),i.view.isSucceedResponse(o)){var e=o.body.obj?o.body.obj.mobile:o.body.phone?o.body.phone:"";i.view.showToast({text:"我们已向您的["+e+"]手机发送了验证码，有效期为5分钟"}),i.countDown(60,i.verificationCodeSButton)}else i.view.showResponseError(o),i.enableSendVerifyCodeButton(i.verificationCodeSButton)},t=function(o){i.view.hideLoading(),i.view.showResponseError(o)};return(o=i.getParams(!1))?void(Kai.useRest?i.view._getVerificationCodeComm.add(o).then(function(i){e(i)},function(i){t(i)}):(i.view._getVerificationCodeComm.param=o,i.view._getVerificationCodeComm.execute(e,t,!0,i))):!1},bindEvents:function(){var i=this;return i.eventsBound?!1:(i.eventsBound=!0,o(i.form,"keyup",function(o){("Enter"==o.keyIdentifier||"Enter"==o.key)&&i.login()}),o(i.okButton,"click",function(){i.login()}),void(i.verificationCodeSButton&&o(i.verificationCodeSButton,"click",function(){return"获取验证码"!==i.verificationCodeSButton.label?!1:void i.getVerificationCode()})))}})});