define("ui/scroll/ui.scroll",[],function(){function t(t){if(this.wrapper="string"==typeof t.wrapper?$(t.wrapper):t.wrapper,this.scroller="string"==typeof t.scroller?$(t.scroller):t.scroller,!t.wrapper[0]||!t.scroller[0])throw"param error";this.swrapper=this.wrapper,this.wrapper=this.wrapper[0],this.scroller=this.scroller[0],this.scrollerStyle=this.scroller.style,this.options={step:!1,scrollbars:!0,startY:0,preventDefault:!1,scrollOffset:0,scrollType:"y",bounceTime:400,bounceEasing:e.ease.circular,bounce:!0,momentum:!0,bindToWrapper:!0,resizePolling:60,startX:0,startY:0};for(var i in t)this.options[i]=t[i];this.translateZ=" translateZ(0)",this.x=0,this.y=0,this._events={},this.dir="forward",this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function i(t){var i=document.createElement("div"),s=document.createElement("div");return i.style.cssText="position:absolute;z-index:9999",s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px","y"==t?(i.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",s.style.height="100%"):(i.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",s.style.width="100%"),i.style.cssText+=";overflow:hidden",i.appendChild(s),i}function s(t,i){this.wrapper="string"==typeof i.el?document.querySelector(i.el):i.el,this.indicator=this.wrapper.children[0],this.scrollType=i.scrollType,this.wrapperStyle=this.wrapper.style,this.indicatorStyle=this.indicator.style,this.scroller=t,this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.wrapperStyle[e.style.transform]=this.scroller.translateZ,this.wrapperStyle[e.style.transitionDuration]="0ms",this.wrapperStyle.opacity="0"}var e=function(){function t(t){return e===!1?!1:""===e?t:e+t.charAt(0).toUpperCase()+t.substr(1)}var i={},s=document.createElement("div").style,e=function(){for(var t,i=["t","webkitT","MozT","msT","OT"],e=0,o=i.length;o>e;e++)if(t=i[e]+"ransform",t in s)return i[e].substr(0,i[e].length-1);return!1}();return i.getTime=Date.now||function(){return(new Date).getTime()},i.addEvent=function(t,i,s,e){t[0]&&t!=window.top&&(t=t[0]),t.addEventListener(i,s,!!e)},i.removeEvent=function(t,i,s,e){t[0]&&t!=window.top&&(t=t[0]),t.removeEventListener(i,s,!!e)},i.momentum=function(t,i,s,e,o,r){var n,h,a=t-i,l=Math.abs(a)/s,c=6e-4;return r=r||0,n=t+l*l/(2*c)*(0>a?-1:1),h=l/c,e>n?(n=o?e-o/2.5*(l/8):e,a=Math.abs(n-t),h=a/l):n>0+r&&(n=o?o/2.5*(l/8)+r:0,a=Math.abs(t)+n,h=a/l),{destination:Math.round(n),duration:h}},$.extend(i,{hasTouch:"ontouchstart"in window}),$.extend(i.style={},{transform:t("transform"),transitionTimingFunction:t("transitionTimingFunction"),transitionDuration:t("transitionDuration"),transitionDelay:t("transitionDelay"),transformOrigin:t("transformOrigin")}),$.extend(i.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2}),$.extend(i.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return Math.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var i=4;return(t-=1)*t*((i+1)*t+i)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){var i=.22,s=.4;return 0===t?0:1==t?1:s*Math.pow(2,-10*t)*Math.sin((t-i/4)*(2*Math.PI)/i)+1}}}),i}();return t.prototype={_init:function(){this._initEvents(),this.options.scrollbars&&this._initIndicator()},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.scrollerWidth=this.scroller.offsetWidth,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.maxScrollX=this.maxScrollX-this.options.scrollOffset,this.maxScrollY=this.maxScrollY-this.options.scrollOffset,"y"==this.options.scrollType?(this.maxScrollX=0,0===this.options.scrollOffset&&(this.maxScrollY=Math.min(this.maxScrollY,0))):(this.maxScrollY=0,0===this.options.scrollOffset&&(this.maxScrollX=Math.min(this.maxScrollX,0))),this.endTime=0,this._execEvent("refresh"),this.resetPosition()},_initEvents:function(t){var i=t?e.removeEvent:e.addEvent,s=this.options.bindToWrapper?this.wrapper:window;i(window,"orientationchange",this),i(window,"resize",this),e.hasTouch?(i(this.wrapper,"touchstart",this),i(s,"touchmove",this),i(s,"touchcancel",this),i(s,"touchend",this)):(i(this.wrapper,"mousedown",this),i(s,"mousemove",this),i(s,"mousecancel",this),i(s,"mouseup",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},_start:function(t){if(this.enabled&&(!this.initiated||e.eventType[t.type]===this.initiated)){var i,s=t.touches?t.touches[0]:t;if(this.initiated=e.eventType[t.type],this.moved=!1,this.distY=0,this._transitionTime(),this.startTime=e.getTime(),this.isInTransition){this.isInTransition=!1,i=this.getComputedPosition();var o=Math.round(i.x),r=Math.round(i.y);this._translate(o,r),this._execEvent("scrollEnd")}this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=s.pageX,this.pointY=s.pageY,this._execEvent("beforeScrollStart"),this.options.preventDefault&&t.preventDefault()}},_move:function(t){if(this.enabled&&e.eventType[t.type]===this.initiated){var i,s,o,r,n=t.touches?t.touches[0]:t,h=n.pageX-this.pointX,a=n.pageY-this.pointY,l=e.getTime();if(!("x"===this.options.scrollType&&Math.abs(a)>Math.abs(h))){var c=this.x,p=this.y,u=this.x+h,d=this.y+a,f=Math.abs(h)>=Math.abs(a)?c-u>0?"left":"right":p-d>0?"up":"down";if(this.pointX=n.pageX,this.pointY=n.pageY,this.distX+=h,this.distY+=a,o=Math.abs(this.distX),r=Math.abs(this.distY),!(l-this.endTime>300&&10>o&&10>r)){"y"==this.options.scrollType?h=0:a=0,this.flipDir=f,i=this.x+h,s=this.y+a,(i>this.options.scrollOffset||i<this.maxScrollX)&&(i=this.options.bounce?this.x+h/3:i>this.options.scrollOffset?this.options.scrollOffset:this.maxScrollX),(s>this.options.scrollOffset||s<this.maxScrollY)&&(s=this.options.bounce?this.y+a/3:s>this.options.scrollOffset?this.options.scrollOffset:this.maxScrollY),this.moved||this._execEvent("scrollStart"),this.moved=!0;var m=document.activeElement;if("input"==m.nodeName.toLowerCase())return m.blur(),this.disable(),void setTimeout($.proxy(function(){this.enable()},this),250);i>this.x||s>this.y?this.dir="forward":this.dir="back",this._translate(i,s,!0),t.preventDefault()}}}},_end:function(t){if(this.enabled&&e.eventType[t.type]===this.initiated){var i,s,o=(t.changedTouches?t.changedTouches[0]:t,e.getTime()-this.startTime),r=Math.round(this.x),n=Math.round(this.y),h=(Math.abs(r-this.startX),Math.abs(n-this.startY),Math.abs(r-this.startX)),a=Math.abs(n-this.startY),l=0,c="";if(this.isInTransition=0,this.initiated=0,this.endTime=e.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(r,n),!this.moved)return void this._execEvent("scrollCancel");if(this.options.momentum&&300>o&&(i=e.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.scrollOffset),s=e.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.scrollOffset),r=i.destination,n=s.destination,l="y"==this.options.scrollType?Math.max(0,s.duration):Math.max(i.duration,0),this.isInTransition=1),h=Math.abs(r-this.startX),a=Math.abs(n-this.startY),this.options.step){var p=r,u=n,d=Math.abs(p),f=Math.abs(u),m=p>0?1:-1,y=u>0?1:-1,x=this.options.step-h%this.options.step,T=this.options.step-a%this.options.step;"forward"==this.dir?(p=p>0?d+x:d-x,u=u>0?f+T:f-T):(p=p>0?d-x:d+x,u=u>0?f-T:f+T),p%this.options.step!==0&&(p=Math.round(p/this.options.step)*this.options.step),u%this.options.step!==0&&(u=Math.round(u/this.options.step)*this.options.step),p*=m,u*=y,l=this.options.stepTime||200,("x"==this.options.scrollType&&50>h||"y"==this.options.scrollType&&50>a)&&(l=100),r=p,n=u,c=this.options.bounceEasing}return r!=this.x||n!=this.y?((r>this.options.scrollOffset||r<this.maxScrollX||n>this.options.scrollOffset||n<this.maxScrollY)&&(c=e.ease.quadratic),"0"==l&&(l=1),void this.scrollTo(r,n,l,c)):void this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},_transitionTimingFunction:function(t){this.scrollerStyle[e.style.transitionTimingFunction]=t,this.indicator&&this.indicator.transitionTimingFunction(t)},_transitionTime:function(t){t=t||0,this.scrollerStyle[e.style.transitionDuration]=t+"ms",this.indicator&&this.indicator.transitionTime(t)},getComputedPosition:function(){var t,i,s=window.getComputedStyle(this.scroller,null);return s=s[e.style.transform].split(")")[0].split(", "),t=+(s[12]||s[4]),i=+(s[13]||s[5]),{x:t,y:i}},_initIndicator:function(){var t=i("y"==this.options.scrollType?"x":"y");this.wrapper.appendChild(t),this.indicator=new s(this,{el:t,scrollType:this.options.scrollType}),this.on("scrollEnd",function(){this.indicator.fade()});var e=this;this.on("scrollCancel",function(){e.indicator.fade()}),this.on("scrollStart",function(){e.indicator.fade(1)}),this.on("beforeScrollStart",function(){e.indicator.fade(1,!0)}),this.on("refresh",function(){e.indicator.refresh()})},_translate:function(t,i,s){"y"==this.options.scrollType?t=0:i=0,this.scrollerStyle[e.style.transform]="translate("+t+"px,"+i+"px)"+this.translateZ,this.x=t,this.y=i,this.options.scrollbars&&this.indicator.updatePosition()},resetPosition:function(t){var i=this.x,s=this.y;return t=t||0,"x"==this.options.scrollType?this.x>=this.options.scrollOffset?i=this.options.scrollOffset:this.x<this.maxScrollX&&(i=this.maxScrollX):this.y>=this.options.scrollOffset?s=this.options.scrollOffset:this.y<this.maxScrollY&&(s=this.maxScrollY),"x"==this.options.scrollType&&i==this.x||"y"==this.options.scrollType&&s==this.y?!1:(this.scrollTo(i,s,t,this.options.bounceEasing),!0)},scrollTo:function(t,i,s,o){o=o||e.ease.circular,this.isInTransition=s>0,(!s||o.style)&&(this._transitionTimingFunction(o.style),this._transitionTime(s),this._translate(t,i))},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},on:function(t,i){this._events[t]||(this._events[t]=[]),this._events[t].push(i)},off:function(t,i){_.isUndefined(i)?this._events[t]=[]:this._events[t]=_.reject(this._events[t],function(t){return t==i})},_execEvent:function(t){if(this._events[t]){var i=0,s=this._events[t].length;if(s)for(;s>i;i++)this._events[t][i].call(this)}},destroy:function(){this.TIMERRES&&clearInterval(this.TIMERRES),this._initEvents(!0),this._execEvent("destroy"),this.indicator&&this.indicator.destroy()},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this._execEvent("animatEnd"),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},handleEvent:function(t){switch(t.type){case"touchstart":case"mousedown":this._start(t);break;case"touchmove":case"mousemove":this._move(t);break;case"touchend":case"mouseup":case"touchcancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t)}}},s.prototype={transitionTime:function(t){t=t||0,this.indicatorStyle[e.style.transitionDuration]=t+"ms"},transitionTimingFunction:function(t){this.indicatorStyle[e.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime();this.wrapper.offsetHeight;"y"==this.scrollType?(this.wrapperHeight=this.wrapper.clientHeight,this.indicatorHeight=Math.max(Math.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px",this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY):(this.wrapperWidth=this.wrapper.clientWidth,this.indicatorWidth=Math.max(Math.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px",this.maxPosX=this.wrapperWidth-this.indicatorWidth,this.sizeRatioX=this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.updatePosition()},destroy:function(){$(this.wrapper).remove()},updatePosition:function(){var t="x"==this.scrollType&&Math.round(this.sizeRatioX*this.scroller.x)||0,i="y"==this.scrollType&&Math.round(this.sizeRatioY*this.scroller.y)||0;this.x=t,this.y=i,this.indicatorStyle[e.style.transform]="translate("+t+"px,"+i+"px)"+this.scroller.translateZ},fade:function(t,i){if(!i||this.visible){var s=this;clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var o=t?250:500,r=t?0:300;t=t?"1":"0",this.wrapperStyle[e.style.transitionDuration]=o+"ms",this.fadeTimeout=setTimeout(function(t){s.wrapperStyle.opacity=t,s.visible=+t}(t),r)}}},t.utils=e,t});