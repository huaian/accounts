define("ui/slider/script/ui.slider",["Drag"],function(){var t=Class.create();return t.prototype={initialize:function(t,i,e){this.Bar=$(i),this.Container=$(t),this._timer=null,this._ondrag=!1,this._IsMin=this._IsMax=this._IsMid=!1,this._drag=new Drag(this.Bar,{Limit:!0,mxContainer:this.Container,onStart:Bind(this,this.DragStart),onStop:Bind(this,this.DragStop),onMove:Bind(this,this.Move)}),this.SetOptions(e),this.WheelSpeed=Math.max(0,this.options.WheelSpeed),this.KeySpeed=Math.max(0,this.options.KeySpeed),this.MinValue=this.options.MinValue,this.MaxValue=this.options.MaxValue,this.RunTime=Math.max(1,this.options.RunTime),this.RunStep=Math.max(1,this.options.RunStep),this.Ease=!!this.options.Ease,this.EaseStep=Math.max(1,this.options.EaseStep),this.onMin=this.options.onMin,this.onMax=this.options.onMax,this.onMid=this.options.onMid,this.onDragStart=this.options.onDragStart,this.onDragStop=this.options.onDragStop,this.onMove=this.options.onMove,this._horizontal=!!this.options.Horizontal,this._drag[this._horizontal?"LockY":"LockX"]=!0,addEventHandler(this.Container,"click",BindAsEventListener(this,function(t){this._ondrag||this.ClickCtrl(t)})),addEventHandler(this.Bar,"click",BindAsEventListener(this,function(t){t.stopPropagation()})),this.WheelBind(this.Container),this.KeyBind(this.Container);var s=isIE?(this.KeyBind(this.Bar),this.Bar):this.Container;addEventHandler(this.Bar,"mousedown",function(){s.focus()})},SetOptions:function(t){this.options={MinValue:0,MaxValue:100,WheelSpeed:5,KeySpeed:50,Horizontal:!0,RunTime:20,RunStep:2,Ease:!1,EaseStep:5,onMin:function(){},onMax:function(){},onMid:function(){},onDragStart:function(){},onDragStop:function(){},onMove:function(){}},Extend(this.options,t||{})},DragStart:function(){this.onDragStart(),this._ondrag=!0},DragStop:function(){this.onDragStop(),setTimeout(Bind(this,function(){this._ondrag=!1}),10)},Move:function(){this.onMove();var t=this.GetPercent();t>0?this._IsMin=!1:this._IsMin||(this.onMin(),this._IsMin=!0),1>t?this._IsMax=!1:this._IsMax||(this.onMax(),this._IsMax=!0),t>0&&1>t?this._IsMid||(this.onMid(),this._IsMid=!0):this._IsMid=!1},ClickCtrl:function(t){for(var i=this.Container,e=i.offsetLeft,s=i.offsetTop;i.offsetParent;)i=i.offsetParent,e+=i.offsetLeft,s+=i.offsetTop;this.EasePos(t.pageX-e-this.Bar.offsetWidth/2,t.pageY-s-this.Bar.offsetHeight/2)},WheelCtrl:function(t){var i=this.WheelSpeed*t.detail;this.SetPos(this.Bar.offsetLeft+i,this.Bar.offsetTop+i),t.preventDefault()},WheelBind:function(t){addEventHandler(t,isIE?"mousewheel":"DOMMouseScroll",BindAsEventListener(this,this.WheelCtrl))},KeyCtrl:function(t){if(this.KeySpeed){var i=this.Bar.offsetLeft,e=(this.Container.clientWidth-this.Bar.offsetWidth)/this.KeySpeed,s=this.Bar.offsetTop,n=(this.Container.clientHeight-this.Bar.offsetHeight)/this.KeySpeed;switch(t.keyCode){case 37:i-=e;break;case 38:s-=n;break;case 39:i+=e;break;case 40:s+=n;break;default:return}this.SetPos(i,s),t.preventDefault()}},KeyBind:function(t){addEventHandler(t,"keydown",BindAsEventListener(this,this.KeyCtrl)),t.tabIndex=-1,isIE||(t.style.outline="none")},GetValue:function(){return this.MinValue+this.GetPercent()*(this.MaxValue-this.MinValue)},SetValue:function(t){this.SetPercent((t-this.MinValue)/(this.MaxValue-this.MinValue))},GetPercent:function(){return this._horizontal?this.Bar.offsetLeft/(this.Container.clientWidth-this.Bar.offsetWidth):this.Bar.offsetTop/(this.Container.clientHeight-this.Bar.offsetHeight)},SetPercent:function(t){this.EasePos((this.Container.clientWidth-this.Bar.offsetWidth)*t,(this.Container.clientHeight-this.Bar.offsetHeight)*t)},Run:function(t){this.Stop(),t=!!t;var i=this.GetPercent()+(t?1:-1)*this.RunStep/100;this.SetPos((this.Container.clientWidth-this.Bar.offsetWidth)*i,(this.Container.clientHeight-this.Bar.offsetHeight)*i),(t?this._IsMax:this._IsMin)||(this._timer=setTimeout(Bind(this,this.Run,t),this.RunTime))},Stop:function(){clearTimeout(this._timer)},EasePos:function(t,i){if(this.Stop(),t=Math.round(t),i=Math.round(i),!this.Ease)return void this.SetPos(t,i);var e=this.Bar.offsetLeft,s=this.GetStep(t,e),n=this.Bar.offsetTop,o=this.GetStep(i,n);(this._horizontal?s:o)&&(this.SetPos(e+s,n+o),this._IsMid&&(this._timer=setTimeout(Bind(this,this.EasePos,t,i),this.RunTime)))},GetStep:function(t,i){var e=(t-i)/this.EaseStep;return 0==e?0:Math.abs(e)<1?e>0?1:-1:e},SetPos:function(t,i){this.Stop(),this._drag.SetPos(t,i)}},t});