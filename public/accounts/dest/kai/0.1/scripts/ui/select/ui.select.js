require({cache:{"url:ui/select/template/ui.select.html":'<ul class="ul-list cui-select-view " style="position: absolute; width: 100%; top: 0; left: 0;">\r\n  <%for(var i = 0, len = data.length; i < len; i++) { %>\r\n  <li data-key="<%=data[i].id %>" data-index="<%=i%>" <%if(typeof data[i].disabled != \'undefined\' && data[i].disabled == false){ %> class="disabled"\r\n    <%} %>>\r\n    <%=data[i].name %></li>\r\n  <%} %>\r\n</ul>\r\n<div class="cui-mask-gray">\r\n</div>\r\n<div class="cui-lines">\r\n  &nbsp;</div>\r\n'}}),define("ui/select/ui.select",["../ui.abstract.view","dojo/text!./template/ui.select.html","../scroll/ui.scroll"],function(t,i,e){return _.inherit(t,{propertys:function($super){$super(),this.template=i,this.datamodel={curClass:"current",data:[],id:null,index:0},this.animatTime=100,this.stepTime=150,this.itemNum=this.datamodel.data.length,this.displayNum=5,this.scrollOffset=0,this.scroll=null,this.changed=function(t){}},resetPropery:function(){this._resetNum(),this._resetIndex()},_resetIndex:function(){if(this.datamodel.id)for(var t=0,i=this.datamodel.data.length;i>t;t++)if(this.datamodel.id==this.datamodel.data[t].id){this.datamodel.index=t;break}},_resetNum:function(){this.displayNum=this.displayNum%2===0?this.displayNum+1:this.displayNum,this.itemNum=this.datamodel.data.length},initElement:function(){this.swrapper=this.$el,this.scroller=this.$(".ul-list")},initSize:function(){this.itemHeight=parseInt(window.getComputedStyle&&getComputedStyle(this.scroller.find("li").eq(0)[0]).height),this.scroller.height(this.itemHeight*this.itemNum),this.swrapper.height(this.itemHeight*this.displayNum),this.scrollOffset=(this.displayNum-1)/2*this.itemHeight},adjustPosition:function(t){if(this.scroll){this.datamodel.index<0&&(this.datamodel.index=0),this.datamodel.index>this.itemNum-1&&(this.datamodel.index=this.itemNum-1);var i,e=this.datamodel.index,s=0;i=this.itemHeight*e*-1+this.scrollOffset,t&&(s=this.animatTime),this.scroll.scrollTo(0,i,s)}},_initScroll:function(){return this.scroll?void this.scroll.refresh():(this.scroll=new e({scrollbars:!1,scrollOffset:this.scrollOffset,step:this.itemHeight,wrapper:this.swrapper,bounceTime:200,scroller:this.scroller}),this.scroll.on("scrollEnd",$.proxy(function(){this.setIndex(this.getIndexByPosition(),!0)},this)),void this.scroll.on("scrollCancel",$.proxy(function(){this.setIndex(this.getIndexByPosition(),!1)},this)))},reload:function(t){"object"==typeof t&&(t instanceof Array?this.datamodel.data=t:_.extend(this.datamodel,t)),this.scroll&&(this.scroll.destroy(),this.scroll=null),this._dataChanged=!0,this.refresh()},checkDisable:function(t){t=t||"down";var i=this.datamodel.index;this.datamodel.data[i]&&"undefined"!=typeof this.datamodel.data[i].disabled&&this.datamodel.data[i].disabled===!1&&("up"==t?(this.datamodel.index=this._checkSelectedDown(i),"number"!=typeof this.datamodel.index&&(this.datamodel.index=this._checkSelectedUp(i))):(this.datamodel.index=this._checkSelectedUp(i),"number"!=typeof this.datamodel.index&&(this.datamodel.index=this._checkSelectedDown(i)))),"number"!=typeof this.datamodel.index&&(this.datamodel.index=i)},_checkSelectedUp:function(t){for(var i=!1,e=t;-1!=e;e--)if(this.datamodel.data[e]&&("undefined"==typeof this.datamodel.data[e].disabled||this.datamodel.data[e].disabled===!0)){t=e,i=!0;break}return i?t:null},_checkSelectedDown:function(t){for(var i=!1,e=t,s=this.datamodel.data.length;s>e;e++)if(this.datamodel.data[e]&&("undefined"==typeof this.datamodel.data[e].disabled||this.datamodel.data[e].disabled===!0)){t=e,i=!0;break}return i?t:null},setIndex:function(t,i,e){"undefined"==typeof i&&t==this.datamodel.index&&(i=!0);var s,d=t,a=this.datamodel.index!=t,l=t>this.datamodel.index?"up":"down";t=parseInt(t),0>t||t>=this.itemNum||(s=this.datamodel.index,this.datamodel.index=t,this.checkDisable(l),a=s!=this.datamodel.index?!0:!1,d!=this.datamodel.index&&(i=!1),i||this.adjustPosition(!0),this.resetCss(),this._dataChanged?(this.triggerChangedAction(),this._dataChanged=!1):e!==!0&&a&&this.triggerChangedAction())},triggerChangedAction:function(){this.changed&&this.changed.call(this,this.getSelected())},resetCss:function(){this.$("li").removeClass("current"),this.$('li[data-index="'+this.datamodel.index+'"]').addClass("current")},resetIndex:function(){this.setIndex(this.datamodel.index,!0,!0)},getIndex:function(){return this.datamodel.index},setId:function(t){if(t){var i,e,s=-1;for(i=0,e=this.datamodel.data.length;e>i;i++)if(this.datamodel.data[i].id==t){s=i;break}-1!=s&&(this.datamodel.index=s,this.setIndex(s,!1))}},getId:function(){return this.getSelected().id},getSelected:function(){return this.datamodel.data[this.datamodel.index]},getIndexByPosition:function(){var t=this.scroll.y-this.scrollOffset,i=Math.abs(t)/this.itemHeight;return Math.round(i)},initialize:function($super,t){$super(t)},addEvent:function($super){$super(),this.on("onCreate",function(){this.$el.addClass("cui-roller-bd"),this.$el.addClass("cui-roller")}),this.on("onShow",function(){this.initSize(),this._initScroll(),this.adjustPosition(),this.resetCss(),this.resetIndex()},1),this.on("onHide",function(){this.scroll&&(this.scroll.destroy(),this.scroll=null)})}})});