//	Copyright (c) 2010, 2011 Alexander Schulze, Innotrade GmbH, Herzogenrath

//	with this program; if not, see <http://www.gnu.org/licenses/lgpl.html>.

/* A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 * For full source please refer to: md5.js
 */

// released under the MIT License <http://www.opensource.org/licenses/mit-license.php>

// Copyright: Hiroshi Ichikawa, http://gimite.net/en/, https://github.com/gimite/web-socket-js

define("plugin/vendor/tiNet/jWebSocket",["dojo","dijit","dojox"],function(dojo,dijit,dojox){function hex_md5(e){return rstr2hex(rstr_md5(str2rstr_utf8(e)))}function b64_md5(e){return rstr2b64(rstr_md5(str2rstr_utf8(e)))}function any_md5(e,t){return rstr2any(rstr_md5(str2rstr_utf8(e)),t)}function hex_hmac_md5(e,t){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function b64_hmac_md5(e,t){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)))}function any_hmac_md5(e,t,n){return rstr2any(rstr_hmac_md5(str2rstr_utf8(e),str2rstr_utf8(t)),n)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(e){return binl2rstr(binl_md5(rstr2binl(e),8*e.length))}function rstr_hmac_md5(e,t){var n=rstr2binl(e);n.length>16&&(n=binl_md5(n,8*e.length));for(var o=Array(16),s=Array(16),r=0;16>r;r++)o[r]=909522486^n[r],s[r]=1549556828^n[r];var i=binl_md5(o.concat(rstr2binl(t)),512+8*t.length);return binl2rstr(binl_md5(s.concat(i),640))}function rstr2hex(e){try{}catch(t){hexcase=0}for(var n,o=hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",r=0;r<e.length;r++)n=e.charCodeAt(r),s+=o.charAt(n>>>4&15)+o.charAt(15&n);return s}function rstr2b64(e){try{}catch(t){b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",s=e.length,r=0;s>r;r+=3)for(var i=e.charCodeAt(r)<<16|(s>r+1?e.charCodeAt(r+1)<<8:0)|(s>r+2?e.charCodeAt(r+2):0),a=0;4>a;a++)o+=8*r+6*a>8*e.length?b64pad:n.charAt(i>>>6*(3-a)&63);return o}function rstr2any(e,t){var n,o,s,r,i,a=t.length,c=Array(Math.ceil(e.length/2));for(n=0;n<c.length;n++)c[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var l=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),f=Array(l);for(o=0;l>o;o++){for(i=Array(),r=0,n=0;n<c.length;n++)r=(r<<16)+c[n],s=Math.floor(r/a),r-=s*a,(i.length>0||s>0)&&(i[i.length]=s);f[o]=r,c=i}var u="";for(n=f.length-1;n>=0;n--)u+=t.charAt(f[n]);return u}function str2rstr_utf8(e){for(var t,n,o="",s=-1;++s<e.length;)t=e.charCodeAt(s),n=s+1<e.length?e.charCodeAt(s+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),s++),127>=t?o+=String.fromCharCode(t):2047>=t?o+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?o+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(o+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return o}function str2rstr_utf16le(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t}function str2rstr_utf16be(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t}function rstr2binl(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function binl2rstr(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function binl_md5(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,o=-271733879,s=-1732584194,r=271733878,i=0;i<e.length;i+=16){var a=n,c=o,l=s,f=r;n=md5_ff(n,o,s,r,e[i+0],7,-680876936),r=md5_ff(r,n,o,s,e[i+1],12,-389564586),s=md5_ff(s,r,n,o,e[i+2],17,606105819),o=md5_ff(o,s,r,n,e[i+3],22,-1044525330),n=md5_ff(n,o,s,r,e[i+4],7,-176418897),r=md5_ff(r,n,o,s,e[i+5],12,1200080426),s=md5_ff(s,r,n,o,e[i+6],17,-1473231341),o=md5_ff(o,s,r,n,e[i+7],22,-45705983),n=md5_ff(n,o,s,r,e[i+8],7,1770035416),r=md5_ff(r,n,o,s,e[i+9],12,-1958414417),s=md5_ff(s,r,n,o,e[i+10],17,-42063),o=md5_ff(o,s,r,n,e[i+11],22,-1990404162),n=md5_ff(n,o,s,r,e[i+12],7,1804603682),r=md5_ff(r,n,o,s,e[i+13],12,-40341101),s=md5_ff(s,r,n,o,e[i+14],17,-1502002290),o=md5_ff(o,s,r,n,e[i+15],22,1236535329),n=md5_gg(n,o,s,r,e[i+1],5,-165796510),r=md5_gg(r,n,o,s,e[i+6],9,-1069501632),s=md5_gg(s,r,n,o,e[i+11],14,643717713),o=md5_gg(o,s,r,n,e[i+0],20,-373897302),n=md5_gg(n,o,s,r,e[i+5],5,-701558691),r=md5_gg(r,n,o,s,e[i+10],9,38016083),s=md5_gg(s,r,n,o,e[i+15],14,-660478335),o=md5_gg(o,s,r,n,e[i+4],20,-405537848),n=md5_gg(n,o,s,r,e[i+9],5,568446438),r=md5_gg(r,n,o,s,e[i+14],9,-1019803690),s=md5_gg(s,r,n,o,e[i+3],14,-187363961),o=md5_gg(o,s,r,n,e[i+8],20,1163531501),n=md5_gg(n,o,s,r,e[i+13],5,-1444681467),r=md5_gg(r,n,o,s,e[i+2],9,-51403784),s=md5_gg(s,r,n,o,e[i+7],14,1735328473),o=md5_gg(o,s,r,n,e[i+12],20,-1926607734),n=md5_hh(n,o,s,r,e[i+5],4,-378558),r=md5_hh(r,n,o,s,e[i+8],11,-2022574463),s=md5_hh(s,r,n,o,e[i+11],16,1839030562),o=md5_hh(o,s,r,n,e[i+14],23,-35309556),n=md5_hh(n,o,s,r,e[i+1],4,-1530992060),r=md5_hh(r,n,o,s,e[i+4],11,1272893353),s=md5_hh(s,r,n,o,e[i+7],16,-155497632),o=md5_hh(o,s,r,n,e[i+10],23,-1094730640),n=md5_hh(n,o,s,r,e[i+13],4,681279174),r=md5_hh(r,n,o,s,e[i+0],11,-358537222),s=md5_hh(s,r,n,o,e[i+3],16,-722521979),o=md5_hh(o,s,r,n,e[i+6],23,76029189),n=md5_hh(n,o,s,r,e[i+9],4,-640364487),r=md5_hh(r,n,o,s,e[i+12],11,-421815835),s=md5_hh(s,r,n,o,e[i+15],16,530742520),o=md5_hh(o,s,r,n,e[i+2],23,-995338651),n=md5_ii(n,o,s,r,e[i+0],6,-198630844),r=md5_ii(r,n,o,s,e[i+7],10,1126891415),s=md5_ii(s,r,n,o,e[i+14],15,-1416354905),o=md5_ii(o,s,r,n,e[i+5],21,-57434055),n=md5_ii(n,o,s,r,e[i+12],6,1700485571),r=md5_ii(r,n,o,s,e[i+3],10,-1894986606),s=md5_ii(s,r,n,o,e[i+10],15,-1051523),o=md5_ii(o,s,r,n,e[i+1],21,-2054922799),n=md5_ii(n,o,s,r,e[i+8],6,1873313359),r=md5_ii(r,n,o,s,e[i+15],10,-30611744),s=md5_ii(s,r,n,o,e[i+6],15,-1560198380),o=md5_ii(o,s,r,n,e[i+13],21,1309151649),n=md5_ii(n,o,s,r,e[i+4],6,-145523070),r=md5_ii(r,n,o,s,e[i+11],10,-1120210379),s=md5_ii(s,r,n,o,e[i+2],15,718787259),o=md5_ii(o,s,r,n,e[i+9],21,-343485551),n=safe_add(n,a),o=safe_add(o,c),s=safe_add(s,l),r=safe_add(r,f)}return Array(n,o,s,r)}function md5_cmn(e,t,n,o,s,r){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(o,r)),s),n)}function md5_ff(e,t,n,o,s,r,i){return md5_cmn(t&n|~t&o,e,t,s,r,i)}function md5_gg(e,t,n,o,s,r,i){return md5_cmn(t&o|n&~o,e,t,s,r,i)}function md5_hh(e,t,n,o,s,r,i){return md5_cmn(t^n^o,e,t,s,r,i)}function md5_ii(e,t,n,o,s,r,i){return md5_cmn(n^(t|~o),e,t,s,r,i)}function safe_add(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}function bit_rol(e,t){return e<<t|e>>>32-t}function setServerUrl(e){var t=document.location.href,n=t.indexOf("https")>-1;n?jws.JWS_SERVER_SSL_URL="wss://"+e+":8081/jWebSocket/jWebSocket":jws.JWS_SERVER_URL="ws://"+e+":8080/jWebSocket/jWebSocket"}window.MozWebSocket&&(window.WebSocket=window.MozWebSocket);var jws=window.jws={VERSION:"1.0b5 (nightly build 20105)",NS_BASE:"org.jwebsocket",NS_SYSTEM:"org.jwebsocket.plugins.system",MSG_WS_NOT_SUPPORTED:"Unfortunately your browser does neither natively support WebSockets\nnor you have the Adobe Flash-PlugIn 10+ installed.\nPlease download the last recent Adobe Flash Player at http://get.adobe.com/flashplayer.",CUR_TOKEN_ID:0,JWS_SERVER_SCHEMA:"ws",JWS_SERVER_SSL_SCHEMA:"wss",JWS_SERVER_HOST:self.location.hostname?self.location.hostname:"127.0.0.1",JWS_SERVER_PORT:8080,JWS_SERVER_SSL_PORT:8081,JWS_SERVER_CONTEXT:"/jWebSocket",JWS_SERVER_SERVLET:"/jWebSocket",JWS_SERVER_URL:"ws://"+(self.location.hostname?self.location.hostname:"127.0.0.1")+":8080/jWebSocket/jWebSocket",JWS_SERVER_SSL_URL:"wss://"+(self.location.hostname?self.location.hostname:"127.0.0.1")+":8081/jWebSocket/jWebSocket",CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,RECONNECTING:1e3,OPEN_TIMED_OUT:1001,RO_OFF:{autoReconnect:!1,reconnectDelay:-1,reconnectTimeout:-1,queueItemLimit:-1,queueSizeLimit:-1},RO_ON:{autoReconnect:!0,reconnectDelay:2e3,reconnectTimeout:3e4,queueItemLimit:1e3,queueSizeLimit:10485760},WS_SUBPROT_JSON:"org.jwebsocket.json",WS_SUBPROT_XML:"org.jwebsocket.xml",WS_SUBPROT_CSV:"org.jwebsocket.csv",WS_SUBPROT_CUSTOM:"org.jwebsocket.text",WS_SUBPROT_TEXT:"org.jwebsocket.text",WS_SUBPROT_BINARY:"org.jwebsocket.binary",SCOPE_PRIVATE:"private",SCOPE_PUBLIC:"public",DEF_RESP_TIMEOUT:3e4,BT_UNKNOWN:0,BT_FIREFOX:1,BT_NETSCAPE:2,BT_OPERA:3,BT_IEXPLORER:4,BT_SAFARI:5,BT_CHROME:6,BROWSER_NAMES:["Unknown","Firefox","Netscape","Opera","Internet Explorer","Safari","Chrome"],GUEST_USER_LOGINNAME:"guest",GUEST_USER_PASSWORD:"guest",DEMO_ROOT_LOGINNAME:"root",DEMO_ROOT_PASSWORD:"root",$:function(e){return document.getElementById(e)},getServerURL:function(e,t,n,o,s){var r=e+"://"+t+(n?":"+n:"");return o&&o.length>0&&(r+=o,s&&s.length>0&&(r+=s)),r},getDefaultServerURL:function(){return this.getServerURL(jws.JWS_SERVER_SCHEMA,jws.JWS_SERVER_HOST,jws.JWS_SERVER_PORT,jws.JWS_SERVER_CONTEXT,jws.JWS_SERVER_SERVLET)},getDefaultSSLServerURL:function(){return this.getServerURL(jws.JWS_SERVER_SSL_SCHEMA,jws.JWS_SERVER_HOST,jws.JWS_SERVER_SSL_PORT,jws.JWS_SERVER_CONTEXT,jws.JWS_SERVER_SERVLET)},browserSupportsWebSockets:function(){return null!==window.WebSocket&&void 0!==window.WebSocket},browserSupportsNativeWebSockets:function(){return null!==window.WebSocket&&void 0!==window.WebSocket}(),browserSupportsJSON:function(){return null!==window.JSON&&void 0!==window.JSON},browserSupportsNativeJSON:function(){return null!==window.JSON&&void 0!==window.JSON}(),browserSupportsWebWorkers:function(){return null!==window.Worker&&void 0!==window.Worker}(),runAsThread:function(e){if(!this.browserSupportsWebWorkers)return{code:-1,msg:"Browser does not (yet) support WebWorkers."};e||(e={});var t=null,n=null,o=jws.SCRIPT_PATH+"jwsWorker.js",s=null,r=[];e.OnMessage&&"function"==typeof e.OnMessage&&(t=e.OnMessage),e.OnError&&"function"==typeof e.OnError&&(n=e.OnError),e.file&&"String"==typeof e.file&&(o=e.file),e.method&&"function"==typeof e.method&&(s=e.method),e.args&&(r=e.args);var i=this;return jws.worker||(jws.worker=new Worker(o),jws.worker.onmessage=function(e){null!=t&&t.call(i,{data:e.data})},jws.worker.onerror=function(e){null!=n&&n.call(i,{message:e.message})}),jws.worker.postMessage({method:s.toString(),args:r}),{code:0,msg:"ok",worker:jws.worker}},SCRIPT_PATH:function(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;n>t;t++){var o=e[t],s=o.src;if(s||(s=o.getAttribute("src")),s){var r=s.lastIndexOf("jWebSocket");if(r>0)return s.substr(0,r)}}return null}(),isIE:function(){var e=navigator.userAgent,t=e.indexOf("MSIE");return t>=0}(),getBrowserName:function(){return this.fBrowserName},getBrowserVersion:function(){return this.fBrowserVerNo},getBrowserVersionString:function(){return this.fBrowserVerStr},isFirefox:function(){return this.fIsFirefox},isOpera:function(){return this.fIsOpera},isChrome:function(){return this.fIsChrome},isIExplorer:function(){return this.fIsIExplorer},isIE_LE6:function(){return this.isIExplorer()&&this.getBrowserVersion()<7},isIE_LE7:function(){return this.isIExplorer()&&this.getBrowserVersion()<8},isIE_GE8:function(){return this.isIExplorer()&&this.getBrowserVersion()>=8},isSafari:function(){return this.fIsSafari},isNetscape:function(){return this.fIsNetscape},isPocketIE:function(){return this.fIsPocketIE},console:{isActive:!1,level:2,ALL:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5,isDebugEnabled:function(){return window.console&&jws.console.isActive&&jws.console.level<=jws.console.DEBUG},isInfoEnabled:function(){return window.console&&jws.console.isActive&&jws.console.level<=jws.console.INFO},log:function(e){window.console&&jws.console.isActive},debug:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.DEBUG&&console.debug},info:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.INFO&&console.info},warn:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.WARN&&console.warn},error:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.ERROR&&console.error},fatal:function(e){window.console&&jws.console.isActive&&jws.console.level<=jws.console.FATAL&&console.fatal}}};!function(){jws.fBrowserName="unknown",jws.fBrowserType=jws.BT_UNKNOWN,jws.fBrowserVerNo=void 0,jws.fIsIExplorer=!1,jws.fIsFirefox=!1,jws.fIsNetscape=!1,jws.fIsOpera=!1,jws.fIsSafari=!1,jws.fIsChrome=!1;var e=navigator.userAgent;jws.fIsChrome=e.indexOf("Chrome")>=0,jws.fIsChrome?jws.fBrowserType=jws.BT_CHROME:(jws.fIsSafari=e.indexOf("Safari")>=0,jws.fIsSafari?jws.fBrowserType=jws.BT_SAFARI:(jws.fIsNetscape=e.indexOf("Netscape")>=0,jws.fIsNetscape?jws.fBrowserType=jws.BT_NETSCAPE:(jws.fIsFirefox="Netscape"==navigator.appName,jws.fIsFirefox?jws.fBrowserType=jws.BT_FIREFOX:(jws.fIsOpera="Opera"==navigator.appName,jws.fIsOpera?jws.fBrowserType=jws.BT_OPERA:(jws.fIsIExplorer="Microsoft Internet Explorer"==navigator.appName,jws.fIsIExplorer?jws.fBrowserType=jws.BT_IEXPLORER:(jws.fIsPocketIE="Microsoft Pocket Internet Explorer"==navigator.appName,jws.fIsPocketIE&&(jws.fBrowserType=jws.BT_IEXPLORER)))))));var t,n,o,s,r;if(jws.fIsIExplorer)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_IEXPLORER],r=e.match(/MSIE.*/i),r&&(o=r[0].substr(5),t=o.indexOf(";"),jws.fBrowserVerStr=t>0?o.substr(0,t):o,jws.fBrowserVerNo=parseFloat(jws.fBrowserVerStr));else if(jws.fIsFirefox){if(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_FIREFOX],r=e.match(/Firefox\/.*/i)){for(o=r[0].substr(8),t=o.indexOf(" "),t>0?jws.fBrowserVerStr=o.substring(0,t):jws.fBrowserVerStr=o,s=0,n=0;n<o.length&&("."==o.charAt(n)&&s++,!(s>=2));)n++;o=o.substring(0,n),jws.fBrowserVerNo=parseFloat(o)}}else if(jws.fIsNetscape){if(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_NETSCAPE],r=e.match(/Netscape\/.*/i)){for(o=r[0].substr(9),t=o.indexOf(" "),t>0?jws.fBrowserVerStr=o.substring(0,t):jws.fBrowserVerStr=o,s=0,n=0;n<o.length&&("."==o.charAt(n)&&s++,!(s>=2));)n++;o=o.substring(0,n),jws.fBrowserVerNo=parseFloat(o)}}else if(jws.fIsOpera)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_OPERA],r=e.match(/Opera\/.*/i),r&&(o=r[0].substr(6),t=o.indexOf(" "),jws.fBrowserVerStr=t>0?o.substr(0,t):o,jws.fBrowserVerNo=parseFloat(o),r=e.match(/Version\/.*/i),o=r[0].substr(8),r&&(t=o.indexOf(" "),jws.fBrowserVerStr=(t>0?o.substr(0,t):o)+"/"+jws.fBrowserVerStr,jws.fBrowserVerNo=parseFloat(o)));else if(jws.fIsChrome)jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_CHROME],r=e.match(/Chrome\/.*/i),r&&(o=r[0].substr(7),t=o.indexOf(" "),jws.fBrowserVerStr=t>0?o.substr(0,t):o,jws.fBrowserVerNo=parseFloat(o));else if(jws.fIsSafari&&(jws.fBrowserName=jws.BROWSER_NAMES[jws.BT_SAFARI],r=e.match(/Version\/.*/i))){for(o=r[0].substr(8),t=o.indexOf(" "),jws.fBrowserVerStr=t>0?o.substr(0,t):o,s=0,n=0;n<o.length&&("."==o.charAt(n)&&s++,!(s>=2));)n++;o=o.substring(0,n),jws.fBrowserVerNo=parseFloat(o),r=e.match(/Safari\/.*/i),r&&(o="."+r[0].substr(7),t=o.indexOf(" "),jws.fBrowserVerStr+=t>0?o.substr(0,t):o)}}(),jws.events={addEventListener:jws.isIE?function(e,t,n){e.attachEvent("on"+t,n)}:function(e,t,n){e.addEventListener(t,n,!1)},removeEventListener:jws.isIE?function(e,t,n){e.detachEvent("on"+t,n)}:function(e,t,n){e.removeEventListener(t,n,!1)},getTarget:jws.isIE?function(e){return e.srcElement}:function(e){return e.target},preventDefault:jws.isIE?function(e){e=window.event,e&&(e.returnValue=!1)}:function(e){return e.preventDefault()}};var hexcase=0,b64pad="";if(jws.tools={zerofill:function(e,t){var n=e.toFixed(0);if(n.length>t)n=n.substring(n.length-t);else for(;n.length<t;)n="0"+n;return n},calcMD5:function(e){return hex_md5(e)},escapeSQL:function(e){return e&&"string"==typeof aValue,e},date2ISO:function(e){var t=-e.getTimezoneOffset(),n=(Math.abs(t),e.getUTCFullYear()+"-"+this.zerofill(e.getUTCMonth()+1,2)+"-"+this.zerofill(e.getUTCDate(),2)+"T"+this.zerofill(e.getUTCHours(),2)+":"+this.zerofill(e.getUTCMinutes(),2)+":"+this.zerofill(e.getUTCSeconds(),2)+"."+this.zerofill(e.getUTCMilliseconds(),3)+"Z");return n},ISO2Date:function(e,t){var n=new Date;return n.setUTCFullYear(e.substr(0,4)),n.setUTCMonth(e.substr(5,2)-1),n.setUTCDate(e.substr(8,2)),n.setUTCHours(e.substr(11,2)),n.setUTCMinutes(e.substr(14,2)),n.setUTCSeconds(e.substr(17,2)),n.setUTCMilliseconds(e.substr(20,3)),n},date2String:function(e){var t=e.getUTCFullYear()+this.zerofill(e.getUTCMonth()+1,2)+this.zerofill(e.getUTCDate(),2)+this.zerofill(e.getUTCHours(),2)+this.zerofill(e.getUTCMinutes(),2)+this.zerofill(e.getUTCSeconds(),2)+this.zerofill(e.getUTCMilliseconds(),2);return t},string2Date:function(e){var t=new Date;return t.setUTCFullYear(e.substr(0,4)),t.setUTCMonth(e.substr(4,2)-1),t.setUTCDate(e.substr(6,2)),t.setUTCHours(e.substr(8,2)),t.setUTCMinutes(e.substr(10,2)),t.setUTCSeconds(e.substr(12,2)),t.setUTCMilliseconds(e.substr(14,3)),t},generateSharedUTID:function(e){var t=JSON.stringify(e),n=t.split("");return n.sort(),hex_md5("{"+n.toString()+"}")},getType:function(e){var t=e,n=typeof t;return"number"==n?n=parseFloat(t)==parseInt(t)?"integer":"double":"[object Array]"===Object.prototype.toString.call(t)?n="array":null===t&&(n="null"),n}},!jws.browserSupportsNativeWebSockets){var swfobject=function(){function e(){if(!H){try{var e=x.getElementsByTagName("body")[0].appendChild(S("span"));e.parentNode.removeChild(e)}catch(t){return}H=!0;for(var n=U.length,o=0;n>o;o++)U[o]()}}function t(e){H?e():U[U.length]=e}function n(e){if(typeof L.addEventListener!=k)L.addEventListener("load",e,!1);else if(typeof x.addEventListener!=k)x.addEventListener("load",e,!1);else if(typeof L.attachEvent!=k)m(L,"onload",e);else if("function"==typeof L.onload){var t=L.onload;L.onload=function(){t(),e()}}else L.onload=e}function o(){F?s():r()}function s(){var e=x.getElementsByTagName("body")[0],t=S(R);t.setAttribute("type",W);var n=e.appendChild(t);if(n){var o=0;!function(){if(typeof n.GetVariable!=k){var s=n.GetVariable("$version");s&&(s=s.split(" ")[1].split(","),G.pv=[parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)])}else if(10>o)return o++,void setTimeout(arguments.callee,10);e.removeChild(t),n=null,r()}()}else r()}function r(){var e=M.length;if(e>0)for(var t=0;e>t;t++){var n=M[t].id,o=M[t].callbackFn,s={success:!1,id:n};if(G.pv[0]>0){var r=w(n);if(r)if(!g(M[t].swfVersion)||G.wk&&G.wk<312)if(M[t].expressInstall&&a()){var f={};f.data=M[t].expressInstall,f.width=r.getAttribute("width")||"0",f.height=r.getAttribute("height")||"0",r.getAttribute("class")&&(f.styleclass=r.getAttribute("class")),r.getAttribute("align")&&(f.align=r.getAttribute("align"));for(var u={},d=r.getElementsByTagName("param"),h=d.length,p=0;h>p;p++)"movie"!=d[p].getAttribute("name").toLowerCase()&&(u[d[p].getAttribute("name")]=d[p].getAttribute("value"));c(f,u,n,o)}else l(r),o&&o(s);else b(n,!0),o&&(s.success=!0,s.ref=i(n),o(s))}else if(b(n,!0),o){var S=i(n);S&&typeof S.SetVariable!=k&&(s.success=!0,s.ref=S),o(s)}}}function i(e){var t=null,n=w(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=k)t=n;else{var o=n.getElementsByTagName(R)[0];o&&(t=o)}return t}function a(){return!J&&g("6.0.65")&&(G.win||G.mac)&&!(G.wk&&G.wk<312)}function c(e,t,n,o){J=!0,C=o||null,E={success:!1,id:n};var s=w(n);if(s){"OBJECT"==s.nodeName?(O=f(s),y=null):(O=s,y=n),e.id=A,(typeof e.width==k||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==k||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),x.title=x.title.slice(0,47)+" - Flash Player Installation";var r=G.ie&&G.win?"ActiveX":"PlugIn",i="MMredirectURL="+L.location.toString().replace(/&/g,"%26")+"&MMplayerType="+r+"&MMdoctitle="+x.title;if(typeof t.flashvars!=k?t.flashvars+="&"+i:t.flashvars=i,G.ie&&G.win&&4!=s.readyState){var a=S("div");n+="SWFObjectNew",a.setAttribute("id",n),s.parentNode.insertBefore(a,s),s.style.display="none",function(){4==s.readyState?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}u(e,t,n)}}function l(e){if(G.ie&&G.win&&4!=e.readyState){var t=S("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(f(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(f(e),e)}function f(e){var t=S("div");if(G.win&&G.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(R)[0];if(n){var o=n.childNodes;if(o)for(var s=o.length,r=0;s>r;r++)1==o[r].nodeType&&"PARAM"==o[r].nodeName||8==o[r].nodeType||t.appendChild(o[r].cloneNode(!0))}}return t}function u(e,t,n){var o,s=w(n);if(G.wk&&G.wk<312)return o;if(s)if(typeof e.id==k&&(e.id=n),G.ie&&G.win){var r="";for(var i in e)e[i]!=Object.prototype[i]&&("data"==i.toLowerCase()?t.movie=e[i]:"styleclass"==i.toLowerCase()?r+=' class="'+e[i]+'"':"classid"!=i.toLowerCase()&&(r+=" "+i+'="'+e[i]+'"'));var a="";for(var c in t)t[c]!=Object.prototype[c]&&(a+='<param name="'+c+'" value="'+t[c]+'" />');s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+r+">"+a+"</object>",D[D.length]=e.id,o=w(e.id)}else{var l=S(R);l.setAttribute("type",W);for(var f in e)e[f]!=Object.prototype[f]&&("styleclass"==f.toLowerCase()?l.setAttribute("class",e[f]):"classid"!=f.toLowerCase()&&l.setAttribute(f,e[f]));for(var u in t)t[u]!=Object.prototype[u]&&"movie"!=u.toLowerCase()&&d(l,u,t[u]);s.parentNode.replaceChild(l,s),o=l}return o}function d(e,t,n){var o=S("param");o.setAttribute("name",t),o.setAttribute("value",n),e.appendChild(o)}function h(e){var t=w(e);t&&"OBJECT"==t.nodeName&&(G.ie&&G.win?(t.style.display="none",function(){4==t.readyState?p(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function p(e){var t=w(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function w(e){var t=null;try{t=x.getElementById(e)}catch(n){}return t}function S(e){return x.createElement(e)}function m(e,t,n){e.attachEvent(t,n),V[V.length]=[e,t,n]}function g(e){var t=G.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function _(e,t,n,o){if(!G.ie||!G.mac){var s=x.getElementsByTagName("head")[0];if(s){var r=n&&"string"==typeof n?n:"screen";if(o&&(T=null,j=null),!T||j!=r){var i=S("style");i.setAttribute("type","text/css"),i.setAttribute("media",r),T=s.appendChild(i),G.ie&&G.win&&typeof x.styleSheets!=k&&x.styleSheets.length>0&&(T=x.styleSheets[x.styleSheets.length-1]),j=r}G.ie&&G.win?T&&typeof T.addRule==R&&T.addRule(e,t):T&&typeof x.createTextNode!=k&&T.appendChild(x.createTextNode(e+" {"+t+"}"))}}}function b(e,t){if(X){var n=t?"visible":"hidden";H&&w(e)?w(e).style.visibility=n:_("#"+e,"visibility:"+n)}}function v(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=k?encodeURIComponent(e):e}var O,y,C,E,T,j,k="undefined",R="object",I="Shockwave Flash",N="ShockwaveFlash.ShockwaveFlash",W="application/x-shockwave-flash",A="SWFObjectExprInst",B="onreadystatechange",L=window,x=document,P=navigator,F=!1,U=[o],M=[],D=[],V=[],H=!1,J=!1,X=!0,G=function(){var e=typeof x.getElementById!=k&&typeof x.getElementsByTagName!=k&&typeof x.createElement!=k,t=P.userAgent.toLowerCase(),n=P.platform.toLowerCase(),o=n?/win/.test(n):/win/.test(t),s=n?/mac/.test(n):/mac/.test(t),r=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,i=!1,a=[0,0,0],c=null;if(typeof P.plugins!=k&&typeof P.plugins[I]==R)c=P.plugins[I].description,!c||typeof P.mimeTypes!=k&&P.mimeTypes[W]&&!P.mimeTypes[W].enabledPlugin||(F=!0,i=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),a[0]=parseInt(c.replace(/^(.*)\..*$/,"$1"),10),a[1]=parseInt(c.replace(/^.*\.(.*)\s.*$/,"$1"),10),a[2]=/[a-zA-Z]/.test(c)?parseInt(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof L.ActiveXObject!=k)try{var l=new ActiveXObject(N);l&&(c=l.GetVariable("$version"),c&&(i=!0,c=c.split(" ")[1].split(","),a=[parseInt(c[0],10),parseInt(c[1],10),parseInt(c[2],10)]))}catch(f){}return{w3:e,pv:a,wk:r,ie:i,win:o,mac:s}}();(function(){G.w3&&((typeof x.readyState!=k&&"complete"==x.readyState||typeof x.readyState==k&&(x.getElementsByTagName("body")[0]||x.body))&&e(),H||(typeof x.addEventListener!=k&&x.addEventListener("DOMContentLoaded",e,!1),G.ie&&G.win&&(x.attachEvent(B,function(){"complete"==x.readyState&&(x.detachEvent(B,arguments.callee),e())}),L==top&&!function(){if(!H){try{x.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),G.wk&&!function(){return H?void 0:/loaded|complete/.test(x.readyState)?void e():void setTimeout(arguments.callee,0)}(),n(e)))})(),function(){G.ie&&G.win&&window.attachEvent("onunload",function(){for(var e=V.length,t=0;e>t;t++)V[t][0].detachEvent(V[t][1],V[t][2]);for(var n=D.length,o=0;n>o;o++)h(D[o]);for(var s in G)G[s]=null;G=null;for(var r in swfobject)swfobject[r]=null;swfobject=null})}();return{registerObject:function(e,t,n,o){if(G.w3&&e&&t){var s={};s.id=e,s.swfVersion=t,s.expressInstall=n,s.callbackFn=o,M[M.length]=s,b(e,!1)}else o&&o({success:!1,id:e})},getObjectById:function(e){return G.w3?i(e):void 0},embedSWF:function(e,n,o,s,r,i,l,f,d,h){var p={success:!1,id:n};G.w3&&!(G.wk&&G.wk<312)&&e&&n&&o&&s&&r?(b(n,!1),t(function(){o+="",s+="";var t={};if(d&&typeof d===R)for(var w in d)t[w]=d[w];t.data=e,t.width=o,t.height=s;var S={};if(f&&typeof f===R)for(var m in f)S[m]=f[m];if(l&&typeof l===R)for(var _ in l)typeof S.flashvars!=k?S.flashvars+="&"+_+"="+l[_]:S.flashvars=_+"="+l[_];if(g(r)){var v=u(t,S,n);t.id==n&&b(n,!0),p.success=!0,p.ref=v}else{if(i&&a())return t.data=i,void c(t,S,n,h);b(n,!0)}h&&h(p)})):h&&h(p)},switchOffAutoHideShow:function(){X=!1},ua:G,getFlashPlayerVersion:function(){return{major:G.pv[0],minor:G.pv[1],release:G.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(e,t,n){return G.w3?u(e,t,n):void 0},showExpressInstall:function(e,t,n,o){G.w3&&a()&&c(e,t,n,o)},removeSWF:function(e){G.w3&&h(e)},createCSS:function(e,t,n,o){G.w3&&_(e,t,n,o)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=x.location.search||x.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return v(t);for(var n=t.split("&"),o=0;o<n.length;o++)if(n[o].substring(0,n[o].indexOf("="))==e)return v(n[o].substring(n[o].indexOf("=")+1))}return""},expressInstallCallback:function(){if(J){var e=w(A);e&&O&&(e.parentNode.replaceChild(O,e),y&&(b(y,!0),G.ie&&G.win&&(O.style.display="block")),C&&C(E)),J=!1}}}}();swfobject.hasFlashPlayerVersion("10.0.0")?(WEB_SOCKET_DEBUG=!0,function(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;n>t;t++){var o=e[t],s=o.src;if(s||(s=o.getAttribute("src")),s){var r=s.lastIndexOf("jWebSocket_Bundle_min.js");if(0>r&&(r=s.lastIndexOf("jWebSocket_Bundle.js")),0>r&&(r=s.lastIndexOf("jWebSocket.js")),r>0){buttType?window.WEB_SOCKET_SWF_LOCATION=s.substr(0,r)+"flash-bridge/WebSocketMainInsecure.swf?time="+(new Date).getTime():window.WEB_SOCKET_SWF_LOCATION=s.substr(0,r)+"flash-bridge/WebSocketMainInsecure.swf?time="+(new Date).getTime(),jws.JWS_FLASHBRIDGE=window.WEB_SOCKET_SWF_LOCATION;break}}}}(),window.WEB_SOCKET_SWF_LOCATION&&!function(){if(window.WEB_SOCKET_FORCE_FLASH);else{if(window.WebSocket)return;if(window.MozWebSocket)return void(window.WebSocket=MozWebSocket)}var e;return e=window.WEB_SOCKET_LOGGER?WEB_SOCKET_LOGGER:window.console&&window.console.log&&window.console.error?window.console:{log:function(){},error:function(){}},swfobject.getFlashPlayerVersion().major<10?void e.error("Flash Player >= 10.0.0 is required."):("file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),window.WebSocket=function(e,t,n,o,s){var r=this;r.__id=WebSocket.__nextId++,WebSocket.__instances[r.__id]=r,r.readyState=WebSocket.CONNECTING,r.bufferedAmount=0,r.__events={},t?"string"==typeof t&&(t=[t]):t=[],r.__createTask=setTimeout(function(){WebSocket.__addTask(function(){r.__createTask=null,WebSocket.__flash.create(r.__id,e,t,n||null,o||0,s||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){return this.__createTask?(clearTimeout(this.__createTask),this.__createTask=null,void(this.readyState=WebSocket.CLOSED)):void(this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id)))},WebSocket.prototype.addEventListener=function(e,t,n){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t,n){if(e in this.__events)for(var o=this.__events[e],s=o.length-1;s>=0;--s)if(o[s]===t){o.splice(s,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var o=this["on"+e.type];o&&o.apply(this,[e])},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close"),t.wasClean=e.wasClean?!0:!1,t.code=e.code,t.reason=e.reason;else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__isFlashImplementation=!0,WebSocket.__initialized=!1,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__initialized){if(WebSocket.__initialized=!0,WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return void e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");if(!window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&!WEB_SOCKET_SWF_LOCATION.match(/(^|\/)WebSocketMainInsecure\.swf(\?.*)?$/)&&WEB_SOCKET_SWF_LOCATION.match(/^\w+:\/\/([^\/]+)/)){var t=RegExp.$1;location.host!=t&&e.error("[WebSocket] You must host HTML and WebSocketMain.swf in the same host ('"+location.host+"' != '"+t+"'). See also 'How to host HTML file and SWF file in different domains' section in README.md. If you use WebSocketMainInsecure.swf, you can suppress this message by WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;")}var n=document.createElement("div");n.id="webSocketContainer",n.style.position="absolute",WebSocket.__isFlashLite()?(n.style.left="0px",n.style.top="0px"):(n.style.left="-100px",n.style.top="-100px");var o=document.createElement("div");o.id="webSocketFlash",n.appendChild(o),document.body.appendChild(n),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(o){e.error(o)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;
var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename&&e.enabledPlugin.filename.match(/flashlite/i)?!0:!1},void(window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||swfobject.addDomLoadEvent(function(){WebSocket.__initialize()})))}()):WebSocket=null}jws.XHR={ASYNC:!0,SYNC:!1,METHOD_GET:"get",METHOD_POST:"post",METHOD_HEAD:"head",getXHRInstance:function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)throw"f3.cfw.std.ex.xhr.NotAvail";try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw"f3.cfw.std.ex.xhr.NotAvail"}}}return e},isProtocolOk:function(e){return e||(e=self),!(e.location.protocol&&"file:"==e.location.protocol.toLowerCase())},mXHRSucClbk:function(e,t){throw"f3.cfw.std.ex.xhr.NoSuccObs"},mXHRErrClbk:function(e,t){throw"f3.cfw.std.ex.xhr.NoErrObs"},mXHRRespLsnr:function(){var e=arguments.callee.options;if(void 0!==f3.ajax.Request)switch(e.OnReadyStateChange&&e.OnReadyStateChange(e.XHR,e),e.XHR.readyState){case 0:case 1:case 2:case 3:break;case 4:clearTimeout(e.hTimeout),200==e.XHR.status?f3.dom.Event.callObserver(e.OnSuccess,e.XHR,e):f3.dom.Event.callObserver(e.OnError,e.XHR,e),e.XHR=null,e=null,arguments.callee.self=null,arguments.callee.options=null;break;default:e.OnError(e.XHR,e),e.XHR=null,e=null,arguments.callee.self=null,arguments.callee.options=null}},request:function(e,t){if(t=f3.core.OOP.getDefaultOptions(t,{method:"POST",asynchronous:f3.ajax.Common.ASYNC,postBody:null,timeout:-1,OnSuccess:f3.ajax.Request.mXHRSucClbk,OnError:f3.ajax.Request.mXHRErrClbk,contentType:"text/plain; charset=UTF-8",cacheControl:"must-revalidate"}),!f3.ajax.Common.isProtocolOk())throw new Error(0,f3.localeManager.getCurLocStr("f3.cfw.std.ex.xhr.file"));if(t.XHR=f3.ajax.Common.getXHRInstance(),t.XHR){t.XHR.open(t.method,e,t.asynchronous),"post"==t.method.toLowerCase()&&t.XHR.setRequestHeader("Content-type",t.contentType),t.cacheControl&&t.XHR.setRequestHeader("Cache-Control",t.cacheControl);var n=new $f3.$XHRResponse(t);!f3.browser.Browser.isFirefox()||t.asynchronous?t.XHR.onreadystatechange=n.mXHRRespLsnr:t.XHR.onreadystatechange=null,t.timeout>0&&(t.hTimeout=setTimeout(function(){t.XHR.abort(),f3.browser.Browser.isFirefox()&&!t.asynchronous&&n.handler(t)},t.timeout));try{t.XHR.send(t.postBody)}catch(o){t.OnError(t.XHR,t)}f3.browser.Browser.isFirefox()&&!t.asynchronous&&n.mXHRRespLsnr(t)}return t.XHR}},jws.browserSupportsNativeJSON||(this.JSON||(this.JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,s,r,i,a=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(c)){for(r=c.length,n=0;r>n;n+=1)i[n]=str(n,c)||"null";return s=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+a+"]":"["+i.join(",")+"]",gap=a,s}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)o=rep[n],"string"==typeof o&&(s=str(o,c),s&&i.push(quote(o)+(gap?": ":":")+s));else for(o in c)Object.hasOwnProperty.call(c,o)&&(s=str(o,c),s&&i.push(quote(o)+(gap?": ":":")+s));return s=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+a+"}":"{"+i.join(",")+"}",gap=a,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;n>o;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,o,s=e[t];if(s&&"object"==typeof s)for(n in s)Object.hasOwnProperty.call(s,n)&&(o=walk(s,n),void 0!==o?s[n]=o:delete s[n]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}());var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,o,s,r,i,a,c="",l=0;for(e=Base64._utf8_encode(e);l<e.length;)t=e.charCodeAt(l++),n=e.charCodeAt(l++),o=e.charCodeAt(l++),s=t>>2,r=(3&t)<<4|n>>4,i=(15&n)<<2|o>>6,a=63&o,isNaN(n)?i=a=64:isNaN(o)&&(a=64),c=c+this._keyStr.charAt(s)+this._keyStr.charAt(r)+this._keyStr.charAt(i)+this._keyStr.charAt(a);return c},decode:function(e){var t,n,o,s,r,i,a,c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)s=this._keyStr.indexOf(e.charAt(l++)),r=this._keyStr.indexOf(e.charAt(l++)),i=this._keyStr.indexOf(e.charAt(l++)),a=this._keyStr.indexOf(e.charAt(l++)),t=s<<2|r>>4,n=(15&r)<<4|i>>2,o=(3&i)<<6|a,c+=String.fromCharCode(t),64!=i&&(c+=String.fromCharCode(n)),64!=a&&(c+=String.fromCharCode(o));return c=Base64._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);128>o?t+=String.fromCharCode(o):o>127&&2048>o?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},_utf8_decode:function(e){for(var t="",n=0,o=c1=c2=0;n<e.length;)o=e.charCodeAt(n),128>o?(t+=String.fromCharCode(o),n++):o>191&&224>o?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&c2),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&c2)<<6|63&c3),n+=3);return t}};jws.oop={},jws.oop.declareClass=function(e,t,n,o){var s=window,r=s[e];r||(s[e]={},r=s[e]);var i=function(){this.create&&this.create.apply(this,arguments)};r[t]=i;var a;for(a in o)i.prototype[a]=o[a];if(null!=n){n.descendants||(n.descendants=[]),n.descendants.push(i);for(a in n.prototype){var c=n.prototype[a];"function"==typeof c&&(i.prototype[a]?i.prototype[a].inherited=c:i.prototype[a]=c,i.prototype[a].superClass=n)}}},jws.oop.addPlugIn=function(e,t){e.fPlugIns||(e.fPlugIns=[]),e.fPlugIns.push(t);for(var n in t)e.prototype[n]||(e.prototype[n]=t[n]);if(e.descendants)for(var o=0,s=e.descendants.length;s>o;o++)jws.oop.addPlugIn(e.descendants[o],t)},jws.oop.declareClass("jws","jWebSocketBaseClient",null,{create:function(e){this.fReliabilityOptions||(this.fReliabilityOptions=jws.RO_OFF)},processOpened:function(e){},processPacket:function(e){},processClosed:function(e){},open:function(e,t){if(t||(t={}),!self.WebSocket)throw new Error("WebSockets not supported by browser");if(this.fConn)throw new Error("Already connected");var n=this,o=null,s=jws.WS_SUBPROT_JSON;t.subProtocol&&(s=t.subProtocol),t.reliabilityOptions&&(this.fReliabilityOptions=t.reliabilityOptions),this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!1),this.fStatus!=jws.RECONNECTING&&(this.fStatus=jws.CONNECTING),t.OnOpenTimeout&&"function"==typeof t.OnOpenTimeout&&t.openTimeout&&(this.fOpenTimeout=t.openTimeout,this.hOpenTimeout=setTimeout(function(){n.fOpenTimeout=null;var e={};t.OnOpenTimeout(e)},this.fOpenTimeout)),this.fConn=new WebSocket(e,s),this.fURL=e,this.fSubProt=s,this.fConn.onopen=function(e){jws.console.isDebugEnabled()&&jws.console.debug("[onopen]: "+JSON.stringify(e)),n.hOpenTimeout&&(clearTimeout(n.hOpenTimeout),n.hOpenTimeout=null),n.fStatus=jws.OPEN,o=n.processOpened(e),t.OnOpen&&t.OnOpen(e,o,n),n.processQueue()},this.fConn.onmessage=function(e){jws.console.isDebugEnabled()&&jws.console.debug("[onmessage]: "+JSON.stringify(e)),t.OnMessage&&t.OnMessage(e,o,n),o=n.processPacket(e)},this.fConn.onclose=function(e){jws.console.isDebugEnabled()&&jws.console.debug("[onclose]: "+JSON.stringify(e)),n.hOpenTimeout&&(clearTimeout(n.hOpenTimeout),n.hOpenTimeout=null),n.fStatus=jws.CLOSED,n.hDisconnectTimeout&&(clearTimeout(n.hDisconnectTimeout),delete n.hDisconnectTimeout),o=n.processClosed(e),t.OnClose&&t.OnClose(e,o,n),n.fConn=null,n.fReliabilityOptions&&n.fReliabilityOptions.autoReconnect&&!n.fReliabilityOptions.isExplicitClose&&(n.fStatus=jws.RECONNECTING,n.hReconnectDelayTimeout=setTimeout(function(){t.OnReconnecting&&t.OnReconnecting(e,o,n),n.open(n.fURL,t)},n.fReliabilityOptions.reconnectDelay))}},connect:function(e,t){return this.open(e,t)},processQueue:function(){if(this.fOutQueue){var e=this.checkConnected();if(0==e.code)for(var t;this.fOutQueue.length>0;)t=this.fOutQueue.shift(),this.fConn.send(t.packet)}},queuePacket:function(e,t){this.fOutQueue||(this.fOutQueue=[]),this.fOutQueue.push({packet:e,options:t})},sendStream:function(e){if(this.isOpened())try{this.fConn.send(e)}catch(t){jws.console.error("[sendStream]: Exception on send: "+t.message)}else{if(!this.isWriteable())throw new Error("Not connected");this.queuePacket(e,null)}},abortReconnect:function(){return this.hReconnectDelayTimeout?(clearTimeout(this.hReconnectDelayTimeout),this.hReconnectDelayTimeout=null,!0):!1},setAutoReconnect:function(e){e&&"boolean"==typeof aLimit?this.fReliabilityOptions.autoReconnect=e:this.fReliabilityOptions.autoReconnect=!1,this.fReliabilityOptions&&this.fReliabilityOptions.autoReconnect||abortReconnect()},setQueueItemLimit:function(e){e&&"number"==typeof e&&e>0?this.fReliabilityOptions.queueItemLimit=parseInt(e):this.fReliabilityOptions.queueItemLimit=0},setQueueSizeLimit:function(e){e&&"number"==typeof e&&e>0?this.fReliabilityOptions.queueSizeLimit=parseInt(e):this.fReliabilityOptions.queueSizeLimit=0},setReliabilityOptions:function(e){this.fReliabilityOptions=e,this.fReliabilityOptions&&(this.fReliabilityOptions.autoReconnect||abortReconnect())},getReliabilityOptions:function(){return this.fReliabilityOptions},getOutQueue:function(){return this.fOutQueue},resetSendQueue:function(){delete this.fOutQueue},isOpened:function(){return void 0!=this.fConn&&null!=this.fConn&&this.fConn.readyState==jws.OPEN},getURL:function(){return this.fURL},getSubProt:function(){return this.fSubProt},isConnected:function(){return this.isOpened()},forceClose:function(e){if(this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!0),e&&e.fireClose&&this.fConn.onclose){var t={};this.fConn.onclose(t)}this.fConn&&(this.fConn.onopen=null,this.fConn.onmessage=null,this.fConn.onclose=null,(this.fConn.readyState==jws.OPEN||this.fConn.readyState==jws.CONNECTING)&&this.fConn.close(),this.processClosed()),this.fConn=null},close:function(e){var t=0;if(e&&e.timeout&&(t=e.timeout),!this.fConn)throw this.fConn=null,new Error("Not connected");if(0>=t)this.forceClose(e);else{var n=this;this.hDisconnectTimeout=setTimeout(function(){n.forceClose(e)},t)}},disconnect:function(e){return this.close(e)},addListener:function(e){this.fListeners||(this.fListeners=[]),this.fListeners.push(e)},removeListener:function(e){if(this.fListeners)for(var t=0,n=this.fListeners;n>t;t++)e==this.fListeners[t]&&this.fListeners.splice(t,1)},addPlugIn:function(e,t){this.fPlugIns||(this.fPlugIns=[]),this.fPlugIns.push(e),t||(t=e.ID),t&&(e.conn=this)},setParam:function(e,t){this.fParams||(this.fParams={});var n=this.getParam(e);return this.fParams[e]=t,n},getParam:function(e){if(!this.fParams)return null;var t=this.fParams[e];return void 0===t?null:t},setParamNS:function(e,t,n){return this.setParam(e+"."+t,n)},getParamNS:function(e,t){return this.getParam(e+"."+t)},clearParams:function(){this.fParams&&delete this.fParams}}),jws.oop.declareClass("jws","jWebSocketTokenClient",jws.jWebSocketBaseClient,{create:function(e){arguments.callee.inherited.call(this,e),this.fRequestCallbacks={}},getId:function(){return this.fClientId},checkCallbacks:function(e){var t="utid"+e.utid,n=this.fRequestCallbacks[t];if(n){n.hCleanUp&&clearTimeout(n.hCleanUp);var o=n.args,s=n.callback;s.OnResponse&&s.OnResponse.call(this,e,o),s.OnSuccess&&0===e.code&&s.OnSuccess.call(this,e,o),s.OnFailure&&void 0!=e.code&&0!=e.code&&s.OnFailure.call(this,e,o),delete this.fRequestCallbacks[t]}},createDefaultResult:function(){return{code:0,msg:"Ok",localeKey:"jws.jsc.res.Ok",args:null,tid:jws.CUR_TOKEN_ID}},checkConnected:function(){var e=this.createDefaultResult();return this.isOpened()||(e.code=-1,e.localeKey="jws.jsc.res.notConnected",e.msg="Not connected."),e},isWriteable:function(){return this.isOpened()||this.fStatus==jws.RECONNECTING},checkWriteable:function(){var e=this.createDefaultResult();return this.isWriteable()||(e.code=-1,e.localeKey="jws.jsc.res.notWriteable",e.msg="Not writable."),e},checkLoggedIn:function(){var e=this.checkConnected();return 0!=e.code||this.isLoggedIn()||(e.code=-1,e.localeKey="jws.jsc.res.notLoggedIn",e.msg="Not logged in."),e},resultToString:function(e){return e&&"object"==typeof e&&e.msg?e.msg:"invalid response token"},tokenToStream:function(e){throw new Error("tokenToStream needs to be overwritten in descendant classes")},streamToToken:function(e){throw new Error("streamToToken needs to be overwritten in descendant classes")},notifyPlugInsOpened:function(){var e={sourceId:this.fClientId},t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;o>n;n++){var s=t[n];s.processOpened&&s.processOpened.call(this,e)}},notifyPlugInsClosed:function(){var e={sourceId:this.fClientId},t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;o>n;n++){var s=t[n];s.processClosed&&s.processClosed.call(this,e)}this.fConn=null,this.fSessionId=null,this.fUsername=null},processPacket:function(e){var t=this.streamToToken(e.data);return this.processToken(t),t},processToken:function(e){var t=e.ns;if(null!=t&&1==t.indexOf("org.jWebSocket")?e.ns="org.jwebsocket"+t.substring(15):null==t&&(e.ns="org.jwebsocket.plugins.system"),jws.NS_SYSTEM==e.ns)if("welcome"==e.type&&e.usid){this.fSessionId=e.usid,this.fClientId=e.sourceId,this.notifyPlugInsOpened(),this.fOnWelcome&&this.fOnWelcome(e);var n="n/a";if(swfobject){var o=swfobject.getFlashPlayerVersion();n=o.major+"."+o.minor+"."+o.release}this.sendToken({ns:jws.SystemClientPlugIn.NS,type:"header",clientType:"browser",clientName:jws.getBrowserName(),clientVersion:jws.getBrowserVersionString(),clientInfo:navigator.userAgent,jwsType:"javascript",jwsVersion:jws.VERSION,jwsInfo:jws.browserSupportsNativeWebSockets?"native":"flash "+n},{})}else"goodBye"==e.type?(this.fOnGoodBye&&this.fOnGoodBye(e),this.fSessionId=null,this.fUsername=null):"close"==e.type?this.close({timeout:0}):"response"==e.type?("login"==e.reqType&&(this.fUsername=e.username,e.usid&&(this.fSessionId=e.usid)),"logout"==e.reqType&&(this.fUsername=null),this.checkCallbacks(e)):"event"==e.type&&("connect"==e.name&&this.processConnected(e),"disconnect"==e.name&&this.processDisconnected(e));else this.checkCallbacks(e);var s,r,i,a;if(i=jws.jWebSocketTokenClient.fPlugIns)for(s=0,r=i.length;r>s;s++)a=i[s],a.processToken&&a.processToken.call(this,e);if(i=this.fPlugIns)for(s=0,r=i.length;r>s;s++)a=i[s],a.processToken&&a.processToken(e);if(this.fOnToken&&this.fOnToken(e),this.fListeners)for(s=0,r=this.fListeners.length;r>s;s++)this.fListeners[s](e)},processClosed:function(e){this.notifyPlugInsClosed(),this.fClientId=null},processConnected:function(e){var t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;o>n;n++){var s=t[n];s.processConnected&&s.processConnected.call(this,e)}},processDisconnected:function(e){var t=jws.jWebSocketTokenClient.fPlugIns;if(t)for(var n=0,o=t.length;o>n;n++){var s=t[n];s.processDisconnected&&s.processDisconnected.call(this,e)}},sendToken:function(e,t){var n=this.checkWriteable();if(0==n.code){var o=!1,s=0,r=jws.DEF_RESP_TIMEOUT,i=!1,a=null,c={OnResponse:null,OnSuccess:null,OnFailure:null,OnTimeout:null},l=!1;if(t&&(t.OnResponse&&(c.OnResponse=t.OnResponse,l=!0),t.OnFailure&&(c.OnFailure=t.OnFailure,l=!0),t.OnSuccess&&(c.OnSuccess=t.OnSuccess,l=!0),t.OnTimeout&&(c.OnTimeout=t.OnTimeout,l=!0),t.args&&(a=t.args),t.timeout&&(r=t.timeout),t.spawnThread&&(o=t.spawnThread),t.fragmentSize&&(s=t.fragmentSize),t.keepRequest&&(i=!0)),jws.CUR_TOKEN_ID++,l){var f=jws.CUR_TOKEN_ID,u="utid"+f,d=this,h={request:(new Date).getTime(),callback:c,args:a,timeout:r};i&&(h.request=e),this.fRequestCallbacks[u]=h,h.hCleanUp=setTimeout(function(){var t=h.callback;delete d.fRequestCallbacks[u],t.OnTimeout&&t.OnTimeout.call(this,e,{utid:f,timeout:r})},r)}o&&(e.spawnThread=!0);var p=this.tokenToStream(e);if(s>0&&p.length>0)for(var w,S,m=0,g=0,_=p.length;p.length>0;)w={ns:jws.NS_SYSTEM,type:"fragment",utid:e.utid,index:m++,total:parseInt(_/s)+1,data:p.substr(0,s)},g+=s,p=p.substr(s),S=this.tokenToStream(w),this.sendStream(S);else jws.console.isDebugEnabled()&&jws.console.debug("[sendToken]: Sending stream "+p+"..."),this.sendStream(p)}return n},getLastTokenId:function(){return jws.CUR_TOKEN_ID},getNextTokenId:function(){return jws.CUR_TOKEN_ID+1},sendText:function(e,t){var n=this.checkLoggedIn();return 0==n.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"send",targetId:e,sourceId:this.fClientId,sender:this.fUsername,data:t}),n},broadcastText:function(e,t,n){var o=this.checkLoggedIn(),s=!1,r=!0;return n&&(n.senderIncluded&&(s=n.senderIncluded),n.responseRequested&&(r=n.responseRequested)),0==o.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"broadcast",sourceId:this.fClientId,sender:this.fUsername,pool:e,data:t,senderIncluded:s,responseRequested:r},n),o},echo:function(e){var t=this.checkWriteable();return 0==t.code&&this.sendToken({ns:jws.NS_SYSTEM,type:"echo",data:e}),t},open:function(e,t){var n=this.createDefaultResult();try{t&&t.OnToken&&"function"==typeof t.OnToken&&(this.fOnToken=t.OnToken),t&&t.OnWelcome&&"function"==typeof t.OnWelcome&&(this.fOnWelcome=t.OnWelcome),t&&t.OnGoodBye&&"function"==typeof t.OnGoodBye&&(this.fOnGoodBye=t.OnGoodBye),arguments.callee.inherited.call(this,e,t)}catch(o){n.code=-1,n.localeKey="jws.jsc.ex",n.args=[o.message],n.msg="Exception on open: "+o.message}return n},connect:function(e,t){return this.open(e,t)},close:function(e){var t=0,n=!1,o=!1,s=!1;this.fReliabilityOptions&&(this.fReliabilityOptions.isExplicitClose=!0),e&&(e.timeout&&(t=e.timeout),e.noGoodBye&&(n=!0),e.noLogoutBroadcast&&(o=!0),e.noDisconnectBroadcast&&(s=!0));var r=this.checkConnected();try{if(0==r.code){if(t>0){var i={ns:jws.NS_SYSTEM,type:"close",timeout:t};n&&(i.noGoodBye=!0),o&&(i.noLogoutBroadcast=!0),s&&(i.noDisconnectBroadcast=!0),this.sendToken(i)}arguments.callee.inherited.call(this,e)}else r.code=-1,r.localeKey="jws.jsc.res.notConnected",r.msg="Not connected."}catch(a){r.code=-1,r.localeKey="jws.jsc.ex",r.args=[a.message],r.msg="Exception on close: "+a.message}return r},disconnect:function(e){return this.close(e)}}),jws.oop.declareClass("jws","jWebSocketJSONClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){e.utid=jws.CUR_TOKEN_ID;var t=JSON.stringify(e);return t},streamToToken:function(e){var t=JSON.parse(e);return t}}),jws.oop.declareClass("jws","jWebSocketCSVClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){var t="utid="+jws.CUR_TOKEN_ID;for(var n in e){var o=e[n];null===o||void 0===o?t+=","+n+"=":"string"==typeof o?(o=o.replace(/[,]/g,"\\x2C"),o=o.replace(/["]/g,"\\x22"),t+=","+n+'="'+o+'"'):t+=","+n+"="+o}return t},streamToToken:function(e){for(var t={},n=e.split(","),o=0,s=n.length;s>o;o++){var r=n[o].split("=");if(2==r.length){var i=r[0],a=r[1];a.length>=2&&'"'==a.charAt(0)&&'"'==a.charAt(a.length-1)&&(a=a.replace(/\\x2C/g,","),a=a.replace(/\\x22/g,'"'),a=a.substr(1,a.length-2)),t[i]=a}}return t}}),jws.oop.declareClass("jws","jWebSocketXMLClient",jws.jWebSocketTokenClient,{tokenToStream:function(e){function t(e,n){var o="";if(n instanceof Array){o+="<"+e+' type="array">';for(var s=0,r=n.length;r>s;s++)o+=t("item",n[s]);o+="</"+e+">"}else if("object"==typeof n){o+="<"+e+' type="object">';for(var i in n)o+=t(i,n[i]);o+="</"+e+">"}else o+="<"+e+' type="'+typeof n+'">'+n.toString()+"</"+e+">";return o}var n="windows-1252",o='<?xml version="1.0" encoding="'+n+'"?><token>';for(var s in e)o+=t(s,e[s]);return o+="</token>"},streamToToken:function(e){function t(e,n){for(var o=e.firstChild;null!=o;){if(1==o.nodeType){var s=o.getAttribute("type"),r=o.nodeName;if(s){var i=o.firstChild;i&&3==i.nodeType?(i=i.nodeValue,i&&("string"==s||"number"==s||"boolean"==s||"date"==s||(i=void 0),i&&(n instanceof Array?n.push(i):n[r]=i))):i&&1==i.nodeType&&("array"==s?(n[r]=[],t(o,n[r])):"object"==s&&(n[r]={},t(o,n[r])))}}o=o.nextSibling}}var n=null;try{var o=new DOMParser;n=o.parseFromString(e,"text/xml")}catch(s){}var r={};return n&&t(n.firstChild,r),r}}),window.jws=jws,window.setServerUrl=setServerUrl});