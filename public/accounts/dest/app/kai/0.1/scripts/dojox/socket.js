define("dojox/socket",["dojo/_base/array","dojo/_base/lang","dojo/_base/xhr","dojo/aspect","dojo/on","dojo/Evented","dojo/_base/url"],function(e,t,n,o,r,a,s){var c=window.WebSocket,i=function(e){return"string"==typeof e&&(e={url:e}),c?i.WebSocket(e,!0):i.LongPoll(e)};return i.WebSocket=function(e,t){var n=document.baseURI||window.location.href,r=new c(new s(n.replace(/^http/i,"ws"),e.url));r.on=function(e,t){r.addEventListener(e,t,!0)};var a;return o.after(r,"onopen",function(e){a=!0},!0),o.after(r,"onclose",function(n){a||t&&i.replace(r,i.LongPoll(e),!0)},!0),r},i.replace=function(n,o,a){n.send=t.hitch(o,"send"),n.close=t.hitch(o,"close");var s=function(e){(o.addEventListener||o.on).call(o,e,function(e){r.emit(n,e.type,e)},!0)};a&&s("open"),e.forEach(["message","close","error"],s)},i.LongPoll=function(o){var s,c,i,l=!1,d=!0,u=[],f={send:function(n){var r=t.delegate(o);r.rawBody=n,clearTimeout(s);var a=d?(d=!1)||f.firstRequest(r):f.transport(r);return u.push(a),a.then(function(t){f.readyState=1,u.splice(e.indexOf(u,a),1),u.length||(s=setTimeout(i,o.interval)),t&&c("message",{data:t},a)},function(t){u.splice(e.indexOf(u,a),1),l||(c("error",{error:t},a),u.length||(f.readyState=3,c("close",{wasClean:!1},a)))}),a},close:function(){f.readyState=2,l=!0;var e;for(e=0;e<u.length;e++)u[e].cancel();f.readyState=3,c("close",{wasClean:!0})},transport:o.transport||n.post,args:o,url:o.url,readyState:0,CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,on:a.prototype.on,firstRequest:function(e){var t=e.headers||(e.headers={});t.Pragma="start-long-poll";try{return this.transport(e)}finally{delete t.Pragma}}};return c=function(e,t,n){f["on"+e]&&(t.ioArgs=n&&n.ioArgs,t.type=e,r.emit(f,e,t))},i=function(){0==f.readyState&&c("open",{}),u.length||f.send()},f.connect=f.on,setTimeout(i),f},i});