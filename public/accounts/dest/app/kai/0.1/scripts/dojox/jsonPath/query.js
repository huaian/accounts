define("dojox/jsonPath/query",["dojo","dijit","dojox"],function(dojo,dijit,dojox){dojo.provide("dojox.jsonPath.query"),dojox.jsonPath.query=function(obj,expr,arg){function _str(e){return strs[e]}var re=dojox.jsonPath._regularExpressions;arg||(arg={});var strs=[],_strName=_str.name,acc;if("PATH"==arg.resultType&&"RESULT"==arg.evalType)throw Error("RESULT based evaluation not supported with PATH based results");var P={resultType:arg.resultType||"VALUE",normalize:function(expr){var subx=[];expr=expr.replace(/'([^']|'')*'/g,function(t){return _strName+"("+(strs.push(eval(t))-1)+")"});for(var ll=-1;ll!=subx.length;)ll=subx.length,expr=expr.replace(/(\??\([^\(\)]*\))/g,function(e){return"#"+(subx.push(e)-1)});for(expr=expr.replace(/[\['](#[0-9]+)[\]']/g,"[$1]").replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,""),ll=-1;ll!=expr;)ll=expr,expr=expr.replace(/#([0-9]+)/g,function(e,r){return subx[r]});return expr.split(";")},asPaths:function(e){for(var r=0;r<e.length;r++){for(var t="$",n=e[r],a=1,o=n.length;o>a;a++)t+=/^[0-9*]+$/.test(n[a])?"["+n[a]+"]":"['"+n[a]+"']";e[r]=t}return e},exec:function(e,r,t){function n(e,r,t){e&&e.hasOwnProperty(r)&&"VALUE"!=P.resultType&&p.push(u.concat([r])),t?i=e[r]:e&&e.hasOwnProperty(r)&&i.push(e[r])}function a(e){i.push(e),p.push(u),P.walk(e,function(r){if("object"==typeof e[r]){var t=u;u=u.concat(r),a(e[r]),u=t}})}function o(e,r){if(r instanceof Array){var t=r.length,a=0,o=t,s=1;e.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function(e,r,t,n){a=parseInt(r||a),o=parseInt(t||o),s=parseInt(n||s)}),a=0>a?Math.max(0,a+t):Math.min(t,a),o=0>o?Math.max(0,o+t):Math.min(t,o);for(var l=a;o>l;l+=s)n(r,l)}}function s(e){var r=c.match(/^_str\(([0-9]+)\)$/);return r?strs[r[1]]:e}function l(e){if(/^\(.*?\)$/.test(c))n(e,P.eval(c,e),t);else if("*"===c)P.walk(e,t&&e instanceof Array?function(r){P.walk(e[r],function(t){n(e[r],t)})}:function(r){n(e,r)});else if(".."===c)a(e);else if(/,/.test(c))for(var r=c.split(/'?,'?/),l=0,u=r.length;u>l;l++)n(e,s(r[l]));else/^\?\(.*?\)$/.test(c)?P.walk(e,function(r){P.eval(c.replace(/^\?\((.*?)\)$/,"$1"),e[r])&&n(e,r)}):/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(c)?o(c,e):(c=s(c),t&&e instanceof Array&&!/^[0-9*]+$/.test(c)?P.walk(e,function(r){n(e[r],c)}):n(e,c,t))}for(var u=["$"],i=t?r:[r],p=[u];e.length;){var c=e.shift();if(null===(r=i)||void 0===r)return r;i=[];var f=p;p=[],t?l(r):P.walk(r,function(e){u=f[e]||u,l(r[e])})}if("BOTH"==P.resultType){p=P.asPaths(p);for(var h=[],x=0;x<p.length;x++)h.push({path:p[x],value:i[x]});return h}return"PATH"==P.resultType?P.asPaths(p):i},walk:function(e,r){if(e instanceof Array)for(var t=0,n=e.length;n>t;t++)t in e&&r(t);else if("object"==typeof e)for(var a in e)e.hasOwnProperty(a)&&r(a)},eval:function(x,v){try{return $&&v&&eval(x.replace(/@/g,"v"))}catch(e){throw new SyntaxError("jsonPath: "+e.message+": "+x.replace(/@/g,"v").replace(/\^/g,"_a"))}}},$=obj;return expr&&obj?P.exec(P.normalize(expr).slice(1),obj,"RESULT"==arg.evalType):!1}});