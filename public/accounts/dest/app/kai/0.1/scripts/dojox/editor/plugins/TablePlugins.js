require({cache:{"url:dojox/editor/plugins/resources/insertTable.html":'<div class="dijitDialog" tabindex="-1" role="dialog" aria-labelledby="${id}_title">\n	<div dojoAttachPoint="titleBar" class="dijitDialogTitleBar">\n	<span dojoAttachPoint="titleNode" class="dijitDialogTitle" id="${id}_title">${insertTableTitle}</span>\n	<span dojoAttachPoint="closeButtonNode" class="dijitDialogCloseIcon" dojoAttachEvent="onclick: onCancel" title="${buttonCancel}">\n		<span dojoAttachPoint="closeText" class="closeText" title="${buttonCancel}">x</span>\n	</span>\n	</div>\n    <div dojoAttachPoint="containerNode" class="dijitDialogPaneContent">\n        <table class="etdTable"><tr>\n            <td>\n                <label>${rows}</label>\n			</td><td>\n                <span dojoAttachPoint="selectRow" dojoType="dijit.form.TextBox" value="2"></span>\n            </td><td><table><tr><td class="inner">\n                <label>${columns}</label>\n			</td><td class="inner">\n                <span dojoAttachPoint="selectCol" dojoType="dijit.form.TextBox" value="2"></span>\n            </td></tr></table></td></tr>		\n			<tr><td>\n                <label>${tableWidth}</label>\n            </td><td>\n                <span dojoAttachPoint="selectWidth" dojoType="dijit.form.TextBox" value="100"></span>\n			</td><td>\n                <select dojoAttachPoint="selectWidthType" hasDownArrow="true" dojoType="dijit.form.FilteringSelect">\n                  <option value="percent">${percent}</option>\n                  <option value="pixels">${pixels}</option>\n                </select></td></tr>	\n            <tr><td>\n                <label>${borderThickness}</label>\n            </td><td>\n                <span dojoAttachPoint="selectBorder" dojoType="dijit.form.TextBox" value="1"></span>\n            </td><td>\n                ${pixels}\n            </td></tr><tr><td>\n                <label>${cellPadding}</label>\n            </td><td>\n                <span dojoAttachPoint="selectPad" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellpad"></td></tr><tr><td>\n                <label>${cellSpacing}</label>\n            </td><td>\n                <span dojoAttachPoint="selectSpace" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellspace"></td></tr></table>\n        <div class="dialogButtonContainer">\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onInsert">${buttonInsert}</div>\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onCancel">${buttonCancel}</div>\n        </div>\n	</div>\n</div>\n',"url:dojox/editor/plugins/resources/modifyTable.html":'<div class="dijitDialog" tabindex="-1" role="dialog" aria-labelledby="${id}_title">\n	<div dojoAttachPoint="titleBar" class="dijitDialogTitleBar">\n	<span dojoAttachPoint="titleNode" class="dijitDialogTitle" id="${id}_title">${modifyTableTitle}</span>\n	<span dojoAttachPoint="closeButtonNode" class="dijitDialogCloseIcon" dojoAttachEvent="onclick: onCancel" title="${buttonCancel}">\n		<span dojoAttachPoint="closeText" class="closeText" title="${buttonCancel}">x</span>\n	</span>\n	</div>\n    <div dojoAttachPoint="containerNode" class="dijitDialogPaneContent">\n        <table class="etdTable">\n          <tr><td>\n                <label>${backgroundColor}</label>\n            </td><td colspan="2">\n                <span class="colorSwatchBtn" dojoAttachPoint="backgroundCol"></span>\n            </td></tr><tr><td>\n                <label>${borderColor}</label>\n            </td><td colspan="2">\n                <span class="colorSwatchBtn" dojoAttachPoint="borderCol"></span>\n            </td></tr><tr><td>\n                <label>${align}</label>\n            </td><td colspan="2">	\n                <select dojoAttachPoint="selectAlign" dojoType="dijit.form.FilteringSelect">\n                  <option value="default">${default}</option>\n                  <option value="left">${left}</option>\n                  <option value="center">${center}</option>\n                  <option value="right">${right}</option>\n                </select>\n            </td></tr>\n            <tr><td>\n                <label>${tableWidth}</label>\n            </td><td>\n                <span dojoAttachPoint="selectWidth" dojoType="dijit.form.TextBox" value="100"></span>\n            </td><td>\n                <select dojoAttachPoint="selectWidthType" hasDownArrow="true" dojoType="dijit.form.FilteringSelect">\n                  <option value="percent">${percent}</option>\n                  <option value="pixels">${pixels}</option>\n                </select></td></tr>	\n            <tr><td>\n                <label>${borderThickness}</label>\n            </td><td>\n                <span dojoAttachPoint="selectBorder" dojoType="dijit.form.TextBox" value="1"></span>\n            </td><td>\n                ${pixels}\n            </td></tr><tr><td>\n                <label>${cellPadding}</label>\n            </td><td>\n                <span dojoAttachPoint="selectPad" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellpad"></td></tr><tr><td>\n                <label>${cellSpacing}</label>\n            </td><td>\n                <span dojoAttachPoint="selectSpace" dojoType="dijit.form.TextBox" value="0"></span>\n            </td><td class="cellspace"></td></tr>\n        </table>\n        <div class="dialogButtonContainer">\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onSet">${buttonSet}</div>\n            <div dojoType="dijit.form.Button" dojoAttachEvent="onClick: onCancel">${buttonCancel}</div>\n        </div>\n	</div>\n</div>\n'}}),define("dojox/editor/plugins/TablePlugins",["dojo/_base/declare","dojo/_base/array","dojo/_base/Color","dojo/aspect","dojo/dom-attr","dojo/dom-style","dijit/_editor/_Plugin","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Dialog","dijit/Menu","dijit/MenuItem","dijit/MenuSeparator","dijit/ColorPalette","dojox/widget/ColorPicker","dojo/text!./resources/insertTable.html","dojo/text!./resources/modifyTable.html","dojo/i18n!./nls/TableDialog","dijit/_base/popup","dijit/popup","dojo/_base/connect","dijit/TooltipDialog","dijit/form/Button","dijit/form/DropDownButton","dijit/form/TextBox","dijit/form/FilteringSelect"],function(t,e,i,o,n,l,s,a,d,r,c,h,u,b,p,f,g,m,j){function v(t){return new C(t)}dojo.experimental("dojox.editor.plugins.TablePlugins");var T=t(s,{tablesConnected:!1,currentlyAvailable:!1,alwaysAvailable:!1,availableCurrentlySet:!1,initialized:!1,tableData:null,shiftKeyDown:!1,editorDomNode:null,undoEnabled:!0,refCount:0,doMixins:function(){dojo.mixin(this.editor,{getAncestorElement:function(t){return this._sCall("getAncestorElement",[t])},hasAncestorElement:function(t){return this._sCall("hasAncestorElement",[t])},selectElement:function(t){this._sCall("selectElement",[t])},byId:function(t){return dojo.byId(t,this.document)},query:function(t,e,i){var o=dojo.query(t,e||this.document);return i?o[0]:o}})},initialize:function(t){this.refCount++,t.customUndo=!0,this.initialized||(this.initialized=!0,this.editor=t,this.editor._tablePluginHandler=this,t.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.editorDomNode=this.editor.editNode||this.editor.iframe.document.body.firstChild,this._myListeners=[dojo.connect(this.editorDomNode,"mouseup",this.editor,"onClick"),dojo.connect(this.editor,"onDisplayChanged",this,"checkAvailable"),dojo.connect(this.editor,"onBlur",this,"checkAvailable"),dojo.connect(this.editor,"_saveSelection",this,function(){this._savedTableInfo=this.getTableInfo()}),dojo.connect(this.editor,"_restoreSelection",this,function(){delete this._savedTableInfo})],this.doMixins(),this.connectDraggable()})))},getTableInfo:function(t){if(this._savedTableInfo)return this._savedTableInfo;if(t&&this._tempStoreTableData(!1),this.tableData)return this.tableData;var e,i,o,n,l,s,a,d,r;return o=this.editor.getAncestorElement("td"),o&&(e=o.parentNode),l=this.editor.getAncestorElement("table"),l?(n=dojo.query("td",l),n.forEach(function(t,e){o==t&&(a=e)}),i=dojo.query("tr",l),i.forEach(function(t,i){e==t&&(d=i)}),s=n.length/i.length,r={tbl:l,td:o,tr:e,trs:i,tds:n,rows:i.length,cols:s,tdIndex:a,trIndex:d,colIndex:a%s}):r={},this.tableData=r,this._tempStoreTableData(500),this.tableData},connectDraggable:function(){dojo.isIE&&(this.editorDomNode.ondragstart=dojo.hitch(this,"onDragStart"),this.editorDomNode.ondragend=dojo.hitch(this,"onDragEnd"))},onDragStart:function(){var t=window.event;t.srcElement.id||(t.srcElement.id="tbl_"+(new Date).getTime())},onDragEnd:function(){var t=window.event,e=t.srcElement,i=e.id,o=this.editor.document;"table"==e.tagName.toLowerCase()&&setTimeout(function(){var t=dojo.byId(i,o);dojo.removeAttr(t,"align")},100)},checkAvailable:function(){return this.availableCurrentlySet?this.currentlyAvailable:this.editor?this.alwaysAvailable?!0:(this.currentlyAvailable=this.editor.focused&&(this._savedTableInfo?this._savedTableInfo.tbl:this.editor.hasAncestorElement("table")),this.currentlyAvailable?this.connectTableKeys():this.disconnectTableKeys(),this._tempAvailability(500),dojo.publish(this.editor.id+"_tablePlugins",[this.currentlyAvailable]),this.currentlyAvailable):!1},_prepareTable:function(t){var e=this.editor.query("td",t);return e[0].id||e.forEach(function(t,e){t.id||(t.id="tdid"+e+this.getTimeStamp())},this),e},getTimeStamp:function(){return(new Date).getTime()},_tempStoreTableData:function(t){t===!0||(t===!1?this.tableData=null:void 0===t||setTimeout(dojo.hitch(this,function(){this.tableData=null}),t))},_tempAvailability:function(t){t===!0?this.availableCurrentlySet=!0:t===!1?this.availableCurrentlySet=!1:void 0===t||(this.availableCurrentlySet=!0,setTimeout(dojo.hitch(this,function(){this.availableCurrentlySet=!1}),t))},connectTableKeys:function(){if(!this.tablesConnected){this.tablesConnected=!0;var t=this.editor.iframe?this.editor.document:this.editor.editNode;this.cnKeyDn=dojo.connect(t,"onkeydown",this,"onKeyDown"),this.cnKeyUp=dojo.connect(t,"onkeyup",this,"onKeyUp"),this._myListeners.push(dojo.connect(t,"onkeypress",this,"onKeyUp"))}},disconnectTableKeys:function(){dojo.disconnect(this.cnKeyDn),dojo.disconnect(this.cnKeyUp),this.tablesConnected=!1},onKeyDown:function(t){var e=t.keyCode;if(16==e&&(this.shiftKeyDown=!0),9==e){var i=this.getTableInfo();i.tdIndex=this.shiftKeyDown?i.tdIndex-1:tabTo=i.tdIndex+1,i.tdIndex>=0&&i.tdIndex<i.tds.length?(this.editor.selectElement(i.tds[i.tdIndex]),this.currentlyAvailable=!0,this._tempAvailability(!0),this._tempStoreTableData(!0),this.stopEvent=!0):(this.stopEvent=!1,this.onDisplayChanged()),this.stopEvent&&dojo.stopEvent(t)}},onKeyUp:function(t){var e=t.keyCode;16==e&&(this.shiftKeyDown=!1),(37==e||38==e||39==e||40==e)&&this.onDisplayChanged(),9==e&&this.stopEvent&&dojo.stopEvent(t)},onDisplayChanged:function(){this.currentlyAvailable=!1,this._tempStoreTableData(!1),this._tempAvailability(!1),this.checkAvailable()},uninitialize:function(t){this.editor==t&&(this.refCount--,!this.refCount&&this.initialized&&(this.tablesConnected&&this.disconnectTableKeys(),this.initialized=!1,dojo.forEach(this._myListeners,function(t){dojo.disconnect(t)}),delete this._myListeners,delete this.editor._tablePluginHandler,delete this.editor),this.inherited(arguments))}}),C=t("dojox.editor.plugins.TablePlugins",s,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,buttonClass:dijit.form.Button,commandName:"",label:"",alwaysAvailable:!1,undoEnabled:!0,onDisplayChanged:function(t){this.alwaysAvailable||(this.available=t,this.button.set("disabled",!this.available))},setEditor:function(t){this.editor=t,this.editor.customUndo=!0,this.inherited(arguments),this._availableTopic=dojo.subscribe(this.editor.id+"_tablePlugins",this,"onDisplayChanged"),this.onEditorLoaded()},onEditorLoaded:function(){if(this.editor._tablePluginHandler)this.editor._tablePluginHandler.initialize(this.editor);else{var t=new T;t.initialize(this.editor)}},selectTable:function(){var t=this.getTableInfo();t&&t.tbl&&this.editor._sCall("selectElement",[t.tbl])},_initButton:function(){this.command=this.name,this.label=this.editor.commands[this.command]=this._makeTitle(this.command),this.inherited(arguments),delete this.command,this.connect(this.button,"onClick","modTable"),this.onDisplayChanged(!1)},modTable:function(t,e){dojo.isIE&&this.editor.focus(),this.begEdit();var i,o,n,l=this.getTableInfo(),s=dojo.isString(t)?t:this.name,a=!1;switch(s){case"insertTableRowBefore":for(i=l.tbl.insertRow(l.trIndex),n=0;n<l.cols;n++)o=i.insertCell(-1),o.innerHTML="&nbsp;";break;case"insertTableRowAfter":for(i=l.tbl.insertRow(l.trIndex+1),n=0;n<l.cols;n++)o=i.insertCell(-1),o.innerHTML="&nbsp;";break;case"insertTableColumnBefore":l.trs.forEach(function(t){o=t.insertCell(l.colIndex),o.innerHTML="&nbsp;"}),a=!0;break;case"insertTableColumnAfter":l.trs.forEach(function(t){o=t.insertCell(l.colIndex+1),o.innerHTML="&nbsp;"}),a=!0;break;case"deleteTableRow":l.tbl.deleteRow(l.trIndex);break;case"deleteTableColumn":l.trs.forEach(function(t){t.deleteCell(l.colIndex)}),a=!0;break;case"modifyTable":break;case"insertTable":}a&&this.makeColumnsEven(),this.endEdit()},begEdit:function(){this.editor._tablePluginHandler.undoEnabled&&(this.editor.customUndo?this.editor.beginEditing():this.valBeforeUndo=this.editor.getValue())},endEdit:function(){if(this.editor._tablePluginHandler.undoEnabled){if(this.editor.customUndo)this.editor.endEditing();else{var t=this.editor.getValue();this.editor.setValue(this.valBeforeUndo),this.editor.replaceValue(t)}this.editor.onDisplayChanged()}},makeColumnsEven:function(){setTimeout(dojo.hitch(this,function(){var t=this.getTableInfo(!0),e=Math.floor(100/t.cols);t.tds.forEach(function(t){dojo.attr(t,"width",e+"%")})}),10)},getTableInfo:function(t){return this.editor._tablePluginHandler.getTableInfo(t)},_makeTitle:function(t){this._strings=dojo.i18n.getLocalization("dojox.editor.plugins","TableDialog");var e=this._strings[t+"Title"]||this._strings[t+"Label"]||t;return e},getSelectedCells:function(){var t=[],e=this.getTableInfo().tbl;this.editor._tablePluginHandler._prepareTable(e);var i=this.editor,o=i._sCall("getSelectedHtml",[null]),n=o.match(/id="*\w*"*/g);if(dojo.forEach(n,function(e){var o=e.substring(3,e.length);'"'==o.charAt(0)&&'"'==o.charAt(o.length-1)&&(o=o.substring(1,o.length-1));var n=i.byId(o);n&&"td"==n.tagName.toLowerCase()&&t.push(n)},this),!t.length){var l=dijit.range.getSelection(i.window);if(l.rangeCount)for(var s=l.getRangeAt(0),a=s.startContainer;a&&a!=i.editNode&&a!=i.document;){if(1===a.nodeType){var d=a.tagName?a.tagName.toLowerCase():"";if("td"===d)return[a]}a=a.parentNode}}return t},updateState:function(){this.button&&(!this.available&&!this.alwaysAvailable||this.get("disabled")?this.button.set("disabled",!0):this.button.set("disabled",!1))},destroy:function(){this.inherited(arguments),dojo.unsubscribe(this._availableTopic),this.editor._tablePluginHandler.uninitialize(this.editor)}}),y=t(C,{constructor:function(){this.connect(this,"setEditor",function(t){t.onLoadDeferred.addCallback(dojo.hitch(this,function(){this._createContextMenu()})),this.button.domNode.style.display="none"})},destroy:function(){this.menu&&(this.menu.destroyRecursive(),delete this.menu),this.inherited(arguments)},_initButton:function(){this.inherited(arguments),"tableContextMenu"===this.name&&(this.button.domNode.display="none")},_createContextMenu:function(){var t=new h({targetNodeIds:[this.editor.iframe]}),e=j;t.addChild(new u({label:e.selectTableLabel,onClick:dojo.hitch(this,"selectTable")})),t.addChild(new b),t.addChild(new u({label:e.insertTableRowBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableRowBefore")})),t.addChild(new u({label:e.insertTableRowAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableRowAfter")})),t.addChild(new u({label:e.insertTableColumnBeforeLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnBefore")})),t.addChild(new u({label:e.insertTableColumnAfterLabel,onClick:dojo.hitch(this,"modTable","insertTableColumnAfter")})),t.addChild(new b),t.addChild(new u({label:e.deleteTableRowLabel,onClick:dojo.hitch(this,"modTable","deleteTableRow")})),t.addChild(new u({label:e.deleteTableColumnLabel,onClick:dojo.hitch(this,"modTable","deleteTableColumn")})),this.menu=t}}),w=t("dojox.editor.plugins.EditorTableDialog",[c,d,r],{baseClass:"EditorTableDialog",templateString:g,postMixInProperties:function(){dojo.mixin(this,j),this.inherited(arguments)},postCreate:function(){dojo.addClass(this.domNode,this.baseClass),this.inherited(arguments)},onInsert:function(){for(var t=this.selectRow.get("value")||1,e=this.selectCol.get("value")||1,i=this.selectWidth.get("value"),o=this.selectWidthType.get("value"),n=this.selectBorder.get("value"),l=this.selectPad.get("value"),s=this.selectSpace.get("value"),a="tbl_"+(new Date).getTime(),d='<table id="'+a+'"width="'+i+("percent"==o?"%":"")+'" border="'+n+'" cellspacing="'+s+'" cellpadding="'+l+'">\n',r=0;t>r;r++){d+="	<tr>\n";for(var c=0;e>c;c++)d+='		<td width="'+Math.floor(100/e)+'%">&nbsp;</td>\n';d+="	</tr>\n"}d+="</table><br />";var h=dojo.connect(this,"onHide",function(){dojo.disconnect(h);var t=this;setTimeout(function(){t.destroyRecursive()},10)});this.hide(),this.onBuildTable({htmlText:d,id:a})},onCancel:function(){var t=dojo.connect(this,"onHide",function(){dojo.disconnect(t);var e=this;setTimeout(function(){e.destroyRecursive()},10)})},onBuildTable:function(t){}}),x=t("dojox.editor.plugins.InsertTable",C,{alwaysAvailable:!0,modTable:function(){var t=new w({});t.show();var e=dojo.connect(t,"onBuildTable",this,function(t){dojo.disconnect(e),this.editor.focus();this.editor.execCommand("inserthtml",t.htmlText)})}}),k=t([c,d,r],{baseClass:"EditorTableDialog",table:null,tableAtts:{},templateString:m,postMixInProperties:function(){dojo.mixin(this,j),this.inherited(arguments)},postCreate:function(){dojo.addClass(this.domNode,this.baseClass),this.inherited(arguments);var t=new this.colorPicker({params:this.params});this.connect(t,"onChange",function(e){this._started&&(dijit.popup.close(t),this.setBrdColor(e))}),this.connect(t,"onBlur",function(){dijit.popup.close(t)}),this.connect(this.borderCol,"click",function(){t.set("value",this.brdColor,!1),dijit.popup.open({popup:t,around:this.borderCol}),t.focus()});var e=new this.colorPicker({params:this.params});this.connect(e,"onChange",function(t){this._started&&(dijit.popup.close(e),this.setBkColor(t))}),this.connect(e,"onBlur",function(){dijit.popup.close(e)}),this.connect(this.backgroundCol,"click",function(){e.set("value",this.bkColor,!1),dijit.popup.open({popup:e,around:this.backgroundCol}),e.focus()}),this.own(t,e),this.pickers=[t,e],this.setBrdColor(l.get(this.table,"borderColor")),this.setBkColor(l.get(this.table,"backgroundColor"));var i=n.get(this.table,"width");i||(i=this.table.style.width);var o="pixels";dojo.isString(i)&&i.indexOf("%")>-1&&(o="percent",i=i.replace(/%/,"")),i?(this.selectWidth.set("value",i),this.selectWidthType.set("value",o)):(this.selectWidth.set("value",""),this.selectWidthType.set("value","percent")),this.selectBorder.set("value",n.get(this.table,"border")),this.selectPad.set("value",n.get(this.table,"cellPadding")),this.selectSpace.set("value",n.get(this.table,"cellSpacing")),this.selectAlign.set("value",n.get(this.table,"align"))},startup:function(){e.forEach(this.pickers,function(t){t.startup()}),this.inherited(arguments)},setBrdColor:function(t){this.brdColor=t,l.set(this.borderCol,"backgroundColor",t)},setBkColor:function(t){this.bkColor=t,l.set(this.backgroundCol,"backgroundColor",t)},onSet:function(){l.set(this.table,"borderColor",this.brdColor),l.set(this.table,"backgroundColor",this.bkColor),this.selectWidth.get("value")&&(l.set(this.table,"width",""),n.set(this.table,"width",this.selectWidth.get("value")+("pixels"==this.selectWidthType.get("value")?"":"%"))),n.set(this.table,"border",this.selectBorder.get("value")),n.set(this.table,"cellPadding",this.selectPad.get("value")),n.set(this.table,"cellSpacing",this.selectSpace.get("value")),n.set(this.table,"align",this.selectAlign.get("value"));var t=dojo.connect(this,"onHide",function(){dojo.disconnect(t);var e=this;setTimeout(function(){e.destroyRecursive()},10)});this.hide()},onCancel:function(){var t=dojo.connect(this,"onHide",function(){dojo.disconnect(t);var e=this;setTimeout(function(){e.destroyRecursive()},10)})},onSetTable:function(t){}}),A=t("dojox.editor.plugins.ModifyTable",C,{colorPicker:p,modTable:function(){if(this.editor._tablePluginHandler.checkAvailable()){var t=this.getTableInfo(),e=new k({table:t.tbl,colorPicker:"string"==typeof this.colorPicker?require(this.colorPicker):this.colorPicker,params:this.params});e.show(),this.connect(e,"onSetTable",function(t){var e=this.getTableInfo();l.set(e.td,"backgroundColor",t)})}}}),_=t([a,d,r],{colorPicker:f,templateString:"<div style='display: none; position: absolute; top: -10000; z-index: -10000'><div dojoType='dijit.TooltipDialog' dojoAttachPoint='dialog' class='dojoxEditorColorPicker'><div dojoAttachPoint='_colorPicker'></div><div style='margin: 0.5em 0em 0em 0em'><button dojoType='dijit.form.Button' type='submit' dojoAttachPoint='_setButton'>${buttonSet}</button>&nbsp;<button dojoType='dijit.form.Button' type='button' dojoAttachPoint='_cancelButton'>${buttonCancel}</button></div></div></div>",widgetsInTemplate:!0,constructor:function(){dojo.mixin(this,j)},postCreate:function(){var t="string"==typeof this.colorPicker?require(this.colorPicker):this.colorPicker;this._colorPicker=new t({params:this.params},this._colorPicker)},startup:function(){this._started||(this.inherited(arguments),this.connect(this.dialog,"execute",function(){this.onChange(this.get("value"))}),this.connect(this._cancelButton,"onClick",function(){dijit.popup.close(this.dialog)}),this.connect(this.dialog,"onCancel","onCancel"),dojo.style(this.domNode,"display","block"))},_setValueAttr:function(t,e){this._colorPicker.set("value",t,e)},_getValueAttr:function(){return this._colorPicker.get("value")},onChange:function(t){},onCancel:function(){}}),P=t("dojox.editor.plugins.ColorTableCell",C,{colorPicker:f,constructor:function(){this.closable=!0,this.buttonClass=dijit.form.DropDownButton;var t,e=this,n={colorPicker:this.colorPicker,params:this.params};this.dropDown?(t=this.dropDown,t.set(n)):(t=new _(n),t.startup(),this.dropDown=t.dialog),this.connect(t,"onChange",function(t){this.editor.focus(),this.modTable(null,t)}),this.connect(t,"onCancel",function(){this.editor.focus()}),o.before(this.dropDown,"onOpen",function(){var o=e.getTableInfo(),n=e.getSelectedCells(o.tbl);if(n&&n.length>0){for(var l,s=n[0]===e.lastObject?n[0]:n[n.length-1];s&&s!==e.editor.document&&("transparent"===(l=dojo.style(s,"backgroundColor"))||0===l.indexOf("rgba"));)s=s.parentNode;"transparent"!==l&&0!==l.indexOf("rgba")&&t.set("value",i.fromString(l).toHex())}}),this.connect(this,"setEditor",function(t){t.onLoadDeferred.addCallback(dojo.hitch(this,function(){this.connect(this.editor.editNode,"onmouseup",function(t){this.lastObject=t.target})}))})},_initButton:function(){this.command=this.name,this.label=this.editor.commands[this.command]=this._makeTitle(this.command),this.inherited(arguments),delete this.command,this.onDisplayChanged(!1)},modTable:function(t,e){this.begEdit();var i=this.getTableInfo(),o=this.getSelectedCells(i.tbl);dojo.forEach(o,function(t){dojo.style(t,"backgroundColor",e)}),this.endEdit()}});return s.registry.insertTableRowBefore=v,s.registry.insertTableRowAfter=v,s.registry.insertTableColumnBefore=v,s.registry.insertTableColumnAfter=v,s.registry.deleteTableRow=v,s.registry.deleteTableColumn=v,s.registry.colorTableCell=function(t){return new P(t)},s.registry.modifyTable=function(t){return new A(t)},s.registry.insertTable=function(t){return new x(t)},s.registry.tableContextMenu=function(t){return new y(t)},C});