define("dojox/widget/Iterator",["dojo","dijit","dojox","dojo/require!dijit/Declaration"],function(t,e,i){t.provide("dojox.widget.Iterator"),t.require("dijit.Declaration"),t.experimental("dojox.widget.Iterator"),t.declare("dojox.widget.Iterator",[e.Declaration],{constructor:function(){var t=0;return function(){this.attrs=[],this.children=[],this.widgetClass="dojox.widget.Iterator._classes._"+t++}}(),start:0,fetchMax:1e3,query:{name:"*"},attrs:[],defaultValue:"",widgetCtor:null,dataValues:[],data:null,store:null,_srcIndex:0,_srcParent:null,_setSrcIndex:function(t){this._srcIndex=0,this._srcParent=t.parentNode;for(var e=t;e.previousSibling;)this._srcIndex++,e=e.previousSibling},postscript:function(e,i){this._setSrcIndex(i),this.inherited("postscript",arguments);var s=this.widgetCtor=t.getObject(this.widgetClass);this.attrs=t.map(s.prototype.templateString.match(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g),function(t){return t.slice(2,-1)}),t.forEach(this.attrs,function(t){s.prototype[t]=""}),this.update()},clear:function(){this.children.length&&this._setSrcIndex(this.children[0].domNode),t.forEach(this.children,"item.destroy();"),this.children=[]},update:function(){this.store?this.fetch():this.onDataAvailable(this.data||this.dataValues)},_addItem:function(e,i){t.isString(e)&&(e={value:e});var s=new this.widgetCtor(e);this.children.push(s),t.place(s.domNode,this._srcParent,this._srcIndex+i)},getAttrValuesObj:function(e){var i={};return t.isString(e)?t.forEach(this.attrs,function(t){i[t]="value"==t?e:this.defaultValue},this):t.forEach(this.attrs,function(t){this.store?i[t]=this.store.getValue(e,t)||this.defaultValue:i[t]=e[t]||this.defaultValue},this),i},onDataAvailable:function(e){this.clear(),t.forEach(e,function(t,e){this._addItem(this.getAttrValuesObj(t),e)},this)},fetch:function(e,i,s){this.store.fetch({query:e||this.query,start:i||this.start,count:s||this.fetchMax,onComplete:t.hitch(this,"onDataAvailable")})}}),i.widget.Iterator._classes={}});