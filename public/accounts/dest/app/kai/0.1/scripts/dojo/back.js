define("dojo/back",["./_base/config","./_base/lang","./sniff","./dom","./dom-construct","./_base/window","require"],function(n,r,t,o,e,a,i){function l(){var n=H.pop();if(n){var r=H[H.length-1];r||0!=H.length||(r=v),r&&(r.kwArgs.back?r.kwArgs.back():r.kwArgs.backButton?r.kwArgs.backButton():r.kwArgs.handle&&r.kwArgs.handle("back")),B.push(n)}}function d(){var n=B.pop();n&&(n.kwArgs.forward?n.kwArgs.forward():n.kwArgs.forwardButton?n.kwArgs.forwardButton():n.kwArgs.handle&&n.kwArgs.handle("forward"),H.push(n))}function s(n,r,t){return{url:n,kwArgs:r,urlHash:t}}function u(n){var r=n.split("?");return r.length<2?null:r[1]}function h(){var r=(n.dojoIframeHistoryUrl||i.toUrl("./resources/iframe_history.html"))+"?"+(new Date).getTime();return j=!0,A&&(t("webkit")?A.location=r:window.frames[A.name].location=r),r}function f(){if(!U){var n=H.length,r=g();if((r===b||window.location.href==m)&&1==n)return void l();if(B.length>0&&B[B.length-1].urlHash===r)return void d();n>=2&&H[n-2]&&H[n-2].urlHash===r&&l()}}var c={};r.setObject("dojo.back",c);var w,g=c.getHash=function(){var n=window.location.hash;return"#"==n.charAt(0)&&(n=n.substring(1)),t("mozilla")?n:decodeURIComponent(n)},k=c.setHash=function(n){n||(n=""),window.location.hash=encodeURIComponent(n),w=history.length},m="undefined"!=typeof window?window.location.href:"",b="undefined"!=typeof window?g():"",v=null,y=null,p=null,A=null,B=[],H=[],j=!1,U=!1;return c.goBack=l,c.goForward=d,c.init=function(){if(!o.byId("dj_history")){var r=n.dojoIframeHistoryUrl||i.toUrl("./resources/iframe_history.html");n.afterOnLoad||document.write('<iframe style="border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;" name="dj_history" id="dj_history" src="'+r+'"></iframe>')}},c.setInitialState=function(n){v=s(m,n,b)},c.addToHistory=function(r){B=[];var o=null,i=null;if(A||(n.useXDomain&&!n.dojoIframeHistoryUrl,A=window.frames.dj_history),p||(p=e.create("a",{style:{display:"none"}},a.body())),r.changeUrl){if(o=""+(r.changeUrl!==!0?r.changeUrl:(new Date).getTime()),0==H.length&&v.urlHash==o)return void(v=s(i,r,o));if(H.length>0&&H[H.length-1].urlHash==o)return void(H[H.length-1]=s(i,r,o));if(U=!0,setTimeout(function(){k(o),U=!1},1),p.href=o,t("ie")){i=h();var l=r.back||r.backButton||r.handle,d=function(n){""!=g()&&setTimeout(function(){k(o)},1),l.apply(this,[n])};r.back?r.back=d:r.backButton?r.backButton=d:r.handle&&(r.handle=d);var u=r.forward||r.forwardButton||r.handle,c=function(n){""!=g()&&k(o),u&&u.apply(this,[n])};r.forward?r.forward=c:r.forwardButton?r.forwardButton=c:r.handle&&(r.handle=c)}else t("ie")||y||(y=setInterval(f,200))}else i=h();H.push(s(i,r,o))},c._iframeLoaded=function(n,r){var t=u(r.href);return null==t?void(1==H.length&&l()):j?void(j=!1):void(H.length>=2&&t==u(H[H.length-2].url)?l():B.length>0&&t==u(B[B.length-1].url)&&d())},c});